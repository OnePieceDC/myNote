<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>单点知识 | DC&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/fonts/iconfont.css">
    <meta name="description" content="人类终将毁灭,世界属于三体!">
    <meta name="keywords" content="DC的个人博客.">
    
    <link rel="preload" href="/assets/css/0.styles.66b92039.css" as="style"><link rel="preload" href="/assets/js/app.ac54adc6.js" as="script"><link rel="preload" href="/assets/js/4.7ddc74e3.js" as="script"><link rel="preload" href="/assets/js/1.a0c4ff1b.js" as="script"><link rel="preload" href="/assets/js/3.8b03321d.js" as="script"><link rel="preload" href="/assets/js/84.3a32a1eb.js" as="script"><link rel="preload" href="/assets/js/104.cae2d944.js" as="script"><link rel="preload" href="/assets/js/184.46eabf07.js" as="script"><link rel="prefetch" href="/assets/js/10.a91ae011.js"><link rel="prefetch" href="/assets/js/100.2e8ea472.js"><link rel="prefetch" href="/assets/js/101.46f57a02.js"><link rel="prefetch" href="/assets/js/102.f51bcd80.js"><link rel="prefetch" href="/assets/js/103.3f003e0e.js"><link rel="prefetch" href="/assets/js/105.6c6ebc28.js"><link rel="prefetch" href="/assets/js/106.47dc8889.js"><link rel="prefetch" href="/assets/js/107.6b5602b4.js"><link rel="prefetch" href="/assets/js/108.46f0c21d.js"><link rel="prefetch" href="/assets/js/109.0f1168a5.js"><link rel="prefetch" href="/assets/js/11.e6a94228.js"><link rel="prefetch" href="/assets/js/110.6a961498.js"><link rel="prefetch" href="/assets/js/111.c6f27c88.js"><link rel="prefetch" href="/assets/js/112.9ee3d3bb.js"><link rel="prefetch" href="/assets/js/113.82b72aa0.js"><link rel="prefetch" href="/assets/js/114.7487460e.js"><link rel="prefetch" href="/assets/js/115.cd079d0a.js"><link rel="prefetch" href="/assets/js/116.b6b829eb.js"><link rel="prefetch" href="/assets/js/117.89d9336c.js"><link rel="prefetch" href="/assets/js/118.467c4437.js"><link rel="prefetch" href="/assets/js/119.c4b2ac40.js"><link rel="prefetch" href="/assets/js/12.9d3501e4.js"><link rel="prefetch" href="/assets/js/120.5ff31c09.js"><link rel="prefetch" href="/assets/js/121.2e59c3a5.js"><link rel="prefetch" href="/assets/js/122.a66096cf.js"><link rel="prefetch" href="/assets/js/123.4885ba5f.js"><link rel="prefetch" href="/assets/js/124.cacc66be.js"><link rel="prefetch" href="/assets/js/125.dc5b30fe.js"><link rel="prefetch" href="/assets/js/126.4e21eb5e.js"><link rel="prefetch" href="/assets/js/127.cb36a9bf.js"><link rel="prefetch" href="/assets/js/128.ce38358e.js"><link rel="prefetch" href="/assets/js/129.e5f414eb.js"><link rel="prefetch" href="/assets/js/13.ca017a68.js"><link rel="prefetch" href="/assets/js/130.17b597f0.js"><link rel="prefetch" href="/assets/js/131.e1ded2dc.js"><link rel="prefetch" href="/assets/js/132.aae1c627.js"><link rel="prefetch" href="/assets/js/133.73cecdb3.js"><link rel="prefetch" href="/assets/js/134.80cf38a0.js"><link rel="prefetch" href="/assets/js/135.735ed588.js"><link rel="prefetch" href="/assets/js/136.91f8db08.js"><link rel="prefetch" href="/assets/js/137.d6fb8bda.js"><link rel="prefetch" href="/assets/js/138.75cafe73.js"><link rel="prefetch" href="/assets/js/139.b01bf0db.js"><link rel="prefetch" href="/assets/js/14.ee2605b5.js"><link rel="prefetch" href="/assets/js/140.ff0a7911.js"><link rel="prefetch" href="/assets/js/141.c69e7f54.js"><link rel="prefetch" href="/assets/js/142.997b03ac.js"><link rel="prefetch" href="/assets/js/143.e40faea8.js"><link rel="prefetch" href="/assets/js/144.369f23e5.js"><link rel="prefetch" href="/assets/js/145.1268424d.js"><link rel="prefetch" href="/assets/js/146.94c65c4a.js"><link rel="prefetch" href="/assets/js/147.05fe6a36.js"><link rel="prefetch" href="/assets/js/148.327cc29d.js"><link rel="prefetch" href="/assets/js/149.90068676.js"><link rel="prefetch" href="/assets/js/15.42e0a0e4.js"><link rel="prefetch" href="/assets/js/150.b4b780bb.js"><link rel="prefetch" href="/assets/js/151.b4611012.js"><link rel="prefetch" href="/assets/js/152.4d2c8246.js"><link rel="prefetch" href="/assets/js/153.f32dfa58.js"><link rel="prefetch" href="/assets/js/154.b79a78fb.js"><link rel="prefetch" href="/assets/js/155.6ad2865c.js"><link rel="prefetch" href="/assets/js/156.fd49a1af.js"><link rel="prefetch" href="/assets/js/157.55113800.js"><link rel="prefetch" href="/assets/js/158.af321bc9.js"><link rel="prefetch" href="/assets/js/159.37d9c659.js"><link rel="prefetch" href="/assets/js/16.007f45b3.js"><link rel="prefetch" href="/assets/js/160.7a3b5a9a.js"><link rel="prefetch" href="/assets/js/161.fc1fbea8.js"><link rel="prefetch" href="/assets/js/162.2f8d3d1c.js"><link rel="prefetch" href="/assets/js/163.aa889940.js"><link rel="prefetch" href="/assets/js/164.5d8b2cb7.js"><link rel="prefetch" href="/assets/js/165.44d4a9b5.js"><link rel="prefetch" href="/assets/js/166.c1b4c4d4.js"><link rel="prefetch" href="/assets/js/167.0c39929e.js"><link rel="prefetch" href="/assets/js/168.fede035a.js"><link rel="prefetch" href="/assets/js/169.ff940d50.js"><link rel="prefetch" href="/assets/js/17.7395c644.js"><link rel="prefetch" href="/assets/js/170.b6fcb3bf.js"><link rel="prefetch" href="/assets/js/171.2b927a7c.js"><link rel="prefetch" href="/assets/js/172.b07a90a1.js"><link rel="prefetch" href="/assets/js/173.367352bf.js"><link rel="prefetch" href="/assets/js/174.4ea4e20f.js"><link rel="prefetch" href="/assets/js/175.d9679b61.js"><link rel="prefetch" href="/assets/js/176.f7804143.js"><link rel="prefetch" href="/assets/js/177.c5d1e680.js"><link rel="prefetch" href="/assets/js/178.808293fa.js"><link rel="prefetch" href="/assets/js/179.2acf6b3c.js"><link rel="prefetch" href="/assets/js/18.46f9153d.js"><link rel="prefetch" href="/assets/js/180.ddf3ecf7.js"><link rel="prefetch" href="/assets/js/181.4da0855c.js"><link rel="prefetch" href="/assets/js/182.591d135a.js"><link rel="prefetch" href="/assets/js/183.9d08f9fe.js"><link rel="prefetch" href="/assets/js/185.ee1c8428.js"><link rel="prefetch" href="/assets/js/186.c7b19133.js"><link rel="prefetch" href="/assets/js/187.52945990.js"><link rel="prefetch" href="/assets/js/188.a1d395c5.js"><link rel="prefetch" href="/assets/js/189.5b66165e.js"><link rel="prefetch" href="/assets/js/19.2db19edb.js"><link rel="prefetch" href="/assets/js/190.265a75de.js"><link rel="prefetch" href="/assets/js/191.b4c65143.js"><link rel="prefetch" href="/assets/js/192.cc4d4115.js"><link rel="prefetch" href="/assets/js/193.fa02ecc5.js"><link rel="prefetch" href="/assets/js/194.b0c9ad53.js"><link rel="prefetch" href="/assets/js/195.eda8cd34.js"><link rel="prefetch" href="/assets/js/196.cbae4dc6.js"><link rel="prefetch" href="/assets/js/197.693b1b85.js"><link rel="prefetch" href="/assets/js/198.8213665b.js"><link rel="prefetch" href="/assets/js/199.ddf0036d.js"><link rel="prefetch" href="/assets/js/2.4c15b693.js"><link rel="prefetch" href="/assets/js/20.6742e8ae.js"><link rel="prefetch" href="/assets/js/200.340df508.js"><link rel="prefetch" href="/assets/js/201.7431c15b.js"><link rel="prefetch" href="/assets/js/202.217b2b38.js"><link rel="prefetch" href="/assets/js/203.06c6a93d.js"><link rel="prefetch" href="/assets/js/204.a068a898.js"><link rel="prefetch" href="/assets/js/205.9361d3f5.js"><link rel="prefetch" href="/assets/js/206.886beca0.js"><link rel="prefetch" href="/assets/js/207.2278bda8.js"><link rel="prefetch" href="/assets/js/208.db0acc0d.js"><link rel="prefetch" href="/assets/js/209.0e05b204.js"><link rel="prefetch" href="/assets/js/21.fd552a4e.js"><link rel="prefetch" href="/assets/js/210.4c730041.js"><link rel="prefetch" href="/assets/js/211.417dbee1.js"><link rel="prefetch" href="/assets/js/212.eef4f4a3.js"><link rel="prefetch" href="/assets/js/213.ab742b0b.js"><link rel="prefetch" href="/assets/js/214.a57228de.js"><link rel="prefetch" href="/assets/js/215.37f52459.js"><link rel="prefetch" href="/assets/js/216.2f110f92.js"><link rel="prefetch" href="/assets/js/217.09654311.js"><link rel="prefetch" href="/assets/js/218.a7568950.js"><link rel="prefetch" href="/assets/js/219.628ee193.js"><link rel="prefetch" href="/assets/js/22.465a76d2.js"><link rel="prefetch" href="/assets/js/220.c5df9186.js"><link rel="prefetch" href="/assets/js/221.101ddb09.js"><link rel="prefetch" href="/assets/js/222.db210e3c.js"><link rel="prefetch" href="/assets/js/223.429cbf14.js"><link rel="prefetch" href="/assets/js/224.aa002868.js"><link rel="prefetch" href="/assets/js/225.79a40017.js"><link rel="prefetch" href="/assets/js/226.3e08228b.js"><link rel="prefetch" href="/assets/js/227.a09dd4b4.js"><link rel="prefetch" href="/assets/js/228.f930c492.js"><link rel="prefetch" href="/assets/js/229.f639a9e4.js"><link rel="prefetch" href="/assets/js/23.df6831af.js"><link rel="prefetch" href="/assets/js/230.e8ac7aad.js"><link rel="prefetch" href="/assets/js/231.99501214.js"><link rel="prefetch" href="/assets/js/232.e2932792.js"><link rel="prefetch" href="/assets/js/233.43dfa689.js"><link rel="prefetch" href="/assets/js/234.7951f9c4.js"><link rel="prefetch" href="/assets/js/235.1dc96b6c.js"><link rel="prefetch" href="/assets/js/236.40b8d4e4.js"><link rel="prefetch" href="/assets/js/237.75a692de.js"><link rel="prefetch" href="/assets/js/238.cc9d9ac1.js"><link rel="prefetch" href="/assets/js/239.4616a566.js"><link rel="prefetch" href="/assets/js/24.b68dc734.js"><link rel="prefetch" href="/assets/js/240.dd825147.js"><link rel="prefetch" href="/assets/js/241.85e3219b.js"><link rel="prefetch" href="/assets/js/242.bf4123c4.js"><link rel="prefetch" href="/assets/js/243.ce68f4f0.js"><link rel="prefetch" href="/assets/js/244.e2598d4d.js"><link rel="prefetch" href="/assets/js/245.2c696827.js"><link rel="prefetch" href="/assets/js/246.2c44a497.js"><link rel="prefetch" href="/assets/js/247.02405fce.js"><link rel="prefetch" href="/assets/js/248.6727bdf6.js"><link rel="prefetch" href="/assets/js/249.4901f575.js"><link rel="prefetch" href="/assets/js/25.d639c65c.js"><link rel="prefetch" href="/assets/js/250.c922c9ea.js"><link rel="prefetch" href="/assets/js/251.b1350ead.js"><link rel="prefetch" href="/assets/js/252.8295c5ea.js"><link rel="prefetch" href="/assets/js/253.b0a9ba20.js"><link rel="prefetch" href="/assets/js/254.d208b848.js"><link rel="prefetch" href="/assets/js/255.2cfb6ad3.js"><link rel="prefetch" href="/assets/js/256.e7687a81.js"><link rel="prefetch" href="/assets/js/257.db329d54.js"><link rel="prefetch" href="/assets/js/258.be75b1f9.js"><link rel="prefetch" href="/assets/js/259.67500f7e.js"><link rel="prefetch" href="/assets/js/26.9db429a9.js"><link rel="prefetch" href="/assets/js/260.73609cfa.js"><link rel="prefetch" href="/assets/js/261.22fc7c08.js"><link rel="prefetch" href="/assets/js/262.2c620ccd.js"><link rel="prefetch" href="/assets/js/263.e0ce1454.js"><link rel="prefetch" href="/assets/js/264.7fe82318.js"><link rel="prefetch" href="/assets/js/265.537d06c5.js"><link rel="prefetch" href="/assets/js/266.901695a7.js"><link rel="prefetch" href="/assets/js/267.8eb24590.js"><link rel="prefetch" href="/assets/js/268.a21e44dc.js"><link rel="prefetch" href="/assets/js/269.33e6ce5d.js"><link rel="prefetch" href="/assets/js/27.2296e284.js"><link rel="prefetch" href="/assets/js/270.31507ac3.js"><link rel="prefetch" href="/assets/js/271.b9406b42.js"><link rel="prefetch" href="/assets/js/272.0acaba6f.js"><link rel="prefetch" href="/assets/js/273.c2e359b0.js"><link rel="prefetch" href="/assets/js/274.a80428a6.js"><link rel="prefetch" href="/assets/js/28.7e4f4dc1.js"><link rel="prefetch" href="/assets/js/29.ba75f79a.js"><link rel="prefetch" href="/assets/js/30.16cd3622.js"><link rel="prefetch" href="/assets/js/31.54ed5bc1.js"><link rel="prefetch" href="/assets/js/32.b2fbba6a.js"><link rel="prefetch" href="/assets/js/33.f7ff0107.js"><link rel="prefetch" href="/assets/js/34.4b2cea7d.js"><link rel="prefetch" href="/assets/js/35.1159e74c.js"><link rel="prefetch" href="/assets/js/36.0b6296f3.js"><link rel="prefetch" href="/assets/js/37.fc67879e.js"><link rel="prefetch" href="/assets/js/38.637afaf8.js"><link rel="prefetch" href="/assets/js/39.748a78f3.js"><link rel="prefetch" href="/assets/js/40.4fede9bb.js"><link rel="prefetch" href="/assets/js/41.c7f0b087.js"><link rel="prefetch" href="/assets/js/42.5b1a487d.js"><link rel="prefetch" href="/assets/js/43.59275b93.js"><link rel="prefetch" href="/assets/js/44.b18a4c94.js"><link rel="prefetch" href="/assets/js/45.bc8f7cb3.js"><link rel="prefetch" href="/assets/js/46.6a4ec89f.js"><link rel="prefetch" href="/assets/js/47.e1e129e6.js"><link rel="prefetch" href="/assets/js/48.c284ce23.js"><link rel="prefetch" href="/assets/js/49.17e5dd65.js"><link rel="prefetch" href="/assets/js/5.e3d12916.js"><link rel="prefetch" href="/assets/js/50.34c3ac45.js"><link rel="prefetch" href="/assets/js/51.035f7031.js"><link rel="prefetch" href="/assets/js/52.e9ef227a.js"><link rel="prefetch" href="/assets/js/53.ecbb032d.js"><link rel="prefetch" href="/assets/js/54.e9af4cfe.js"><link rel="prefetch" href="/assets/js/55.7e71402b.js"><link rel="prefetch" href="/assets/js/56.511071fe.js"><link rel="prefetch" href="/assets/js/57.13b7fe79.js"><link rel="prefetch" href="/assets/js/58.e51f8b0e.js"><link rel="prefetch" href="/assets/js/59.a1b8bdb7.js"><link rel="prefetch" href="/assets/js/6.5fc3f358.js"><link rel="prefetch" href="/assets/js/60.fd7e1c08.js"><link rel="prefetch" href="/assets/js/61.0daf2361.js"><link rel="prefetch" href="/assets/js/62.04632944.js"><link rel="prefetch" href="/assets/js/63.f0dd5615.js"><link rel="prefetch" href="/assets/js/64.89a4b562.js"><link rel="prefetch" href="/assets/js/65.6764ff0c.js"><link rel="prefetch" href="/assets/js/66.049bdee1.js"><link rel="prefetch" href="/assets/js/67.b0d4ec16.js"><link rel="prefetch" href="/assets/js/68.46d97067.js"><link rel="prefetch" href="/assets/js/69.f540f0da.js"><link rel="prefetch" href="/assets/js/7.ce17dd73.js"><link rel="prefetch" href="/assets/js/70.17d8f857.js"><link rel="prefetch" href="/assets/js/71.b2a166a0.js"><link rel="prefetch" href="/assets/js/72.1c17a875.js"><link rel="prefetch" href="/assets/js/73.dac8984b.js"><link rel="prefetch" href="/assets/js/74.5bbc33ac.js"><link rel="prefetch" href="/assets/js/75.483644c7.js"><link rel="prefetch" href="/assets/js/76.de5461ab.js"><link rel="prefetch" href="/assets/js/77.7fa90702.js"><link rel="prefetch" href="/assets/js/78.f41853b8.js"><link rel="prefetch" href="/assets/js/79.598b50e6.js"><link rel="prefetch" href="/assets/js/80.61d2d23a.js"><link rel="prefetch" href="/assets/js/81.d310c6e4.js"><link rel="prefetch" href="/assets/js/82.22aa814c.js"><link rel="prefetch" href="/assets/js/83.f493eba4.js"><link rel="prefetch" href="/assets/js/85.2f47134e.js"><link rel="prefetch" href="/assets/js/86.74e65a77.js"><link rel="prefetch" href="/assets/js/87.e87bff96.js"><link rel="prefetch" href="/assets/js/88.aabc97af.js"><link rel="prefetch" href="/assets/js/89.b0945d87.js"><link rel="prefetch" href="/assets/js/90.630f62d3.js"><link rel="prefetch" href="/assets/js/91.ed816647.js"><link rel="prefetch" href="/assets/js/92.19065457.js"><link rel="prefetch" href="/assets/js/93.a0fe1919.js"><link rel="prefetch" href="/assets/js/94.51e48580.js"><link rel="prefetch" href="/assets/js/95.e591bede.js"><link rel="prefetch" href="/assets/js/96.1723f1d6.js"><link rel="prefetch" href="/assets/js/97.02bbb7d4.js"><link rel="prefetch" href="/assets/js/98.a3625ba6.js"><link rel="prefetch" href="/assets/js/99.1accbf48.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5959bfd2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.66b92039.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/nav-logo.png" alt="DC's blog" class="logo"> <span class="site-name can-hide">DC's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="IT必备" class="dropdown-title"><a href="/IT/" class="link-title">IT必备</a> <span class="title" style="display:none;">IT必备</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/IT/basis/" class="nav-link">计算机基础</a></li><li class="dropdown-item"><!----> <a href="/IT/linux/" class="nav-link">linux基础</a></li><li class="dropdown-item"><!----> <a href="/IT/mysql/" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/IT/git/" class="nav-link">git</a></li><li class="dropdown-item"><!----> <a href="/IT/structure/" class="nav-link">数据结构与算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><a href="/python/" class="link-title">Python</a> <span class="title" style="display:none;">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python/basis/" class="nav-link">opp</a></li><li class="dropdown-item"><!----> <a href="/python/oop/" class="nav-link">oop</a></li><li class="dropdown-item"><!----> <a href="/python/Network_concurrency/" class="nav-link">网络并发编程</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front_end/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front_end/html/" class="nav-link">html</a></li><li class="dropdown-item"><!----> <a href="/front_end/css/" class="nav-link">css</a></li><li class="dropdown-item"><!----> <a href="/front_end/js/" class="nav-link">javascript</a></li><li class="dropdown-item"><!----> <a href="/front_end/jquery/" class="nav-link">jquery</a></li><li class="dropdown-item"><!----> <a href="/front_end/ui/" class="nav-link">UI</a></li><li class="dropdown-item"><!----> <a href="/front_end/vue/" class="nav-link">vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/python_web/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python_web/django/" class="nav-link">Django</a></li><li class="dropdown-item"><!----> <a href="/python_web/drf/" class="nav-link">drf</a></li><li class="dropdown-item"><!----> <a href="/python_web/drf_re/" class="nav-link">drf_re</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实战" class="dropdown-title"><a href="/project/" class="link-title">实战</a> <span class="title" style="display:none;">实战</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前后端不分离</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/bbs/" class="nav-link">BBS</a></li><li class="dropdown-subitem"><a href="/project/order/" class="nav-link">订单系统</a></li><li class="dropdown-subitem"><a href="/project/crm/" class="nav-link">CRM</a></li></ul></li><li class="dropdown-item"><h4>前后端分离</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/supply/" class="nav-link">供应链系统</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><a href="/other/" class="link-title">其他</a> <span class="title" style="display:none;">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/essays/" class="nav-link">杂文</a></li><li class="dropdown-item"><h4>关于我</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/about/" class="nav-link">me</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><!----> <span class="title" style="display:;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/OnePieceDC/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.gif"> <div class="blogger-info"><h3>DC</h3> <span>愿我一生欢喜,不为世俗所及.</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="IT必备" class="dropdown-title"><a href="/IT/" class="link-title">IT必备</a> <span class="title" style="display:none;">IT必备</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/IT/basis/" class="nav-link">计算机基础</a></li><li class="dropdown-item"><!----> <a href="/IT/linux/" class="nav-link">linux基础</a></li><li class="dropdown-item"><!----> <a href="/IT/mysql/" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/IT/git/" class="nav-link">git</a></li><li class="dropdown-item"><!----> <a href="/IT/structure/" class="nav-link">数据结构与算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><a href="/python/" class="link-title">Python</a> <span class="title" style="display:none;">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python/basis/" class="nav-link">opp</a></li><li class="dropdown-item"><!----> <a href="/python/oop/" class="nav-link">oop</a></li><li class="dropdown-item"><!----> <a href="/python/Network_concurrency/" class="nav-link">网络并发编程</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front_end/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front_end/html/" class="nav-link">html</a></li><li class="dropdown-item"><!----> <a href="/front_end/css/" class="nav-link">css</a></li><li class="dropdown-item"><!----> <a href="/front_end/js/" class="nav-link">javascript</a></li><li class="dropdown-item"><!----> <a href="/front_end/jquery/" class="nav-link">jquery</a></li><li class="dropdown-item"><!----> <a href="/front_end/ui/" class="nav-link">UI</a></li><li class="dropdown-item"><!----> <a href="/front_end/vue/" class="nav-link">vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/python_web/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python_web/django/" class="nav-link">Django</a></li><li class="dropdown-item"><!----> <a href="/python_web/drf/" class="nav-link">drf</a></li><li class="dropdown-item"><!----> <a href="/python_web/drf_re/" class="nav-link">drf_re</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实战" class="dropdown-title"><a href="/project/" class="link-title">实战</a> <span class="title" style="display:none;">实战</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前后端不分离</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/bbs/" class="nav-link">BBS</a></li><li class="dropdown-subitem"><a href="/project/order/" class="nav-link">订单系统</a></li><li class="dropdown-subitem"><a href="/project/crm/" class="nav-link">CRM</a></li></ul></li><li class="dropdown-item"><h4>前后端分离</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/supply/" class="nav-link">供应链系统</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><a href="/other/" class="link-title">其他</a> <span class="title" style="display:none;">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/essays/" class="nav-link">杂文</a></li><li class="dropdown-item"><h4>关于我</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/about/" class="nav-link">me</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><!----> <span class="title" style="display:;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/OnePieceDC/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>BBS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>订单平台</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/bcb1d7/" aria-current="page" class="active sidebar-link">单点知识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/bcb1d7/#需求" class="sidebar-link">需求</a></li><li class="sidebar-sub-header level2"><a href="/pages/bcb1d7/#发短信" class="sidebar-link">发短信</a></li><li class="sidebar-sub-header level2"><a href="/pages/bcb1d7/#菜单设计思路" class="sidebar-link">菜单设计思路</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/bcb1d7/#方式一-html模版" class="sidebar-link">方式一: HTML模版</a></li><li class="sidebar-sub-header level3"><a href="/pages/bcb1d7/#方式二-配置文件" class="sidebar-link">方式二: 配置文件</a></li><li class="sidebar-sub-header level5"><a href="/pages/bcb1d7/#大致思路" class="sidebar-link">大致思路</a></li><li class="sidebar-sub-header level5"><a href="/pages/bcb1d7/#需解决问题" class="sidebar-link">需解决问题</a></li><li class="sidebar-sub-header level3"><a href="/pages/bcb1d7/#方式三-数据库" class="sidebar-link">方式三: 数据库</a></li><li class="sidebar-sub-header level5"><a href="/pages/bcb1d7/#大致思路-2" class="sidebar-link">大致思路</a></li><li class="sidebar-sub-header level5"><a href="/pages/bcb1d7/#具体分析" class="sidebar-link">具体分析</a></li><li class="sidebar-sub-header level5"><a href="/pages/bcb1d7/#扩展-多级评论" class="sidebar-link">扩展: 多级评论</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/bcb1d7/#权限设计思路" class="sidebar-link">权限设计思路</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/bcb1d7/#文件的方式" class="sidebar-link">文件的方式</a></li><li class="sidebar-sub-header level3"><a href="/pages/bcb1d7/#数据库的方式" class="sidebar-link">数据库的方式</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/bcb1d7/#队列" class="sidebar-link">队列</a></li><li class="sidebar-sub-header level2"><a href="/pages/bcb1d7/#ajax" class="sidebar-link">Ajax</a></li><li class="sidebar-sub-header level2"><a href="/pages/bcb1d7/#创建项目" class="sidebar-link">创建项目</a></li></ul></li><li><a href="/pages/80fa06/" class="sidebar-link">表结构</a></li><li><a href="/pages/32e64d/" class="sidebar-link">用户名登陆</a></li><li><a href="/pages/2e039e/" class="sidebar-link">短信登陆</a></li><li><a href="/pages/2853bf/" class="sidebar-link">菜单和权限</a></li><li><a href="/pages/87c2bf/" class="sidebar-link">级别管理</a></li><li><a href="/pages/dd38eb/" class="sidebar-link">客户管理</a></li><li><a href="/pages/c3db02/" class="sidebar-link">分页和搜索</a></li><li><a href="/pages/bba4be/" class="sidebar-link">价格策略</a></li><li><a href="/pages/524254/" class="sidebar-link">交易中心</a></li><li><a href="/pages/055dc6/" class="sidebar-link">message组件</a></li><li><a href="/pages/8fb2a4/" class="sidebar-link">我的交易列表</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CRM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>供应链</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-91157402><div class="articleInfo" data-v-91157402><ul class="breadcrumbs" data-v-91157402><li data-v-91157402><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-91157402></a></li> <li data-v-91157402><a href="/categories/?category=%E5%AE%9E%E6%88%98" title="分类" data-v-91157402>实战</a></li><li data-v-91157402><a href="/categories/?category=%E8%AE%A2%E5%8D%95%E5%B9%B3%E5%8F%B0" title="分类" data-v-91157402>订单平台</a></li></ul> <div class="info" data-v-91157402><div title="作者" class="author iconfont icon-touxiang" data-v-91157402><a href="https://github.com/OnePieceDC" target="_blank" title="作者" class="beLink" data-v-91157402>DC</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-91157402><a href="javascript:;" data-v-91157402>2023-12-01</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">单点知识<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="需求"><a href="#需求" class="header-anchor">#</a> 需求</h2> <blockquote><p>需求陈列出来后, 先提取出单点功能, 先实现单点功能!!别一上来就开发.</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">-</span> 认证模块<span class="token punctuation">,</span> 用户名密码 或 手机短信登录<span class="token punctuation">(</span>60s有效<span class="token punctuation">)</span><span class="token punctuation">.</span>

<span class="token operator">-</span> 角色管理<span class="token punctuation">,</span> 不同角色具有不同权限 和 展示不同菜单<span class="token punctuation">.</span>
  管理员<span class="token punctuation">,</span>充值
  客户<span class="token punctuation">,</span>下单
  
<span class="token operator">-</span> 客户管理<span class="token punctuation">,</span> 除了基本的增删改查以外<span class="token punctuation">,</span>支持对客户可以分级<span class="token punctuation">,</span>不同级别后续下单折扣不同<span class="token punctuation">.</span>

<span class="token operator">-</span> 交易中心
  <span class="token operator">-</span> 管理员可以给客户余额充值<span class="token operator">/</span>扣费
  <span class="token operator">-</span> 客户可以下单<span class="token operator">/</span>撤单
  <span class="token operator">-</span> 生成交易记录
  <span class="token operator">-</span> 对订单进行多维度搜索<span class="token punctuation">,</span>例如<span class="token punctuation">:</span>客户姓名、订单号<span class="token punctuation">.</span>

<span class="token operator">-</span> worker<span class="token punctuation">,</span>去执行订单并更新订单状态<span class="token punctuation">.</span>
  worker简单理解就是用python写的一个脚本<span class="token punctuation">,</span>它获取到任务后<span class="token punctuation">,</span>可以在内部开一些线程池帮助我们并发的进行操作<span class="token punctuation">.</span>
  Ps<span class="token punctuation">:</span> 可以将py脚本文件打包成exe文件<span class="token punctuation">,</span>点击运行<span class="token punctuation">.</span>
      脚本文件部署后<span class="token punctuation">,</span>还可以进行监控<span class="token punctuation">,</span>可以进行重启等操作<span class="token punctuation">.</span>
  <span class="token number">1</span><span class="token operator">&gt;</span> 去redis中取任务
  <span class="token number">2</span><span class="token operator">&gt;</span> 将该任务<span class="token operator">/</span>订单在数据库中的状态修改为执行中
  <span class="token number">3</span><span class="token operator">&gt;</span> 获取任务详细<span class="token punctuation">:</span> 比如<span class="token punctuation">,</span>将某个视频的播放量刷到<span class="token number">10000</span>
  <span class="token number">4</span><span class="token operator">&gt;</span> 利用线程池或协程实现
  <span class="token number">5</span><span class="token operator">&gt;</span> 更新订单状态为已完成
  <span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor
  <span class="token keyword">def</span> <span class="token function">task</span><span class="token punctuation">(</span>video_url<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token comment"># 根据视频地址实现刷视频</span>
      <span class="token keyword">pass</span> 
  pool <span class="token operator">=</span> ThreadPoolExecutor<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>  <span class="token comment"># 最多有50个线程</span>
  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 将10000个任务交给线程池</span>
      pool<span class="token punctuation">.</span>submit<span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token string">&quot;视频地址&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 执行任务</span>
  pool<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 卡住,等待所有的任务执行完毕.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>[订单系统(刷播放量的)] 先理清楚大体的业务功能!</p> <blockquote><p>2、3个角色 + 4个业务模块/20来个路由 的小项目, 可以考虑 基于“配置文件”来实现权限的控制!!!</p></blockquote> <p><strong>客户登陆后</strong> <font color="gray">客户在平台下单,后台自动执行下单的任务.</font></p> <p><img src="/assets/img/image-20230420152207380.1b20c74d.png" alt="image-20230420152207380"></p> <p><strong>管理员登陆后</strong></p> <p><img src="/assets/img/image-20230420153343099.0a60c2b7.png" alt="image-20230420153343099"></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>两角色: 管理员、客户
登陆模块: 用户名密码登陆、短信验证码登陆
角色管理: 不同角色具有不同权限 和 展示不同菜单
管理员:
   级别、客户、价格策略 的CURD.
   管理员可以对客户进行充值或扣款,会产生相应的交易记录.
   管理员可以对客户重置密码.
   管理员可以查看所有的交易记录(可组合搜索)
   管理员可查看所有的订单信息
客户:
   可下单
   可查看自己所有的订单记录
   可查看自己所有的交易记录
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><hr> <h2 id="发短信"><a href="#发短信" class="header-anchor">#</a> 发短信</h2> <blockquote><p>API服务: 比较繁琐, 得先处理签名和加密等..然后调用接口传入相应的参数.<br>
SDK服务: 已经封装好并在pypi里发布了,直接install就可以使用!!</p></blockquote> <p><code>pip install tencentcloud-sdk-python</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> tencentcloud<span class="token punctuation">.</span>common <span class="token keyword">import</span> credential
<span class="token keyword">from</span> tencentcloud<span class="token punctuation">.</span>common<span class="token punctuation">.</span>exception<span class="token punctuation">.</span>tencent_cloud_sdk_exception <span class="token keyword">import</span> TencentCloudSDKException
<span class="token keyword">from</span> tencentcloud<span class="token punctuation">.</span>sms<span class="token punctuation">.</span>v20210111 <span class="token keyword">import</span> sms_client<span class="token punctuation">,</span> models

cred <span class="token operator">=</span> credential<span class="token punctuation">.</span>Credential<span class="token punctuation">(</span><span class="token string">&quot;AKIDVqukLfiV1HGyPZT6SYNvCCwPbXCbjaATABC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3qMbAWcS1JK4YlhMltlNinb8PP8alfJgABC&quot;</span><span class="token punctuation">)</span>

client <span class="token operator">=</span> sms_client<span class="token punctuation">.</span>SmsClient<span class="token punctuation">(</span>cred<span class="token punctuation">,</span> <span class="token string">&quot;ap-guangzhou&quot;</span><span class="token punctuation">)</span>

req <span class="token operator">=</span> models<span class="token punctuation">.</span>SendSmsRequest<span class="token punctuation">(</span><span class="token punctuation">)</span>

req<span class="token punctuation">.</span>SmsSdkAppId <span class="token operator">=</span> <span class="token string">&quot;1400804452&quot;</span>
req<span class="token punctuation">.</span>SignName <span class="token operator">=</span> <span class="token string">&quot;OnePicec公众号&quot;</span>
req<span class="token punctuation">.</span>TemplateId <span class="token operator">=</span> <span class="token string">&quot;1695872&quot;</span>
req<span class="token punctuation">.</span>TemplateParamSet <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;688688&quot;</span><span class="token punctuation">,</span> <span class="token string">'5'</span><span class="token punctuation">]</span>
req<span class="token punctuation">.</span>PhoneNumberSet <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;+8617380646918&quot;</span><span class="token punctuation">]</span>

resp <span class="token operator">=</span> client<span class="token punctuation">.</span>SendSms<span class="token punctuation">(</span>req<span class="token punctuation">)</span>

<span class="token comment"># 输出json格式的字符串回包</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>to_json_string<span class="token punctuation">(</span>indent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><hr> <h2 id="菜单设计思路"><a href="#菜单设计思路" class="header-anchor">#</a> 菜单设计思路</h2> <blockquote><p><font color="brown"><strong>需求:</strong></font> 不同的用户登陆, 看到不同的菜单.<br>
理性分析: 若角色很少, 就没必要使用方式三(使用数据库,去数据库中查.)</p></blockquote> <h3 id="方式一-html模版"><a href="#方式一-html模版" class="header-anchor">#</a> 方式一: HTML模版</h3> <blockquote><p><strong>页面写死HTML模版</strong><br>
角色一多, 配置起来也些许麻烦,</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">if</span> role <span class="token operator">==</span> <span class="token string">&quot;管理员&quot;</span> <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;/xxx/xx/&quot;</span><span class="token operator">&gt;</span>级别列表<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;/xxx/xx/&quot;</span><span class="token operator">&gt;</span>客户列表<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;/xxx/xx/&quot;</span><span class="token operator">&gt;</span>价格策略<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;/xxx/xx/&quot;</span><span class="token operator">&gt;</span>交易策略<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token comment"># ... ... #}</span>
<span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">else</span> <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;/xxx/xx/&quot;</span><span class="token operator">&gt;</span>价格策略<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;/xxx/xx/&quot;</span><span class="token operator">&gt;</span>交易策略<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
<span class="token punctuation">{</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="方式二-配置文件"><a href="#方式二-配置文件" class="header-anchor">#</a> 方式二: 配置文件</h3> <blockquote><p><strong>菜单放到配置文件中</strong><br>
相比于方式一, 对菜单的修改无需动html的内容.. 直接修改菜单的内容.<br>
但角色一多, 配置起来也些许麻烦,</p></blockquote> <h5 id="大致思路"><a href="#大致思路" class="header-anchor">#</a> 大致思路</h5> <p>settings文件中配置</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># settings.py</span>

ADMIN <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;级别列表&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;客户列表&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;价格策略&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;交易策略&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

USER <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;价格策略&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;交易策略&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>在模版中的呈现, 当然可以使用自定义的模版 <strong>inclusion_tag</strong> !!</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">if</span> 角色 <span class="token operator">==</span> <span class="token string">&quot;管理员&quot;</span> <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> ADMIN <span class="token operator">%</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;{{ item.url }}&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>title <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">else</span> <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> USER <span class="token operator">%</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;{{ item.url }}&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>title <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h5 id="需解决问题"><a href="#需解决问题" class="header-anchor">#</a> 需解决问题</h5> <blockquote><p>问题一: 需要显示几个级别的菜单<br>
问题二: 菜单默认选中和展开问题<br>
问题三: 路径导航问题.</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># -- 一级菜单</span>
ADMIN <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;级别列表&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;客户列表&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;价格策略&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;交易策略&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>


<span class="token comment"># -- 多级菜单</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
客户管理
   级别列表
      添加
      编辑
      删除
   客户列表
订单管理
   价格策略
   交易策略
&quot;&quot;&quot;</span>
ADMIN <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;客户管理&quot;</span><span class="token punctuation">,</span> 
        <span class="token string">&quot;children&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span>
            <span class="token comment"># 若url比较长,可以为其设置个name!通过name反向生成即可.</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;级别列表&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span> 
                <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;level_list&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;children&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span>
                    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;添加&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;编辑&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;删除&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;客户列表&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;订单管理&quot;</span><span class="token punctuation">,</span> 
        <span class="token string">&quot;children&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;价格策略&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;交易策略&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>


<span class="token comment"># -- 菜单选中和展开问题</span>
<span class="token number">1</span><span class="token operator">&gt;</span> 获取当前用户请求的URL <span class="token punctuation">(</span>eg<span class="token punctuation">:</span> pricepolicy<span class="token operator">/</span><span class="token builtin">list</span><span class="token operator">/</span> 或 通过url对应的name反向生成<span class="token punctuation">)</span>
<span class="token number">2</span><span class="token operator">&gt;</span> pricepolicy<span class="token operator">/</span><span class="token builtin">list</span><span class="token operator">/</span> 匹配 ADMIN中的URL <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> 将其在页面上默认选中


<span class="token comment"># -- 路径导航问题</span>
<span class="token number">1</span><span class="token operator">&gt;</span> 获取当前用户请求的URL
<span class="token number">2</span><span class="token operator">&gt;</span> 获取上级<span class="token punctuation">,</span>展示导航信息
<span class="token number">3</span><span class="token operator">&gt;</span> 设置菜单与下级关系
   像添加删除编辑<span class="token punctuation">,</span>一般都不挂到菜单展示的地方<span class="token punctuation">,</span>而是挂到某个菜单下<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><h3 id="方式三-数据库"><a href="#方式三-数据库" class="header-anchor">#</a> 方式三: 数据库</h3> <blockquote><p><strong>将菜单 + 角色写入数据库中.</strong><br>
动态分配角色, 比较方便.</p></blockquote> <h5 id="大致思路-2"><a href="#大致思路-2" class="header-anchor">#</a> 大致思路</h5> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">|</span> <span class="token builtin">id</span>   <span class="token operator">|</span> title    <span class="token operator">|</span> url  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1</span>    <span class="token operator">|</span> 级别列表 <span class="token operator">|</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2</span>    <span class="token operator">|</span> 客户列表 <span class="token operator">|</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">3</span>    <span class="token operator">|</span> 价格策略 <span class="token operator">|</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">4</span>    <span class="token operator">|</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">|</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  <span class="token operator">|</span>


<span class="token operator">|</span> <span class="token builtin">id</span>   <span class="token operator">|</span> 角色   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1</span>    <span class="token operator">|</span> 管理员 <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2</span>    <span class="token operator">|</span> 用户   <span class="token operator">|</span>


<span class="token operator">|</span> <span class="token builtin">id</span>   <span class="token operator">|</span> role_id <span class="token operator">|</span> menu_id <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1</span>    <span class="token operator">|</span> <span class="token number">1</span>       <span class="token operator">|</span> <span class="token number">1</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2</span>    <span class="token operator">|</span> <span class="token number">1</span>       <span class="token operator">|</span> <span class="token number">2</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">3</span>    <span class="token operator">|</span> <span class="token number">2</span>       <span class="token operator">|</span> <span class="token number">2</span>       <span class="token operator">|</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><em>在页面展示数据库</em><br>
1&gt; 连表查询特定角色关联的所有的菜单<br>
2&gt; 在页面上进行展示</p> <h5 id="具体分析"><a href="#具体分析" class="header-anchor">#</a> 具体分析</h5> <blockquote><p><font color="brown"><strong>菜单的多级关系</strong> 在数据库中如何实现呢?</font> -- 自关联</p></blockquote> <table><thead><tr><th>id</th> <th>title</th> <th>url</th> <th>parent_id</th></tr></thead> <tbody><tr><td>1</td> <td>客户管理</td> <td>null</td> <td>null</td></tr> <tr><td>2</td> <td>级别列表</td> <td>...</td> <td>1</td></tr> <tr><td>3</td> <td>客户列表</td> <td>...</td> <td>1</td></tr> <tr><td>4</td> <td>订单管理</td> <td>null</td> <td>null</td></tr> <tr><td>5</td> <td>价格策略</td> <td>...</td> <td>4</td></tr> <tr><td>6</td> <td>交易策略</td> <td>...</td> <td>4</td></tr> <tr><td>7</td> <td>添加</td> <td>...</td> <td>2</td></tr> <tr><td>8</td> <td>编辑</td> <td>...</td> <td>2</td></tr> <tr><td>9</td> <td>删除</td> <td>...</td> <td>2</td></tr></tbody></table> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
客户管理
   级别列表
      添加
      编辑
      删除
   客户列表
订单管理
   价格策略
   交易策略
&quot;&quot;&quot;</span>
客户管理是没有url的<span class="token punctuation">,</span>因为点击它只是展开<span class="token punctuation">,</span>不会跳转<span class="token punctuation">.</span>它属于一级菜单<span class="token punctuation">,</span>所以parent_id也为null<span class="token punctuation">.</span>
级别列表的parent_id为<span class="token number">1</span><span class="token punctuation">,</span>表明它的上一级是客户管理<span class="token punctuation">.</span>
添加、编辑、删除的parent_id为<span class="token number">2</span><span class="token punctuation">,</span>表明它的上一级都是级别列表<span class="token punctuation">.</span>

获取一级菜单 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> 找表中<span class="token punctuation">,</span>parent_id等于null的<span class="token punctuation">.</span>
获取某个二级菜单<span class="token punctuation">(</span>比如客户管理的<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> 找表中<span class="token punctuation">,</span>parent_id等于<span class="token number">1</span>的<span class="token punctuation">.</span>
获取某个三级菜单<span class="token punctuation">(</span>比如级别列表的<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> 找表中<span class="token punctuation">,</span>parent_id等于<span class="token number">2</span>的<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h5 id="扩展-多级评论"><a href="#扩展-多级评论" class="header-anchor">#</a> 扩展: 多级评论</h5> <blockquote><p><font color="brown">平台的多级评论</font> - 自关联</p></blockquote> <table><thead><tr><th>id</th> <th>content</th> <th>root_id</th> <th>parent_id</th> <th>depth</th></tr></thead> <tbody><tr><td>1</td> <td>优秀</td> <td>null</td> <td>null</td> <td>0</td></tr> <tr><td>2</td> <td>不咋样</td> <td>null</td> <td>null</td> <td>0</td></tr> <tr><td>3</td> <td>确实</td> <td>1</td> <td>1</td> <td>1</td></tr> <tr><td>4</td> <td>哈哈</td> <td>1</td> <td>1</td> <td>1</td></tr> <tr><td>5</td> <td>你说的都对</td> <td>1</td> <td>3</td> <td>2</td></tr></tbody></table> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
优秀
	确实
		你说的都对
	哈哈
不咋样
&quot;&quot;&quot;</span>
根据生活经验<span class="token punctuation">,</span>不难知道<span class="token punctuation">,</span>有些评论系统默认只展示二级评论<span class="token punctuation">,</span>三级四级的评论要点击才会显示<span class="token punctuation">.</span>
若我只想展示一级评论<span class="token punctuation">,</span>就在表中找depth等于<span class="token number">0</span>的记录<span class="token punctuation">.</span>
root_id表明根评论<span class="token punctuation">,</span>parent_id表明父评论
比如<span class="token punctuation">:</span> `优秀`<span class="token punctuation">,</span>`不咋样`这两条评论是根评论<span class="token punctuation">;</span> `确实`<span class="token punctuation">,</span>`哈哈`这两条评论是`优秀`的子评论<span class="token punctuation">;</span> 
     `你说的都对`的父评论是`确实`<span class="token punctuation">,</span>其根评论是`优秀`
    
拿`优秀`相关联的所有评论的时候<span class="token punctuation">,</span>只需要查root_id等于<span class="token number">1</span>的<span class="token punctuation">.</span>给他回复的<span class="token punctuation">,</span>以及子孙回复的<span class="token punctuation">,</span>通过它都能拿到!
只拿`优秀`的子评论的时候<span class="token punctuation">,</span>只需要查parent_id等于<span class="token number">1</span>的<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><hr> <h2 id="权限设计思路"><a href="#权限设计思路" class="header-anchor">#</a> 权限设计思路</h2> <blockquote><p>菜单是用户登陆后在左侧菜单展现出来的东西. 不仅如此, 在用户访问url的时候应该做上权限的校验!!<br>
即 <font color="brown">权限的判断时,要考虑:</font> <em>通过正常的点击菜单跳转的url</em> 、<em>在浏览器上非法输入的url..</em></p></blockquote> <h3 id="文件的方式"><a href="#文件的方式" class="header-anchor">#</a> 文件的方式</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>权限就是url<span class="token punctuation">,</span>若需要频繁的判断 某个url是否存在<span class="token operator">/</span>是否有该权限<span class="token punctuation">,</span> 用字典集合比列表好<span class="token punctuation">,</span>字典和集合用了哈希<span class="token punctuation">,</span>列表是挨个比较的<span class="token punctuation">.</span>推荐用字典<span class="token punctuation">.</span>
比如<span class="token punctuation">:</span>
   admin_permissions <span class="token operator">=</span> <span class="token punctuation">{</span>
       <span class="token string">&quot;/xxx/xx/&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span>url相关的其它信息<span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token string">&quot;/level/edit/&lt;int:id&gt;/&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span>
Q<span class="token punctuation">:</span>思考一个问题<span class="token punctuation">,</span>若访问的是动态路由<span class="token operator">/</span>level<span class="token operator">/</span>edit<span class="token operator">/</span><span class="token number">4</span><span class="token operator">/</span><span class="token punctuation">,</span> 那么<span class="token string">&quot;/level/edit/4/&quot;</span> <span class="token keyword">in</span> admin_permissions 的值为<span class="token boolean">False</span><span class="token punctuation">.</span>
A<span class="token punctuation">:</span>那如何是好? 用路由的name!!反向生成url<span class="token punctuation">.</span>  name代表的是一个url的唯一标识!!
  注意!在中间件里根据url的name进行权限的校验<span class="token punctuation">,</span>要清楚中间件生命周期的流程
      process_request <span class="token operator">-</span><span class="token operator">-</span> 路由匹配 <span class="token operator">-</span><span class="token operator">-</span> process_view <span class="token operator">-</span><span class="token operator">-</span> 视图 <span class="token operator">-</span><span class="token operator">-</span> process_response
      在路由匹配成功后<span class="token punctuation">,</span>才能拿到url相关信息<span class="token punctuation">(</span>name、namespace等<span class="token punctuation">)</span><span class="token punctuation">,</span>路由没匹配成功<span class="token punctuation">,</span>name是获取不到的<span class="token punctuation">,</span>
      路由匹配成功后<span class="token punctuation">,</span>通过`request<span class="token punctuation">.</span>resolver_match`获取<span class="token punctuation">.</span> So<span class="token punctuation">,</span>在中间件的process_view中进行校验!!
即<span class="token punctuation">:</span>
   admin_permissions <span class="token operator">=</span> <span class="token punctuation">{</span>
       <span class="token string">&quot;level_list&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span>url相关的其它信息<span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token string">&quot;level_edit&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token string">&quot;level_add&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token string">&quot;level_del&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><font color="green"><strong>优化一个细节</strong></font> - 方式二,用文件的形式</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>★ 优化一个细节<span class="token punctuation">,</span>在菜单里只展示菜单<span class="token punctuation">,</span>将在菜单下的添加删除编辑放到权限部分<span class="token punctuation">,</span>并添加一个关联关系即可<span class="token punctuation">.</span>
   管理员登陆后<span class="token punctuation">,</span>展示菜单就读取ADMIN这个列表即可
   点击菜单中的‘级别列表’<span class="token punctuation">,</span>发送了请求<span class="token punctuation">,</span>会先经过中间件<span class="token punctuation">,</span>在中间件里进行权限校验
      路由匹配成功 <span class="token operator">-</span><span class="token operator">-</span> 得到路由对象的name <span class="token operator">-</span><span class="token operator">-</span> 该name是否在admin_permissions字典中
      若在<span class="token punctuation">,</span>它是否有上级?比如 通过 <span class="token operator">/</span>level<span class="token operator">/</span>edit<span class="token operator">/</span><span class="token number">4</span><span class="token operator">/</span> 路由匹配成功 得到 name为level_edit<span class="token punctuation">,</span>其上级为level_list
   再去菜单中找<span class="token punctuation">,</span>若菜单中某个name为level_list<span class="token punctuation">,</span>那么该菜单应该被默认选中!!

<span class="token comment"># -- 菜单 (只做菜单展示)</span>
ADMIN <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;客户管理&quot;</span><span class="token punctuation">,</span> 
        <span class="token string">&quot;children&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;级别列表&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># ▲ url都可以不写,有name可以反向生成.</span>
                <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;level_list&quot;</span><span class="token punctuation">,</span>
                <span class="token comment"># &quot;children&quot;:[</span>
                    <span class="token comment"># {&quot;title&quot;:&quot;添加&quot;,&quot;url&quot;:&quot;...&quot;},</span>
                    <span class="token comment"># {&quot;title&quot;:&quot;编辑&quot;,&quot;url&quot;:&quot;...&quot;},</span>
                    <span class="token comment"># {&quot;title&quot;:&quot;删除&quot;,&quot;url&quot;:&quot;...&quot;},</span>
                <span class="token comment"># ],</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;客户列表&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;user_list&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;订单管理&quot;</span><span class="token punctuation">,</span> 
        <span class="token string">&quot;children&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;价格策略&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;交易策略&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;transaction&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
USER <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token comment"># -- 权限 (只做权限的校验)</span>
admin_permissions <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;level_list&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;level_edit&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token string">'parent'</span><span class="token punctuation">:</span><span class="token string">'level_list'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;level_add&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token string">'parent'</span><span class="token punctuation">:</span><span class="token string">'level_list'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;level_del&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token string">'parent'</span><span class="token punctuation">:</span><span class="token string">'level_list'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;user_list&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;transaction&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
user_permissions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h3 id="数据库的方式"><a href="#数据库的方式" class="header-anchor">#</a> 数据库的方式</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
客户管理
   级别列表
      <span class="token comment"># 添加</span>
      <span class="token comment"># 编辑</span>
      <span class="token comment"># 删除</span>
   客户列表
订单管理
   价格策略
   交易策略
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
★
这里的业务规定用户要么是管理员要么是普通用户<span class="token punctuation">.</span>所以不存在多个角色<span class="token punctuation">.</span>
扩展<span class="token punctuation">,</span>若一个用户对应多个角色<span class="token punctuation">,</span>那么还得创建一个 用户_角色的关系表!!

★
若让菜单表再跟角色表进行关联<span class="token punctuation">,</span>角色一多<span class="token punctuation">,</span>记录也多起来<span class="token punctuation">,</span>而且菜单角色表有点像角色权限表<span class="token punctuation">.</span><span class="token punctuation">.</span> So<span class="token punctuation">,</span>在权限表里加了一个is_menu字段!!
逻辑<span class="token punctuation">:</span><span class="token punctuation">(</span>假设是管理员登陆<span class="token punctuation">)</span>
  登陆后<span class="token punctuation">,</span>根据角色权限关联表得到权限
     eg<span class="token punctuation">:</span>类似于得到文件方式的admin_permissions字典<span class="token punctuation">.</span>
  在权限表里<span class="token punctuation">,</span>有些权限是菜单、有些不是菜单<span class="token punctuation">.</span>拿到是菜单的权限去菜单表里匹配<span class="token punctuation">,</span>获取到自己以及上级菜单<span class="token punctuation">.</span>
     eg<span class="token punctuation">:</span>类似于得到文件方式的ADMIN这个列表<span class="token punctuation">.</span>
  So<span class="token punctuation">,</span>在用户登陆时<span class="token punctuation">,</span>需进行表查询<span class="token punctuation">,</span>得到菜单字典和权限字典<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><img src="/assets/img/image-20230321124506176.c98c320a.png" alt="image-20230321124506176"></p> <hr> <h2 id="队列"><a href="#队列" class="header-anchor">#</a> 队列</h2> <blockquote><p>可作队列的服务 rabbitMQ、kafka、redis, 该项目选择用redis作队列服务.</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
mac
&quot;&quot;&quot;</span>
  <span class="token number">1</span><span class="token operator">&gt;</span> 在官方下载redis的源码包
  <span class="token number">2</span><span class="token operator">&gt;</span> 解压、编译 
     tar zxvf redis<span class="token operator">-</span><span class="token number">5.0</span><span class="token number">.14</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz
     sudo make test
     sudo make install
  <span class="token number">3</span><span class="token operator">&gt;</span> 修改redis的配置文件
  <span class="token number">4</span><span class="token operator">&gt;</span> 启动
One_Piece@DC的MacBook redis<span class="token operator">-</span><span class="token number">5.0</span><span class="token number">.14</span> <span class="token operator">%</span> pwd
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>redis<span class="token operator">-</span><span class="token number">5.0</span><span class="token number">.14</span>
<span class="token comment"># -- 修改两处地方,   bind 0.0.0.0     requirepass qwe123</span>
<span class="token comment"># ?requirepass直接跳转到requirepass的地方.</span>
One_Piece@DC的MacBook redis<span class="token operator">-</span><span class="token number">5.0</span><span class="token number">.14</span> <span class="token operator">%</span> vim redis<span class="token punctuation">.</span>conf
<span class="token comment"># -- 在本地启动redis</span>
One_Piece@DC的MacBook redis<span class="token operator">-</span><span class="token number">5.0</span><span class="token number">.14</span> <span class="token operator">%</span> <span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>redis<span class="token operator">-</span>server redis<span class="token punctuation">.</span>conf



<span class="token triple-quoted-string string">&quot;&quot;&quot;
使用python远程操作redis -- 短信验证读秒
pip install redis 扩展,还可以使用Django-redis模块!
&quot;&quot;&quot;</span>
<span class="token keyword">import</span> redis

conn <span class="token operator">=</span> redis<span class="token punctuation">.</span>Redis<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">6379</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'qwe123'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
conn<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'123456'</span><span class="token punctuation">,</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> ex<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># 设置了个超时时间,10s后该键值对就取不到啦!</span>
value <span class="token operator">=</span> conn<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'123456'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>  <span class="token comment"># b'hello'</span>



<span class="token triple-quoted-string string">&quot;&quot;&quot;
使用redis构建队列 -- 存取任务
运用redis构建一个先进先出的列表(队列), worker从里面取任务, 若有, 立刻取走, 若没有, 就等10s, 10s内没有就将连接断开.. 
再次发送一个请求, 重新连接.. 重新等待10s. 即没有数据的话, worker每10s向redis发送一个连接请求.. 
而不是队列中无数据, worker保持该连接一直等待队列中有数据. 减轻程序和redis的压力.
&quot;&quot;&quot;</span>
<span class="token keyword">import</span> redis

conn <span class="token operator">=</span> redis<span class="token punctuation">.</span>Redis<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">6379</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'qwe123'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token comment"># 往名为my_queue的队列里放了两个数据 'root'和'good'</span>
conn<span class="token punctuation">.</span>lpush<span class="token punctuation">(</span><span class="token string">'my_queue'</span><span class="token punctuation">,</span> <span class="token string">'root'</span><span class="token punctuation">)</span>
conn<span class="token punctuation">.</span>lpush<span class="token punctuation">(</span><span class="token string">'my_queue'</span><span class="token punctuation">,</span> <span class="token string">'good'</span><span class="token punctuation">)</span>
<span class="token comment"># 依次取出两个值后,阻塞5秒,得到一个返回值None</span>
<span class="token comment"># (b'my_queue', b'root')</span>
<span class="token comment"># (b'my_queue', b'good')</span>
<span class="token comment"># None</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    v <span class="token operator">=</span> conn<span class="token punctuation">.</span>brpop<span class="token punctuation">(</span><span class="token string">'my_queue'</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> v<span class="token punctuation">:</span>
        <span class="token keyword">break</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><hr> <h2 id="ajax"><a href="#ajax" class="header-anchor">#</a> Ajax</h2> <p><img src="/assets/img/image-20230323115711823.2d3eb5d3.png" alt="image-20230323115711823"></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">-</span><span class="token operator">-</span> form表单形式提交<span class="token punctuation">,</span>解决csrf <span class="token number">403</span>的报错<span class="token punctuation">.</span>
   ★ 在表单中加入 <span class="token punctuation">{</span><span class="token operator">%</span> csrf_token <span class="token operator">%</span><span class="token punctuation">}</span> 
   会自动生成一个隐藏的<span class="token builtin">input</span>标签<span class="token punctuation">.</span>name值为csrfmiddlewaretoken<span class="token punctuation">,</span>value值为随机的一串字符串<span class="token punctuation">.</span>
   点击submit按钮<span class="token punctuation">,</span>会提交到后端<span class="token punctuation">.</span>
<span class="token operator">-</span><span class="token operator">-</span> Ajax形式提交<span class="token punctuation">,</span>解决csrf403的报错<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><hr> <h2 id="创建项目"><a href="#创建项目" class="header-anchor">#</a> 创建项目</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token number">1</span><span class="token operator">&gt;</span> 创建虚拟环境的python项目
<span class="token number">2</span><span class="token operator">&gt;</span> pip install django<span class="token operator">==</span><span class="token number">3.2</span>
<span class="token number">3</span><span class="token operator">&gt;</span> django<span class="token operator">-</span>admin startproject order <span class="token punctuation">.</span>
<span class="token number">4</span><span class="token operator">&gt;</span> python manage<span class="token punctuation">.</span>py startapp web
   记得注册app
<span class="token number">5</span><span class="token operator">&gt;</span> pip install pymysql
   <span class="token triple-quoted-string string">&quot;&quot;&quot;
   import pymysql
   pymysql.install_as_MySQLdb()
   &quot;&quot;&quot;</span>
<span class="token number">6</span><span class="token operator">&gt;</span> pip install tencentcloud<span class="token operator">-</span>sdk<span class="token operator">-</span>python
<span class="token number">7</span><span class="token operator">&gt;</span> 纯净版Django
<span class="token number">8</span><span class="token operator">&gt;</span> 连接数据库的配置
   <span class="token triple-quoted-string string">&quot;&quot;&quot;
   DATABASES = {
       'default': {
           'ENGINE': 'django.db.backends.mysql',
           'NAME': 'order',
           'USER': 'root',
           'PASSWORD': '123456',
           'HOST': '127.0.0.1',
           'PORT': '3306',
           'CHARSET': 'utf8'
       },
   }
   &quot;&quot;&quot;</span>
<span class="token number">9</span><span class="token operator">&gt;</span> pip install django<span class="token operator">-</span>redis
   session的存储位置<span class="token punctuation">:</span> session存储到redis缓存中
   <span class="token triple-quoted-string string">&quot;&quot;&quot;
   CACHES = {
       &quot;default&quot;: {
           &quot;BACKEND&quot;: &quot;django_redis.cache.RedisCache&quot;,
           &quot;LOCATION&quot;: &quot;redis://127.0.0.1:6379&quot;,
           &quot;OPTIONS&quot;: {
               &quot;CLIENT_CLASS&quot;: &quot;django_redis.client.DefaultClient&quot;,
               &quot;CONNECTION_POOL_KWARGS&quot;: {&quot;max_connections&quot;: 100,&quot;encoding&quot;:&quot;utf-8&quot;},
               &quot;PASSWORD&quot;: &quot;qwe123&quot;,
           }
       }
   }

   SESSION_ENGINE = 'django.contrib.sessions.backends.cache'
   SESSION_CACHE_ALIAS = 'default'
   SESSION_COOKIE_NAME = &quot;sid&quot;
   SESSION_COOKIE_PATH = &quot;/&quot;
   SESSION_COOKIE_DOMAIN = None
   SESSION_COOKIE_SECURE = False
   SESSION_COOKIE_HTTPONLY = True
   SESSION_COOKIE_AGE = 1209600
   SESSION_EXPIRE_AT_BROWSER_CLOSE = False
   SESSION_SAVE_EVERY_REQUEST = True
   &quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><hr></div></div> <!----> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/b7b9ea/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">评论</div></a> <a href="/pages/80fa06/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">表结构</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/b7b9ea/" class="prev">评论</a></span> <span class="next"><a href="/pages/80fa06/">表结构</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/8sk2b3/"><div>
            搜索相关
            <!----></div></a> <span class="date">03-22</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/2kn2p2/"><div>
            CURD
            <!----></div></a> <span class="date">03-20</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/1kn1m1/"><div>
            自动生成
            <!----></div></a> <span class="date">03-15</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/OnePieceDC" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://www.cnblogs.com/DC0307/" title="博客园" target="_blank" class="iconfont icon-bokeyuan"></a><a href="https://music.163.com/#/song?id=1854188649" title="听音乐" target="_blank" class="iconfont icon-erji"></a><a href="https://www.jianshu.com/u/5310eb537315" title="简书" target="_blank" class="iconfont icon-jianshu"></a><a href="mailto:1415806497@qq.com" title="QQ" target="_blank" class="iconfont icon-youjian"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2024
    <span>DC | One Piece</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><!----><div id="goTop" class="hide-cat" data-v-8ccb5928></div><div></div><canvas id="vuepress-canvas-cursor"></canvas><div></div><div></div></div></div>
    <script src="/assets/js/app.ac54adc6.js" defer></script><script src="/assets/js/4.7ddc74e3.js" defer></script><script src="/assets/js/1.a0c4ff1b.js" defer></script><script src="/assets/js/3.8b03321d.js" defer></script><script src="/assets/js/84.3a32a1eb.js" defer></script><script src="/assets/js/104.cae2d944.js" defer></script><script src="/assets/js/184.46eabf07.js" defer></script>
  </body>
</html>
