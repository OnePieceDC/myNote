<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>用户名登陆 | DC&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/fonts/iconfont.css">
    <meta name="description" content="人类终将毁灭,世界属于三体!">
    <meta name="keywords" content="DC的个人博客.">
    
    <link rel="preload" href="/assets/css/0.styles.66b92039.css" as="style"><link rel="preload" href="/assets/js/app.ac54adc6.js" as="script"><link rel="preload" href="/assets/js/4.7ddc74e3.js" as="script"><link rel="preload" href="/assets/js/1.a0c4ff1b.js" as="script"><link rel="preload" href="/assets/js/3.8b03321d.js" as="script"><link rel="preload" href="/assets/js/85.2f47134e.js" as="script"><link rel="preload" href="/assets/js/104.cae2d944.js" as="script"><link rel="preload" href="/assets/js/184.46eabf07.js" as="script"><link rel="prefetch" href="/assets/js/10.a91ae011.js"><link rel="prefetch" href="/assets/js/100.2e8ea472.js"><link rel="prefetch" href="/assets/js/101.46f57a02.js"><link rel="prefetch" href="/assets/js/102.f51bcd80.js"><link rel="prefetch" href="/assets/js/103.3f003e0e.js"><link rel="prefetch" href="/assets/js/105.6c6ebc28.js"><link rel="prefetch" href="/assets/js/106.47dc8889.js"><link rel="prefetch" href="/assets/js/107.6b5602b4.js"><link rel="prefetch" href="/assets/js/108.46f0c21d.js"><link rel="prefetch" href="/assets/js/109.0f1168a5.js"><link rel="prefetch" href="/assets/js/11.e6a94228.js"><link rel="prefetch" href="/assets/js/110.6a961498.js"><link rel="prefetch" href="/assets/js/111.c6f27c88.js"><link rel="prefetch" href="/assets/js/112.9ee3d3bb.js"><link rel="prefetch" href="/assets/js/113.82b72aa0.js"><link rel="prefetch" href="/assets/js/114.7487460e.js"><link rel="prefetch" href="/assets/js/115.cd079d0a.js"><link rel="prefetch" href="/assets/js/116.b6b829eb.js"><link rel="prefetch" href="/assets/js/117.89d9336c.js"><link rel="prefetch" href="/assets/js/118.467c4437.js"><link rel="prefetch" href="/assets/js/119.c4b2ac40.js"><link rel="prefetch" href="/assets/js/12.9d3501e4.js"><link rel="prefetch" href="/assets/js/120.5ff31c09.js"><link rel="prefetch" href="/assets/js/121.2e59c3a5.js"><link rel="prefetch" href="/assets/js/122.a66096cf.js"><link rel="prefetch" href="/assets/js/123.4885ba5f.js"><link rel="prefetch" href="/assets/js/124.cacc66be.js"><link rel="prefetch" href="/assets/js/125.dc5b30fe.js"><link rel="prefetch" href="/assets/js/126.4e21eb5e.js"><link rel="prefetch" href="/assets/js/127.cb36a9bf.js"><link rel="prefetch" href="/assets/js/128.ce38358e.js"><link rel="prefetch" href="/assets/js/129.e5f414eb.js"><link rel="prefetch" href="/assets/js/13.ca017a68.js"><link rel="prefetch" href="/assets/js/130.17b597f0.js"><link rel="prefetch" href="/assets/js/131.e1ded2dc.js"><link rel="prefetch" href="/assets/js/132.aae1c627.js"><link rel="prefetch" href="/assets/js/133.73cecdb3.js"><link rel="prefetch" href="/assets/js/134.80cf38a0.js"><link rel="prefetch" href="/assets/js/135.735ed588.js"><link rel="prefetch" href="/assets/js/136.91f8db08.js"><link rel="prefetch" href="/assets/js/137.d6fb8bda.js"><link rel="prefetch" href="/assets/js/138.75cafe73.js"><link rel="prefetch" href="/assets/js/139.b01bf0db.js"><link rel="prefetch" href="/assets/js/14.ee2605b5.js"><link rel="prefetch" href="/assets/js/140.ff0a7911.js"><link rel="prefetch" href="/assets/js/141.c69e7f54.js"><link rel="prefetch" href="/assets/js/142.997b03ac.js"><link rel="prefetch" href="/assets/js/143.e40faea8.js"><link rel="prefetch" href="/assets/js/144.369f23e5.js"><link rel="prefetch" href="/assets/js/145.1268424d.js"><link rel="prefetch" href="/assets/js/146.94c65c4a.js"><link rel="prefetch" href="/assets/js/147.05fe6a36.js"><link rel="prefetch" href="/assets/js/148.327cc29d.js"><link rel="prefetch" href="/assets/js/149.90068676.js"><link rel="prefetch" href="/assets/js/15.42e0a0e4.js"><link rel="prefetch" href="/assets/js/150.b4b780bb.js"><link rel="prefetch" href="/assets/js/151.b4611012.js"><link rel="prefetch" href="/assets/js/152.4d2c8246.js"><link rel="prefetch" href="/assets/js/153.f32dfa58.js"><link rel="prefetch" href="/assets/js/154.b79a78fb.js"><link rel="prefetch" href="/assets/js/155.6ad2865c.js"><link rel="prefetch" href="/assets/js/156.fd49a1af.js"><link rel="prefetch" href="/assets/js/157.55113800.js"><link rel="prefetch" href="/assets/js/158.af321bc9.js"><link rel="prefetch" href="/assets/js/159.37d9c659.js"><link rel="prefetch" href="/assets/js/16.007f45b3.js"><link rel="prefetch" href="/assets/js/160.7a3b5a9a.js"><link rel="prefetch" href="/assets/js/161.fc1fbea8.js"><link rel="prefetch" href="/assets/js/162.2f8d3d1c.js"><link rel="prefetch" href="/assets/js/163.aa889940.js"><link rel="prefetch" href="/assets/js/164.5d8b2cb7.js"><link rel="prefetch" href="/assets/js/165.44d4a9b5.js"><link rel="prefetch" href="/assets/js/166.c1b4c4d4.js"><link rel="prefetch" href="/assets/js/167.0c39929e.js"><link rel="prefetch" href="/assets/js/168.fede035a.js"><link rel="prefetch" href="/assets/js/169.ff940d50.js"><link rel="prefetch" href="/assets/js/17.7395c644.js"><link rel="prefetch" href="/assets/js/170.b6fcb3bf.js"><link rel="prefetch" href="/assets/js/171.2b927a7c.js"><link rel="prefetch" href="/assets/js/172.b07a90a1.js"><link rel="prefetch" href="/assets/js/173.367352bf.js"><link rel="prefetch" href="/assets/js/174.4ea4e20f.js"><link rel="prefetch" href="/assets/js/175.d9679b61.js"><link rel="prefetch" href="/assets/js/176.f7804143.js"><link rel="prefetch" href="/assets/js/177.c5d1e680.js"><link rel="prefetch" href="/assets/js/178.808293fa.js"><link rel="prefetch" href="/assets/js/179.2acf6b3c.js"><link rel="prefetch" href="/assets/js/18.46f9153d.js"><link rel="prefetch" href="/assets/js/180.ddf3ecf7.js"><link rel="prefetch" href="/assets/js/181.4da0855c.js"><link rel="prefetch" href="/assets/js/182.591d135a.js"><link rel="prefetch" href="/assets/js/183.9d08f9fe.js"><link rel="prefetch" href="/assets/js/185.ee1c8428.js"><link rel="prefetch" href="/assets/js/186.c7b19133.js"><link rel="prefetch" href="/assets/js/187.52945990.js"><link rel="prefetch" href="/assets/js/188.a1d395c5.js"><link rel="prefetch" href="/assets/js/189.5b66165e.js"><link rel="prefetch" href="/assets/js/19.2db19edb.js"><link rel="prefetch" href="/assets/js/190.265a75de.js"><link rel="prefetch" href="/assets/js/191.b4c65143.js"><link rel="prefetch" href="/assets/js/192.cc4d4115.js"><link rel="prefetch" href="/assets/js/193.fa02ecc5.js"><link rel="prefetch" href="/assets/js/194.b0c9ad53.js"><link rel="prefetch" href="/assets/js/195.eda8cd34.js"><link rel="prefetch" href="/assets/js/196.cbae4dc6.js"><link rel="prefetch" href="/assets/js/197.693b1b85.js"><link rel="prefetch" href="/assets/js/198.8213665b.js"><link rel="prefetch" href="/assets/js/199.ddf0036d.js"><link rel="prefetch" href="/assets/js/2.4c15b693.js"><link rel="prefetch" href="/assets/js/20.6742e8ae.js"><link rel="prefetch" href="/assets/js/200.340df508.js"><link rel="prefetch" href="/assets/js/201.7431c15b.js"><link rel="prefetch" href="/assets/js/202.217b2b38.js"><link rel="prefetch" href="/assets/js/203.06c6a93d.js"><link rel="prefetch" href="/assets/js/204.a068a898.js"><link rel="prefetch" href="/assets/js/205.9361d3f5.js"><link rel="prefetch" href="/assets/js/206.886beca0.js"><link rel="prefetch" href="/assets/js/207.2278bda8.js"><link rel="prefetch" href="/assets/js/208.db0acc0d.js"><link rel="prefetch" href="/assets/js/209.0e05b204.js"><link rel="prefetch" href="/assets/js/21.fd552a4e.js"><link rel="prefetch" href="/assets/js/210.4c730041.js"><link rel="prefetch" href="/assets/js/211.417dbee1.js"><link rel="prefetch" href="/assets/js/212.eef4f4a3.js"><link rel="prefetch" href="/assets/js/213.ab742b0b.js"><link rel="prefetch" href="/assets/js/214.a57228de.js"><link rel="prefetch" href="/assets/js/215.37f52459.js"><link rel="prefetch" href="/assets/js/216.2f110f92.js"><link rel="prefetch" href="/assets/js/217.09654311.js"><link rel="prefetch" href="/assets/js/218.a7568950.js"><link rel="prefetch" href="/assets/js/219.628ee193.js"><link rel="prefetch" href="/assets/js/22.465a76d2.js"><link rel="prefetch" href="/assets/js/220.c5df9186.js"><link rel="prefetch" href="/assets/js/221.101ddb09.js"><link rel="prefetch" href="/assets/js/222.db210e3c.js"><link rel="prefetch" href="/assets/js/223.429cbf14.js"><link rel="prefetch" href="/assets/js/224.aa002868.js"><link rel="prefetch" href="/assets/js/225.79a40017.js"><link rel="prefetch" href="/assets/js/226.3e08228b.js"><link rel="prefetch" href="/assets/js/227.a09dd4b4.js"><link rel="prefetch" href="/assets/js/228.f930c492.js"><link rel="prefetch" href="/assets/js/229.f639a9e4.js"><link rel="prefetch" href="/assets/js/23.df6831af.js"><link rel="prefetch" href="/assets/js/230.e8ac7aad.js"><link rel="prefetch" href="/assets/js/231.99501214.js"><link rel="prefetch" href="/assets/js/232.e2932792.js"><link rel="prefetch" href="/assets/js/233.43dfa689.js"><link rel="prefetch" href="/assets/js/234.7951f9c4.js"><link rel="prefetch" href="/assets/js/235.1dc96b6c.js"><link rel="prefetch" href="/assets/js/236.40b8d4e4.js"><link rel="prefetch" href="/assets/js/237.75a692de.js"><link rel="prefetch" href="/assets/js/238.cc9d9ac1.js"><link rel="prefetch" href="/assets/js/239.4616a566.js"><link rel="prefetch" href="/assets/js/24.b68dc734.js"><link rel="prefetch" href="/assets/js/240.dd825147.js"><link rel="prefetch" href="/assets/js/241.85e3219b.js"><link rel="prefetch" href="/assets/js/242.bf4123c4.js"><link rel="prefetch" href="/assets/js/243.ce68f4f0.js"><link rel="prefetch" href="/assets/js/244.e2598d4d.js"><link rel="prefetch" href="/assets/js/245.2c696827.js"><link rel="prefetch" href="/assets/js/246.2c44a497.js"><link rel="prefetch" href="/assets/js/247.02405fce.js"><link rel="prefetch" href="/assets/js/248.6727bdf6.js"><link rel="prefetch" href="/assets/js/249.4901f575.js"><link rel="prefetch" href="/assets/js/25.d639c65c.js"><link rel="prefetch" href="/assets/js/250.c922c9ea.js"><link rel="prefetch" href="/assets/js/251.b1350ead.js"><link rel="prefetch" href="/assets/js/252.8295c5ea.js"><link rel="prefetch" href="/assets/js/253.b0a9ba20.js"><link rel="prefetch" href="/assets/js/254.d208b848.js"><link rel="prefetch" href="/assets/js/255.2cfb6ad3.js"><link rel="prefetch" href="/assets/js/256.e7687a81.js"><link rel="prefetch" href="/assets/js/257.db329d54.js"><link rel="prefetch" href="/assets/js/258.be75b1f9.js"><link rel="prefetch" href="/assets/js/259.67500f7e.js"><link rel="prefetch" href="/assets/js/26.9db429a9.js"><link rel="prefetch" href="/assets/js/260.73609cfa.js"><link rel="prefetch" href="/assets/js/261.22fc7c08.js"><link rel="prefetch" href="/assets/js/262.2c620ccd.js"><link rel="prefetch" href="/assets/js/263.e0ce1454.js"><link rel="prefetch" href="/assets/js/264.7fe82318.js"><link rel="prefetch" href="/assets/js/265.537d06c5.js"><link rel="prefetch" href="/assets/js/266.901695a7.js"><link rel="prefetch" href="/assets/js/267.8eb24590.js"><link rel="prefetch" href="/assets/js/268.a21e44dc.js"><link rel="prefetch" href="/assets/js/269.33e6ce5d.js"><link rel="prefetch" href="/assets/js/27.2296e284.js"><link rel="prefetch" href="/assets/js/270.31507ac3.js"><link rel="prefetch" href="/assets/js/271.b9406b42.js"><link rel="prefetch" href="/assets/js/272.0acaba6f.js"><link rel="prefetch" href="/assets/js/273.c2e359b0.js"><link rel="prefetch" href="/assets/js/274.a80428a6.js"><link rel="prefetch" href="/assets/js/28.7e4f4dc1.js"><link rel="prefetch" href="/assets/js/29.ba75f79a.js"><link rel="prefetch" href="/assets/js/30.16cd3622.js"><link rel="prefetch" href="/assets/js/31.54ed5bc1.js"><link rel="prefetch" href="/assets/js/32.b2fbba6a.js"><link rel="prefetch" href="/assets/js/33.f7ff0107.js"><link rel="prefetch" href="/assets/js/34.4b2cea7d.js"><link rel="prefetch" href="/assets/js/35.1159e74c.js"><link rel="prefetch" href="/assets/js/36.0b6296f3.js"><link rel="prefetch" href="/assets/js/37.fc67879e.js"><link rel="prefetch" href="/assets/js/38.637afaf8.js"><link rel="prefetch" href="/assets/js/39.748a78f3.js"><link rel="prefetch" href="/assets/js/40.4fede9bb.js"><link rel="prefetch" href="/assets/js/41.c7f0b087.js"><link rel="prefetch" href="/assets/js/42.5b1a487d.js"><link rel="prefetch" href="/assets/js/43.59275b93.js"><link rel="prefetch" href="/assets/js/44.b18a4c94.js"><link rel="prefetch" href="/assets/js/45.bc8f7cb3.js"><link rel="prefetch" href="/assets/js/46.6a4ec89f.js"><link rel="prefetch" href="/assets/js/47.e1e129e6.js"><link rel="prefetch" href="/assets/js/48.c284ce23.js"><link rel="prefetch" href="/assets/js/49.17e5dd65.js"><link rel="prefetch" href="/assets/js/5.e3d12916.js"><link rel="prefetch" href="/assets/js/50.34c3ac45.js"><link rel="prefetch" href="/assets/js/51.035f7031.js"><link rel="prefetch" href="/assets/js/52.e9ef227a.js"><link rel="prefetch" href="/assets/js/53.ecbb032d.js"><link rel="prefetch" href="/assets/js/54.e9af4cfe.js"><link rel="prefetch" href="/assets/js/55.7e71402b.js"><link rel="prefetch" href="/assets/js/56.511071fe.js"><link rel="prefetch" href="/assets/js/57.13b7fe79.js"><link rel="prefetch" href="/assets/js/58.e51f8b0e.js"><link rel="prefetch" href="/assets/js/59.a1b8bdb7.js"><link rel="prefetch" href="/assets/js/6.5fc3f358.js"><link rel="prefetch" href="/assets/js/60.fd7e1c08.js"><link rel="prefetch" href="/assets/js/61.0daf2361.js"><link rel="prefetch" href="/assets/js/62.04632944.js"><link rel="prefetch" href="/assets/js/63.f0dd5615.js"><link rel="prefetch" href="/assets/js/64.89a4b562.js"><link rel="prefetch" href="/assets/js/65.6764ff0c.js"><link rel="prefetch" href="/assets/js/66.049bdee1.js"><link rel="prefetch" href="/assets/js/67.b0d4ec16.js"><link rel="prefetch" href="/assets/js/68.46d97067.js"><link rel="prefetch" href="/assets/js/69.f540f0da.js"><link rel="prefetch" href="/assets/js/7.ce17dd73.js"><link rel="prefetch" href="/assets/js/70.17d8f857.js"><link rel="prefetch" href="/assets/js/71.b2a166a0.js"><link rel="prefetch" href="/assets/js/72.1c17a875.js"><link rel="prefetch" href="/assets/js/73.dac8984b.js"><link rel="prefetch" href="/assets/js/74.5bbc33ac.js"><link rel="prefetch" href="/assets/js/75.483644c7.js"><link rel="prefetch" href="/assets/js/76.de5461ab.js"><link rel="prefetch" href="/assets/js/77.7fa90702.js"><link rel="prefetch" href="/assets/js/78.f41853b8.js"><link rel="prefetch" href="/assets/js/79.598b50e6.js"><link rel="prefetch" href="/assets/js/80.61d2d23a.js"><link rel="prefetch" href="/assets/js/81.d310c6e4.js"><link rel="prefetch" href="/assets/js/82.22aa814c.js"><link rel="prefetch" href="/assets/js/83.f493eba4.js"><link rel="prefetch" href="/assets/js/84.3a32a1eb.js"><link rel="prefetch" href="/assets/js/86.74e65a77.js"><link rel="prefetch" href="/assets/js/87.e87bff96.js"><link rel="prefetch" href="/assets/js/88.aabc97af.js"><link rel="prefetch" href="/assets/js/89.b0945d87.js"><link rel="prefetch" href="/assets/js/90.630f62d3.js"><link rel="prefetch" href="/assets/js/91.ed816647.js"><link rel="prefetch" href="/assets/js/92.19065457.js"><link rel="prefetch" href="/assets/js/93.a0fe1919.js"><link rel="prefetch" href="/assets/js/94.51e48580.js"><link rel="prefetch" href="/assets/js/95.e591bede.js"><link rel="prefetch" href="/assets/js/96.1723f1d6.js"><link rel="prefetch" href="/assets/js/97.02bbb7d4.js"><link rel="prefetch" href="/assets/js/98.a3625ba6.js"><link rel="prefetch" href="/assets/js/99.1accbf48.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5959bfd2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.66b92039.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/nav-logo.png" alt="DC's blog" class="logo"> <span class="site-name can-hide">DC's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="IT必备" class="dropdown-title"><a href="/IT/" class="link-title">IT必备</a> <span class="title" style="display:none;">IT必备</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/IT/basis/" class="nav-link">计算机基础</a></li><li class="dropdown-item"><!----> <a href="/IT/linux/" class="nav-link">linux基础</a></li><li class="dropdown-item"><!----> <a href="/IT/mysql/" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/IT/git/" class="nav-link">git</a></li><li class="dropdown-item"><!----> <a href="/IT/structure/" class="nav-link">数据结构与算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><a href="/python/" class="link-title">Python</a> <span class="title" style="display:none;">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python/basis/" class="nav-link">opp</a></li><li class="dropdown-item"><!----> <a href="/python/oop/" class="nav-link">oop</a></li><li class="dropdown-item"><!----> <a href="/python/Network_concurrency/" class="nav-link">网络并发编程</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front_end/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front_end/html/" class="nav-link">html</a></li><li class="dropdown-item"><!----> <a href="/front_end/css/" class="nav-link">css</a></li><li class="dropdown-item"><!----> <a href="/front_end/js/" class="nav-link">javascript</a></li><li class="dropdown-item"><!----> <a href="/front_end/jquery/" class="nav-link">jquery</a></li><li class="dropdown-item"><!----> <a href="/front_end/ui/" class="nav-link">UI</a></li><li class="dropdown-item"><!----> <a href="/front_end/vue/" class="nav-link">vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/python_web/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python_web/django/" class="nav-link">Django</a></li><li class="dropdown-item"><!----> <a href="/python_web/drf/" class="nav-link">drf</a></li><li class="dropdown-item"><!----> <a href="/python_web/drf_re/" class="nav-link">drf_re</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实战" class="dropdown-title"><a href="/project/" class="link-title">实战</a> <span class="title" style="display:none;">实战</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前后端不分离</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/bbs/" class="nav-link">BBS</a></li><li class="dropdown-subitem"><a href="/project/order/" class="nav-link">订单系统</a></li><li class="dropdown-subitem"><a href="/project/crm/" class="nav-link">CRM</a></li></ul></li><li class="dropdown-item"><h4>前后端分离</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/supply/" class="nav-link">供应链系统</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><a href="/other/" class="link-title">其他</a> <span class="title" style="display:none;">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/essays/" class="nav-link">杂文</a></li><li class="dropdown-item"><h4>关于我</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/about/" class="nav-link">me</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><!----> <span class="title" style="display:;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/OnePieceDC/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.gif"> <div class="blogger-info"><h3>DC</h3> <span>愿我一生欢喜,不为世俗所及.</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="IT必备" class="dropdown-title"><a href="/IT/" class="link-title">IT必备</a> <span class="title" style="display:none;">IT必备</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/IT/basis/" class="nav-link">计算机基础</a></li><li class="dropdown-item"><!----> <a href="/IT/linux/" class="nav-link">linux基础</a></li><li class="dropdown-item"><!----> <a href="/IT/mysql/" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/IT/git/" class="nav-link">git</a></li><li class="dropdown-item"><!----> <a href="/IT/structure/" class="nav-link">数据结构与算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><a href="/python/" class="link-title">Python</a> <span class="title" style="display:none;">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python/basis/" class="nav-link">opp</a></li><li class="dropdown-item"><!----> <a href="/python/oop/" class="nav-link">oop</a></li><li class="dropdown-item"><!----> <a href="/python/Network_concurrency/" class="nav-link">网络并发编程</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front_end/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front_end/html/" class="nav-link">html</a></li><li class="dropdown-item"><!----> <a href="/front_end/css/" class="nav-link">css</a></li><li class="dropdown-item"><!----> <a href="/front_end/js/" class="nav-link">javascript</a></li><li class="dropdown-item"><!----> <a href="/front_end/jquery/" class="nav-link">jquery</a></li><li class="dropdown-item"><!----> <a href="/front_end/ui/" class="nav-link">UI</a></li><li class="dropdown-item"><!----> <a href="/front_end/vue/" class="nav-link">vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/python_web/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python_web/django/" class="nav-link">Django</a></li><li class="dropdown-item"><!----> <a href="/python_web/drf/" class="nav-link">drf</a></li><li class="dropdown-item"><!----> <a href="/python_web/drf_re/" class="nav-link">drf_re</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实战" class="dropdown-title"><a href="/project/" class="link-title">实战</a> <span class="title" style="display:none;">实战</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前后端不分离</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/bbs/" class="nav-link">BBS</a></li><li class="dropdown-subitem"><a href="/project/order/" class="nav-link">订单系统</a></li><li class="dropdown-subitem"><a href="/project/crm/" class="nav-link">CRM</a></li></ul></li><li class="dropdown-item"><h4>前后端分离</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/supply/" class="nav-link">供应链系统</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><a href="/other/" class="link-title">其他</a> <span class="title" style="display:none;">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/essays/" class="nav-link">杂文</a></li><li class="dropdown-item"><h4>关于我</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/about/" class="nav-link">me</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><!----> <span class="title" style="display:;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/OnePieceDC/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>BBS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>订单平台</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/bcb1d7/" class="sidebar-link">单点知识</a></li><li><a href="/pages/80fa06/" class="sidebar-link">表结构</a></li><li><a href="/pages/32e64d/" aria-current="page" class="active sidebar-link">用户名登陆</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/32e64d/#用户名登陆-初版" class="sidebar-link">用户名登陆(初版)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/32e64d/#路由配置" class="sidebar-link">路由配置</a></li><li class="sidebar-sub-header level3"><a href="/pages/32e64d/#登陆页面" class="sidebar-link">登陆页面</a></li><li class="sidebar-sub-header level5"><a href="/pages/32e64d/#注意的点" class="sidebar-link">注意的点!!</a></li><li class="sidebar-sub-header level5"><a href="/pages/32e64d/#用户名登陆页面代码" class="sidebar-link">用户名登陆页面代码</a></li><li class="sidebar-sub-header level5"><a href="/pages/32e64d/#短信登陆页面代码" class="sidebar-link">短信登陆页面代码</a></li><li class="sidebar-sub-header level3"><a href="/pages/32e64d/#视图函数" class="sidebar-link">视图函数</a></li><li class="sidebar-sub-header level5"><a href="/pages/32e64d/#注意的点-2" class="sidebar-link">注意的点!!</a></li><li class="sidebar-sub-header level5"><a href="/pages/32e64d/#初版代码" class="sidebar-link">初版代码</a></li><li class="sidebar-sub-header level3"><a href="/pages/32e64d/#简单测试" class="sidebar-link">简单测试</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/32e64d/#用户名登陆-form组件" class="sidebar-link">用户名登陆(form组件)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/32e64d/#视图函数-2" class="sidebar-link">视图函数</a></li><li class="sidebar-sub-header level3"><a href="/pages/32e64d/#页面部分代码" class="sidebar-link">页面部分代码</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/32e64d/#用户名登陆-优化" class="sidebar-link">用户名登陆(优化)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/32e64d/#form对象循环" class="sidebar-link">form对象循环</a></li><li class="sidebar-sub-header level3"><a href="/pages/32e64d/#错误信息位置" class="sidebar-link">错误信息位置</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/32e64d/#表单校验的流程" class="sidebar-link">表单校验的流程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/32e64d/#大致流程" class="sidebar-link">大致流程</a></li><li class="sidebar-sub-header level3"><a href="/pages/32e64d/#源码分析" class="sidebar-link">源码分析</a></li></ul></li></ul></li><li><a href="/pages/2e039e/" class="sidebar-link">短信登陆</a></li><li><a href="/pages/2853bf/" class="sidebar-link">菜单和权限</a></li><li><a href="/pages/87c2bf/" class="sidebar-link">级别管理</a></li><li><a href="/pages/dd38eb/" class="sidebar-link">客户管理</a></li><li><a href="/pages/c3db02/" class="sidebar-link">分页和搜索</a></li><li><a href="/pages/bba4be/" class="sidebar-link">价格策略</a></li><li><a href="/pages/524254/" class="sidebar-link">交易中心</a></li><li><a href="/pages/055dc6/" class="sidebar-link">message组件</a></li><li><a href="/pages/8fb2a4/" class="sidebar-link">我的交易列表</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CRM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>供应链</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-91157402><div class="articleInfo" data-v-91157402><ul class="breadcrumbs" data-v-91157402><li data-v-91157402><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-91157402></a></li> <li data-v-91157402><a href="/categories/?category=%E5%AE%9E%E6%88%98" title="分类" data-v-91157402>实战</a></li><li data-v-91157402><a href="/categories/?category=%E8%AE%A2%E5%8D%95%E5%B9%B3%E5%8F%B0" title="分类" data-v-91157402>订单平台</a></li></ul> <div class="info" data-v-91157402><div title="作者" class="author iconfont icon-touxiang" data-v-91157402><a href="https://github.com/OnePieceDC" target="_blank" title="作者" class="beLink" data-v-91157402>DC</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-91157402><a href="javascript:;" data-v-91157402>2023-06-30</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">用户名登陆<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p><strong>需求:</strong> 用户认证相关的功能, 两个方面 - 用户名和密码登录、短信登录.. 登陆成功后,在 <em>文件/数据库/缓存</em> 中保存用户信息的session..</p> <h2 id="用户名登陆-初版"><a href="#用户名登陆-初版" class="header-anchor">#</a> 用户名登陆(初版)</h2> <blockquote><p><strong>大致思路如下:</strong><br>
     先在页面上展示, 输入用户名和密码, 提交数据..<br>
     再根据数据去数据库中进行校验.. 若成功,用户信息写入session; 若失败, 在页面上展示错误信息.</p></blockquote> <h3 id="路由配置"><a href="#路由配置" class="header-anchor">#</a> 路由配置</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;总路由&quot;&quot;&quot;</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
<span class="token keyword">from</span> web<span class="token punctuation">.</span>views <span class="token keyword">import</span> account

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'login/'</span><span class="token punctuation">,</span> account<span class="token punctuation">.</span>login<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'sms/login/'</span><span class="token punctuation">,</span> account<span class="token punctuation">.</span>sms_login<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'sms_login'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="登陆页面"><a href="#登陆页面" class="header-anchor">#</a> 登陆页面</h3> <h5 id="注意的点"><a href="#注意的点" class="header-anchor">#</a> 注意的点!!</h5> <div class="language-python line-numbers-mode"><pre class="language-python"><code>模版层页面的编写<span class="token punctuation">,</span>需要注意的点<span class="token punctuation">:</span>
   <span class="token number">1</span><span class="token operator">&gt;</span> 注意!! 路由层那<span class="token punctuation">,</span>路由最前面无需加<span class="token operator">/</span> <span class="token punctuation">;</span> 在模版层<span class="token punctuation">,</span>路由前面需加 <span class="token operator">/</span>
      href<span class="token operator">=</span><span class="token string">&quot;/sms/login/&quot;</span> <span class="token operator">-</span><span class="token operator">-</span> 自动拼接路径是 <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">/</span>sms<span class="token operator">/</span>login
      href<span class="token operator">=</span><span class="token string">&quot;sms/login/&quot;</span>  <span class="token operator">-</span><span class="token operator">-</span> 自动拼接路径是 <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">/</span>login<span class="token operator">/</span>sms<span class="token operator">/</span>login
   <span class="token number">2</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;{% url 'sms_login' %}&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;float: right&quot;</span><span class="token operator">&gt;</span>短信登陆<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span> 使用name自动生成路由
   <span class="token number">3</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token operator">%</span> load static <span class="token operator">%</span><span class="token punctuation">}</span> 
      <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;stylesheet&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;{% static 'plugins/bootstrap-3.4.1/css/bootstrap.css' %}&quot;</span><span class="token operator">&gt;</span>
      动态的引入静态文件<span class="token punctuation">.</span>
      一般会在app下创建<span class="token number">4</span>个目录<span class="token punctuation">,</span>css、js、images、plugins
   <span class="token number">4</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token operator">%</span> csrf_token <span class="token operator">%</span><span class="token punctuation">}</span>  <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 前后端分离的话<span class="token punctuation">,</span>是用不到它的 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
   <span class="token number">5</span><span class="token operator">&gt;</span> 左边是输入框<span class="token punctuation">,</span>右边是`发送短信`的按钮<span class="token punctuation">,</span>可以用Bootstrap的珊格系统实现<span class="token punctuation">.</span>
   <span class="token number">6</span><span class="token operator">&gt;</span> 要有个单选框<span class="token punctuation">,</span>让登陆用户选择是管理员还是客户<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="用户名登陆页面代码"><a href="#用户名登陆页面代码" class="header-anchor">#</a> 用户名登陆页面代码</h5> <p><code>http://127.0.0.1:8000/login/</code></p> <p><img src="/assets/img/image-20230322193404368.045ddc3b.png" alt="image-20230322193404368"></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>{% load static %}
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>用户名密码登陆<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{% static 'plugins/bootstrap-3.4.1/css/bootstrap.css' %}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">.box</span> <span class="token punctuation">{</span>
            <span class="token property">width</span><span class="token punctuation">:</span> 480px<span class="token punctuation">;</span>
            <span class="token property">margin-left</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span> <span class="token comment">/* 盒子水平居中 */</span>
            <span class="token property">margin-right</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span> <span class="token comment">/* 盒子水平居中 */</span>
            <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #f0f0f0<span class="token punctuation">;</span>
            <span class="token property">margin-top</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
            <span class="token property">box-shadow</span><span class="token punctuation">:</span> 5px 10px 10px <span class="token function">rgb</span><span class="token punctuation">(</span>0 0 0 / 5%<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 阴影 */</span>
            <span class="token property">color</span><span class="token punctuation">:</span> gray<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">a</span> <span class="token punctuation">{</span>
            <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
            <span class="token property">color</span><span class="token punctuation">:</span> #5cb85c<span class="token punctuation">;</span>
            <span class="token property">opacity</span><span class="token punctuation">:</span> 0.6<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">a:hover</span> <span class="token punctuation">{</span>
            <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
            <span class="token property">color</span><span class="token punctuation">:</span> #5cb85c<span class="token punctuation">;</span>
            <span class="token property">opacity</span><span class="token punctuation">:</span> 0.9<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>用户名登陆<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        {% csrf_token %}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>role<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>管理员<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>客户<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>用户名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入用户名<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入密码<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>登陆<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-success<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span> brown</span><span class="token punctuation">&quot;</span></span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>error<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ error }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{% url 'sms_login' %}<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">float</span><span class="token punctuation">:</span> right</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>短信登陆<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">&quot;box&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><h5 id="短信登陆页面代码"><a href="#短信登陆页面代码" class="header-anchor">#</a> 短信登陆页面代码</h5> <p><code>http://127.0.0.1:8000/sms/login/</code></p> <p><img src="/assets/img/image-20230322193421670.4580b806.png" alt="image-20230322193421670"></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>{% load static %}
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>短信登陆<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{% static 'plugins/bootstrap-3.4.1/css/bootstrap.css' %}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">.box</span> <span class="token punctuation">{</span>
            <span class="token property">width</span><span class="token punctuation">:</span> 480px<span class="token punctuation">;</span>
            <span class="token property">margin-left</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span> <span class="token comment">/* 盒子水平居中 */</span>
            <span class="token property">margin-right</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span> <span class="token comment">/* 盒子水平居中 */</span>
            <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #f0f0f0<span class="token punctuation">;</span>
            <span class="token property">margin-top</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
            <span class="token property">box-shadow</span><span class="token punctuation">:</span> 5px 10px 10px <span class="token function">rgb</span><span class="token punctuation">(</span>0 0 0 / 5%<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 阴影 */</span>
            <span class="token property">color</span><span class="token punctuation">:</span> gray<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">a</span> <span class="token punctuation">{</span>
            <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
            <span class="token property">color</span><span class="token punctuation">:</span> #5cb85c<span class="token punctuation">;</span>
            <span class="token property">opacity</span><span class="token punctuation">:</span> 0.6<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">a:hover</span> <span class="token punctuation">{</span>
            <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
            <span class="token property">color</span><span class="token punctuation">:</span> #5cb85c<span class="token punctuation">;</span>
            <span class="token property">opacity</span><span class="token punctuation">:</span> 0.9<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>短信登陆<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        {% csrf_token %}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>role<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>管理员<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>客户<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>手机号<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mobile<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入手机号<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>短信验证码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-9<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>code<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入短信验证码<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-lg-3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>发送短信<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-default<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">float</span><span class="token punctuation">:</span> right</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>登陆<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-success<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{% url 'login' %}<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">float</span><span class="token punctuation">:</span> right</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>用户名登陆<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><h3 id="视图函数"><a href="#视图函数" class="header-anchor">#</a> 视图函数</h3> <h5 id="注意的点-2"><a href="#注意的点-2" class="header-anchor">#</a> 注意的点!!</h5> <div class="language-python line-numbers-mode"><pre class="language-python"><code>`http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>login<span class="token operator">/</span>` <span class="token operator">-</span><span class="token operator">-</span> login函数
<span class="token operator">-</span><span class="token operator">-</span> GET请求返回的是登陆页面
<span class="token operator">-</span><span class="token operator">-</span> POST请求<span class="token punctuation">,</span>提交数据到当前页面的地址<span class="token punctuation">.</span>
   <span class="token number">1</span><span class="token operator">&gt;</span> login函数获取表单信息 username、password、role
      并利用Form组件 <span class="token operator">&amp;</span> ModelForm组件 对获取的数据进行校验!! <span class="token operator">-</span><span class="token operator">-</span> 初版中没有<span class="token punctuation">,</span>在第二版中加
   <span class="token number">2</span><span class="token operator">&gt;</span> 将password转换成加密后的密码<span class="token punctuation">.</span><span class="token punctuation">(</span>通过加盐的md5进行的加密<span class="token punctuation">)</span>   数据库中存储的密码不可能是明文的!
   <span class="token number">3</span><span class="token operator">&gt;</span> 根据role找到数据库相应的表<span class="token punctuation">,</span>根据username、password看对象是否存在<span class="token punctuation">.</span>
      注<span class="token punctuation">:</span> 若该客户或管理员已经被删除了<span class="token punctuation">,</span>是不允许登陆的!! 所以查询条件还要加上active<span class="token operator">=</span><span class="token number">1</span>
      <span class="token operator">-</span> 若不存在<span class="token punctuation">,</span>返回登陆页面<span class="token punctuation">,</span>在登陆按钮后面显示 <span class="token string">&quot;用户名或密码错误&quot;</span><span class="token punctuation">,</span>点击盒子任一地方<span class="token punctuation">,</span>错误信息消失<span class="token punctuation">.</span>
      <span class="token operator">-</span> 若存在<span class="token punctuation">,</span>将用户信息存储到session中<span class="token punctuation">.</span>并进入项目后台<span class="token punctuation">.</span>
        注<span class="token punctuation">:</span> session是存储在redis缓存中的!
 
★<span class="token punctuation">[</span>思考<span class="token punctuation">]</span>
<span class="token number">1</span><span class="token operator">&gt;</span> 思考一个问题<span class="token punctuation">,</span>返回登陆页面<span class="token punctuation">,</span>显示错误信息<span class="token punctuation">,</span><span class="token punctuation">,</span>会进行刷新页面的操作!!用户在<span class="token builtin">input</span>框里填写的内容会被清除
   若<span class="token builtin">input</span>框很多<span class="token punctuation">,</span>用户体验会很差!!
<span class="token number">2</span><span class="token operator">&gt;</span> 若用户在表单里填写的用户名和密码为空<span class="token punctuation">,</span>后端接受到了<span class="token punctuation">,</span>肯定是不合法的<span class="token punctuation">,</span>还去数据库中进行验证?压根就不用了<span class="token punctuation">.</span>
   So<span class="token punctuation">,</span>在查询数据库之前<span class="token punctuation">,</span>需要对前端传递过来的数据进行 <span class="token operator">&lt;</span>数据格式或是否为空的验证<span class="token operator">&gt;</span>!!
   像这样吗? 
   <span class="token keyword">if</span> <span class="token keyword">not</span> username<span class="token punctuation">:</span>
       <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;login.html&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;用户名或密码错误!&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
   No<span class="token punctuation">,</span>字段少还好办<span class="token punctuation">,</span>字段一多就难顶啦!!
解决方案<span class="token punctuation">:</span>使用Form组件 <span class="token operator">&amp;</span> ModelForm组件!!
  
  
★<span class="token punctuation">[</span>小细节<span class="token punctuation">]</span>
这里有个小细节<span class="token punctuation">,</span>订单系统使用配置文件的形式来设置菜单和权限 <span class="token operator">+</span> 在表单里选择角色时<span class="token punctuation">,</span>传给后端的是数字<span class="token string">&quot;1&quot;</span>、<span class="token string">&quot;2&quot;</span>
eg<span class="token punctuation">:</span> 在settings文件里这样配置<span class="token punctuation">.</span>
  MENU <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;ADMIN&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">&quot;CUSTOMER&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  PERMISSION <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;ADMIN&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">&quot;CUSTOMER&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
在视图函数里<span class="token punctuation">,</span>建立对应关系<span class="token punctuation">,</span>mapping <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;ADMIN&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;CUSTOMER&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>更加的直观!!
request<span class="token punctuation">.</span>session<span class="token punctuation">[</span><span class="token string">'user_info'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'role'</span><span class="token punctuation">:</span> mapping<span class="token punctuation">[</span>role<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> user_obj<span class="token punctuation">.</span>username<span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> user_obj<span class="token punctuation">.</span>pk<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h5 id="初版代码"><a href="#初版代码" class="header-anchor">#</a> 初版代码</h5> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
web.views.account 账户相关的,用户名密码登陆、短信登陆、注销
&quot;&quot;&quot;</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span> redirect
<span class="token keyword">from</span> web <span class="token keyword">import</span> models
<span class="token keyword">from</span> utils<span class="token punctuation">.</span>encrypt <span class="token keyword">import</span> md5


<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;login.html&quot;</span><span class="token punctuation">)</span>

    username <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> md5<span class="token punctuation">(</span>password<span class="token punctuation">)</span>
    role <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;role&quot;</span><span class="token punctuation">)</span>

    mapping <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;ADMIN&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;CUSTOMER&quot;</span><span class="token punctuation">}</span>
    <span class="token keyword">if</span> role <span class="token keyword">not</span> <span class="token keyword">in</span> mapping<span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;login.html&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;选择的角色不存在!&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> role <span class="token operator">==</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">:</span>
        user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>Administrator<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>active<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> username<span class="token operator">=</span>username<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>Customer<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>active<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> username<span class="token operator">=</span>username<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token keyword">not</span> user_obj<span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;login.html&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;用户名或密码错误!&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    request<span class="token punctuation">.</span>session<span class="token punctuation">[</span><span class="token string">'user_info'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'role'</span><span class="token punctuation">:</span> mapping<span class="token punctuation">[</span>role<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> user_obj<span class="token punctuation">.</span>username<span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> user_obj<span class="token punctuation">.</span>pk<span class="token punctuation">}</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">&quot;/home/&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">sms_login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;sms_login.html&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h3 id="简单测试"><a href="#简单测试" class="header-anchor">#</a> 简单测试</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
写两个离线脚本 init_admin.py 和 init_customer.py 通过md5加密创建 管理员和客户,进行测试!!
管理员: dc - admin123!
客户: wupeiqi - wupeiqi123
     egon - egon123
&quot;&quot;&quot;</span>
<span class="token comment"># -- init_customer.py</span>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> django

base_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>base_dir<span class="token punctuation">)</span>

os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">'DJANGO_SETTINGS_MODULE'</span><span class="token punctuation">,</span> <span class="token string">'order.settings'</span><span class="token punctuation">)</span>
django<span class="token punctuation">.</span>setup<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> web <span class="token keyword">import</span> models
    <span class="token keyword">from</span> utils<span class="token punctuation">.</span>encrypt <span class="token keyword">import</span> md5

    level_object <span class="token operator">=</span> models<span class="token punctuation">.</span>Level<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">&quot;VIP&quot;</span><span class="token punctuation">,</span> percent<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span>  <span class="token comment"># 创建级别</span>

    models<span class="token punctuation">.</span>Customer<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
        username<span class="token operator">=</span><span class="token string">'wupeiqi'</span><span class="token punctuation">,</span>
        password<span class="token operator">=</span>md5<span class="token punctuation">(</span><span class="token string">&quot;wupeiqi123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        mobile<span class="token operator">=</span><span class="token string">'17387677890'</span><span class="token punctuation">,</span>
        level<span class="token operator">=</span>level_object<span class="token punctuation">,</span>
        creator_id<span class="token operator">=</span><span class="token number">1</span>
    <span class="token punctuation">)</span>

    models<span class="token punctuation">.</span>Customer<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
        username<span class="token operator">=</span><span class="token string">'egon'</span><span class="token punctuation">,</span>
        password<span class="token operator">=</span>md5<span class="token punctuation">(</span><span class="token string">&quot;egon123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        mobile<span class="token operator">=</span><span class="token string">'18954787888'</span><span class="token punctuation">,</span>
        level_id<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
        creator_id<span class="token operator">=</span><span class="token number">1</span>
    <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><hr> <h2 id="用户名登陆-form组件"><a href="#用户名登陆-form组件" class="header-anchor">#</a> 用户名登陆(form组件)</h2> <blockquote><p>使用Form组件 &amp; ModelForm组件!!<br> <strong>解决了两个问题:</strong> 登陆失败返回&quot;用户名或密码错误&quot;,页面会刷新,输入框里的值消失; 在查询数据库之前对接受到的数据进行验证!!</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code>form组件的作用<span class="token punctuation">:</span>
   <span class="token triple-quoted-string string">&quot;&quot;&quot;
   username = forms.CharField(
       initial=&quot;egon&quot;,  # -- 设置默认值 
       required=True,   # -- 数据校验,该表单字段不能为空!必填项.默认required=True,此行代码可不填.
       widget=forms.TextInput(attrs={&quot;class&quot;: &quot;form-control&quot;, &quot;placeholder&quot;: &quot;请输入用户名&quot;})
   )
   &quot;&quot;&quot;</span>
   <span class="token triple-quoted-string string">&quot;&quot;&quot;
   def login(request):
       if request.method == &quot;GET&quot;:
           form = LoginForm(initial={&quot;username&quot;: &quot;alex&quot;})  # -- 可设置默认值.两处都设置了,会以此处的为准.
           return render(request, &quot;login.html&quot;, {&quot;form&quot;: form})
       form = LoginForm(data=request.POST)  # -- 传入了request.POST请求体中的数据
       if not form.is_valid():
           return render(request, &quot;login.html&quot;, {&quot;form&quot;: form})
   &quot;&quot;&quot;</span>
   <span class="token number">1.</span>通过几行代码<span class="token punctuation">,</span>可以在页面上生成html标签内容<span class="token punctuation">.</span>
   <span class="token number">2.</span>当点击submit按钮提交数据<span class="token punctuation">,</span>若登陆失败<span class="token punctuation">,</span>返回的是当前登陆页面<span class="token punctuation">,</span>页面会刷新<span class="token punctuation">,</span>但表单的内容不会消失!
   <span class="token number">3.</span>显示页面时<span class="token punctuation">,</span>表单输入框的内容可以有默认值<span class="token punctuation">.</span> 应用场景<span class="token punctuation">:</span>在对表单信息进行编辑的页面<span class="token punctuation">,</span>编辑页面显示默认值!!
   <span class="token number">4.</span>可以在查询数据库之前对用户提交的表单数据的格式进行校验<span class="token punctuation">.</span>
     ★ 不仅可以简单的校验字段值是否为空<span class="token punctuation">,</span>还有更高阶的用法<span class="token punctuation">:</span> 正则表达式、钩子函数<span class="token punctuation">(</span>eg<span class="token punctuation">:</span>校验需要打开某个文件<span class="token punctuation">)</span>等<span class="token punctuation">.</span>
     钩子函数 <span class="token keyword">def</span> clean_字段名<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">pass</span> 若函数体里<span class="token keyword">raise</span>异常<span class="token punctuation">,</span>该字段校验不通过<span class="token punctuation">;</span>若有返回值<span class="token punctuation">,</span>校验通过<span class="token punctuation">.</span>
      
   综上<span class="token punctuation">,</span>两个方面<span class="token punctuation">:</span> 
     <span class="token number">1</span><span class="token operator">&gt;</span> 生成html标签<span class="token operator">+</span>携带数据<span class="token punctuation">;</span> 
     <span class="token number">2</span><span class="token operator">&gt;</span> 数据校验<span class="token punctuation">.</span>
     form表单提交<span class="token punctuation">,</span>这两方面都会用到<span class="token punctuation">;</span>ajax提交不会刷新页面<span class="token punctuation">,</span>通常只会用第二方面<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="视图函数-2"><a href="#视图函数-2" class="header-anchor">#</a> 视图函数</h3> <blockquote><p>校验失败,显示错误信息; 校验成功, 取出数据, 连接数据库再进行其它操作!!</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
账户相关的,用户名密码登陆、短信登陆、注销
&quot;&quot;&quot;</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span> redirect
<span class="token keyword">from</span> web <span class="token keyword">import</span> models
<span class="token keyword">from</span> utils<span class="token punctuation">.</span>encrypt <span class="token keyword">import</span> md5

<span class="token keyword">from</span> django <span class="token keyword">import</span> forms


<span class="token keyword">class</span> <span class="token class-name">LoginForm</span><span class="token punctuation">(</span>forms<span class="token punctuation">.</span>Form<span class="token punctuation">)</span><span class="token punctuation">:</span>
    role <span class="token operator">=</span> forms<span class="token punctuation">.</span>ChoiceField<span class="token punctuation">(</span>
        required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 必填项,默认required值就为True,这行代码可不填.</span>
        choices<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;管理员&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;客户&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment"># 这里的变量名role就是该select标签的name属性值</span>
        widget<span class="token operator">=</span>forms<span class="token punctuation">.</span>Select<span class="token punctuation">(</span>attrs<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;class&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;form-control&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    username <span class="token operator">=</span> forms<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>
        widget<span class="token operator">=</span>forms<span class="token punctuation">.</span>TextInput<span class="token punctuation">(</span>attrs<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;class&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;form-control&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;placeholder&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;请输入用户名&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    password <span class="token operator">=</span> forms<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>
        widget<span class="token operator">=</span>forms<span class="token punctuation">.</span>PasswordInput<span class="token punctuation">(</span>
            attrs<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;class&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;form-control&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;placeholder&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;请输入密码&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            render_value<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 表单里,密码是默认不保留的,加了该配置后,密码也可以保留</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">:</span>
        form <span class="token operator">=</span> LoginForm<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;login.html&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;form&quot;</span><span class="token punctuation">:</span> form<span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment"># 验证接收到的数据</span>
    form <span class="token operator">=</span> LoginForm<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> form<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 开始验证</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;login.html&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;form&quot;</span><span class="token punctuation">:</span> form<span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    username = request.POST.get(&quot;username&quot;)
    password = request.POST.get(&quot;password&quot;)
    password = md5(password)
    role = request.POST.get(&quot;role&quot;)
    &quot;&quot;&quot;</span>
    <span class="token comment"># print(form.cleaned_data)  # {'role': '1', 'username': 'dc', 'password': 'admin123!'}</span>
    username <span class="token operator">=</span> form<span class="token punctuation">.</span>cleaned_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> form<span class="token punctuation">.</span>cleaned_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> md5<span class="token punctuation">(</span>password<span class="token punctuation">)</span>
    role <span class="token operator">=</span> form<span class="token punctuation">.</span>cleaned_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;role&quot;</span><span class="token punctuation">)</span>

    mapping <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;ADMIN&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;CUSTOMER&quot;</span><span class="token punctuation">}</span>
    <span class="token keyword">if</span> role <span class="token keyword">not</span> <span class="token keyword">in</span> mapping<span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;login.html&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;选择的角色不存在!&quot;</span><span class="token punctuation">,</span> <span class="token string">'form'</span><span class="token punctuation">:</span> form<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> role <span class="token operator">==</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">:</span>
        user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>Administrator<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>active<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> username<span class="token operator">=</span>username<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>Customer<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>active<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> username<span class="token operator">=</span>username<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token keyword">not</span> user_obj<span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;login.html&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;用户名或密码错误!&quot;</span><span class="token punctuation">,</span> <span class="token string">'form'</span><span class="token punctuation">:</span> form<span class="token punctuation">}</span><span class="token punctuation">)</span>

    request<span class="token punctuation">.</span>session<span class="token punctuation">[</span><span class="token string">'user_info'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'role'</span><span class="token punctuation">:</span> mapping<span class="token punctuation">[</span>role<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> user_obj<span class="token punctuation">.</span>username<span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> user_obj<span class="token punctuation">.</span>pk<span class="token punctuation">}</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">&quot;/home/&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">sms_login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;sms_login.html&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><h3 id="页面部分代码"><a href="#页面部分代码" class="header-anchor">#</a> 页面部分代码</h3> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>用户名登陆<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 记得加上 novalidate --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span> <span class="token attr-name">novalidate</span><span class="token punctuation">&gt;</span></span>
        {% csrf_token %}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token comment">&lt;!--
                    &lt;select class=&quot;form-control&quot; name=&quot;role&quot;&gt;
                        &lt;option value=&quot;1&quot;&gt;管理员&lt;/option&gt;
                        &lt;option value=&quot;2&quot;&gt;客户&lt;/option&gt;
                    &lt;/select&gt;
                    --&gt;</span>
                    {{ form.role }}
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>用户名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--
            &lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;请输入用户名&quot; class=&quot;form-control&quot;&gt;
            --&gt;</span>
            {{ form.username }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--
            &lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;请输入密码&quot; class=&quot;form-control&quot;&gt;
            --&gt;</span>
            {{ form.password }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>登陆<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-success<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span> brown</span><span class="token punctuation">&quot;</span></span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>error<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ error }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{% url 'sms_login' %}<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">float</span><span class="token punctuation">:</span> right</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>短信登陆<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">&quot;box&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><hr> <h2 id="用户名登陆-优化"><a href="#用户名登陆-优化" class="header-anchor">#</a> 用户名登陆(优化)</h2> <h3 id="form对象循环"><a href="#form对象循环" class="header-anchor">#</a> form对象循环</h3> <blockquote><p>字段一多的话, 会省事很多!!</p></blockquote> <p><font color="blue">Django支持在模版里对 <code>form = LoginForm()</code> form对象进行循环!</font> 循环出来的是, 一个个的字段!</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">-</span><span class="token operator">-</span> 默认required<span class="token operator">=</span><span class="token boolean">True</span>在源码中的体现!
role <span class="token operator">=</span> forms<span class="token punctuation">.</span>ChoiceField<span class="token punctuation">(</span><span class="token punctuation">)</span> 点ChoiceField查看源码<span class="token punctuation">,</span>该类继承了Field类<span class="token punctuation">,</span>Field类的__init__里required<span class="token operator">=</span><span class="token boolean">True</span>!!

<span class="token operator">-</span><span class="token operator">-</span> role <span class="token operator">=</span> forms<span class="token punctuation">.</span>ChoiceField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">&quot;角色&quot;</span><span class="token punctuation">)</span> 
   ChoiceField类加括号<span class="token punctuation">,</span>相当于类实例化<span class="token punctuation">,</span>ChoiceField类继承了Field类<span class="token punctuation">,</span>Field类的__init__里有lable
   传入label后<span class="token punctuation">,</span>self<span class="token punctuation">.</span>label <span class="token operator">=</span> label 
   这意味着role对象的内部有一个label成员<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="/assets/img/image-20230323144815026.b48f40fa.png" alt="image-20230323144815026"></p> <h3 id="错误信息位置"><a href="#错误信息位置" class="header-anchor">#</a> 错误信息位置</h3> <blockquote><p>每个字段验证不通过, 出现的错误信息应该在当前字段的下方!</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code>运用”子绝父相“显示错误信息 <span class="token operator">-</span><span class="token operator">-</span>  可以简单理解为浮动起来啦<span class="token punctuation">,</span>不占据标准流中的位置<span class="token punctuation">.</span>有没有错误提示都不会影响页面布局!
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-django line-numbers-mode"><pre class="language-django"><code>        <span class="token django language-django"><span class="token delimiter punctuation">{%</span> <span class="token tag keyword">for</span> <span class="token variable">field</span> <span class="token keyword">in</span>  <span class="token variable">form</span> <span class="token delimiter punctuation">%}</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-group<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 21px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
                <span class="token django language-django"><span class="token delimiter punctuation">{%</span> <span class="token tag keyword">if</span> <span class="token variable">field</span><span class="token punctuation">.</span><span class="token variable">name</span> <span class="token operator">==</span> <span class="token string">&quot;role&quot;</span> <span class="token delimiter punctuation">%}</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token django language-django"><span class="token delimiter punctuation">{{</span> <span class="token variable">field</span> <span class="token delimiter punctuation">}}</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token django language-django"><span class="token delimiter punctuation">{%</span> <span class="token tag keyword">else</span> <span class="token delimiter punctuation">%}</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span><span class="token django language-django"><span class="token delimiter punctuation">{{</span> <span class="token variable">field</span><span class="token punctuation">.</span><span class="token variable">label</span> <span class="token delimiter punctuation">}}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                    <span class="token django language-django"><span class="token delimiter punctuation">{{</span> <span class="token variable">field</span> <span class="token delimiter punctuation">}}</span></span>
                <span class="token django language-django"><span class="token delimiter punctuation">{%</span> <span class="token tag keyword">endif</span> <span class="token delimiter punctuation">%}</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span> #ff6b6b<span class="token punctuation">;</span> <span class="token property">position</span><span class="token punctuation">:</span> absolute</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token django language-django"><span class="token delimiter punctuation">{{</span> <span class="token variable">field</span><span class="token punctuation">.</span><span class="token variable">errors</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token delimiter punctuation">}}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token django language-django"><span class="token delimiter punctuation">{%</span> <span class="token tag keyword">endfor</span> <span class="token delimiter punctuation">%}</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><img src="/assets/img/image-20230323151103214.89cb0636.png" alt="image-20230323151103214"></p> <hr> <h2 id="表单校验的流程"><a href="#表单校验的流程" class="header-anchor">#</a> 表单校验的流程</h2> <blockquote><p>Form组件目的: 生成标签 + 校验
生成标签<br>
1&gt; 循环 or 单独某个字段<br>
2&gt; label页面显示文本信息<br>
3&gt; 自定义错误信息位置, position</p> <p>下面探讨下表单校验的流程!!</p></blockquote> <h3 id="大致流程"><a href="#大致流程" class="header-anchor">#</a> 大致流程</h3> <blockquote><p><font color="blue">&lt;依次&gt; 执行下面三步!</font><br> <strong>第一步:</strong><br>
for field in fields:<br>
     try:<br>
         字段内部的校验, required=True、validators=[]、min_length=6、max_length=10<br> <font color="green" size="2">校验成功 <code>self.cleaned_data['字段名'] = 表单里对应的值</code> 校验失败,抛出异常,且self.cleaned_data中没有该字段,下一个字段的钩子里就取不到</font><br>
         字段的钩子方法..<br> <font color="green" size="2">校验成功 <code>self.cleaned_data['字段名'] = 钩子方法的返回值</code></font><br>
         (上面的两个小部分在执行过程中都可能抛出异常, <em>若字段内部的校验抛出异常,字段的钩子方法就不会执行</em> )<br>
     except ValidationError as e:<br>
         放到了errors里, 键是出现错误的字段,值是错误信息 <font color="green" size="2">校验失败 <code>self.errors['字段名'] = 错误信息</code></font><br> <strong>第二步:</strong> 执行clean()方法<br> <font color="green" size="2">校验失败, <code>self.errors[&quot;__all__&quot;] = 错误信息</code></font><br> <font color="green" size="2">校验成功, 注意clean方法的返回值, 若返回值不是None, <code>self.cleaned_data = 返回值</code></font><br> <strong>第三步:</strong> 执行_post_clean()方法</p> <p>★ 校验成功, self.cleaned_data中有所有校验成功的键值对; 校验失败,self.errors里有所有校验失败的信息.<br> <em>Ps: 此处的self是自定义的表单校验类LoginForm的实例化对象form..</em><br> <font color="brown">在模版里取错误,</font><br> <code>form.errors.username.0</code> ;<br>
     若用到了循环, <code>field.errors.0</code> (这里的field是指username字段)<br>
     若是在第二步执行clean方法抛出的错误 <code>form.non_field_errors.0</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>form <span class="token operator">=</span> LoginForm<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span>

self<span class="token punctuation">.</span>errors 是<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'django.forms.utils.ErrorDict'</span><span class="token operator">&gt;</span> 类型的数据 
假如<span class="token punctuation">,</span>用户名为空<span class="token punctuation">,</span>密码填入的不全是数字且密码小于<span class="token number">6</span>位<span class="token punctuation">.</span>打印self<span class="token punctuation">.</span>errors结果为<span class="token punctuation">.</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
&lt;ul class=&quot;errorlist&quot;&gt;
    &lt;li&gt;username
        &lt;ul class=&quot;errorlist&quot;&gt;
            &lt;li&gt;用户名不能为空!&lt;/li&gt;
        &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;password
        &lt;ul class=&quot;errorlist&quot;&gt;
            &lt;li&gt;密码请输入数字&lt;/li&gt;
            &lt;li&gt;密码至少是6位!&lt;/li&gt;
        &lt;/ul&gt;
    &lt;/li&gt;
&lt;/ul&gt;
&quot;&quot;&quot;</span>
但self<span class="token punctuation">.</span>errors的本质就是字典!! self<span class="token punctuation">.</span>errors<span class="token punctuation">[</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
之所以取第一个<span class="token punctuation">,</span> 因为password这个字段可能在字段内部校验过程中有多个不符合的!! 


探究下<span class="token punctuation">,</span>为何是这样的?! <span class="token keyword">from</span> django<span class="token punctuation">.</span>forms<span class="token punctuation">.</span>utils <span class="token keyword">import</span> ErrorDict 查看ErrorDict类的源码!
<span class="token keyword">class</span> <span class="token class-name">ErrorDict</span><span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
下面用简单的代码来解释下原理<span class="token punctuation">.</span>没啥深奥的<span class="token punctuation">,</span>就是面向对象的知识!!
<span class="token triple-quoted-string string">&quot;&quot;&quot;
class ErrorDict(dict):
    def __str__(self):
        return self.as_ul()

    def as_ul(self):
        for k, v in self.items():
            item = &quot;&lt;ul&gt;{}&lt;/ul&gt;&quot;.format(k)
            return item

obj = ErrorDict()
obj[&quot;k1&quot;] = [1, 2, 3]
obj[&quot;k1&quot;] = [4, 5]
print(obj)  # &lt;ul&gt;k1&lt;/ul&gt;
&quot;&quot;&quot;</span>
<span class="token operator">-</span> 稍微实践了下<span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> form<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># &lt;ul class=&quot;errorlist&quot;&gt;&lt;li&gt;mobile&lt;ul class=&quot;errorlist&quot;&gt;&lt;li&gt;手机格式错误&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>form<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>
        <span class="token comment"># {'mobile': [ValidationError(['手机格式错误'])]}</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>form<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>as_data<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># {&quot;mobile&quot;: [{&quot;message&quot;: &quot;\u624b\u673a\u683c\u5f0f\u9519\u8bef&quot;, &quot;code&quot;: &quot;invalid&quot;}]}</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>form<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>as_json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>细说下<span class="token punctuation">,</span>form<span class="token punctuation">.</span>non_field_errors<span class="token punctuation">.</span><span class="token number">0</span>
执行clean<span class="token punctuation">(</span><span class="token punctuation">)</span>方法的过程中报错<span class="token punctuation">,</span>在源码里 self<span class="token punctuation">.</span>add_error<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> self<span class="token punctuation">.</span>errors<span class="token punctuation">[</span><span class="token string">&quot;__all__&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> e
<span class="token punctuation">(</span>此处的self就是form<span class="token punctuation">)</span>
self里有non_field_errors方法!! self<span class="token punctuation">.</span>non_field_errors<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token operator">&lt;=</span>等同于<span class="token operator">=</span><span class="token operator">&gt;</span>  self<span class="token punctuation">.</span>errors<span class="token punctuation">[</span><span class="token string">&quot;__all__&quot;</span><span class="token punctuation">]</span>
源代码如下<span class="token punctuation">:</span>
     <span class="token keyword">def</span> <span class="token function">non_field_errors</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># -- command+b跳转可以发现 NON_FIELD_ERRORS = '__all__'</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>get<span class="token punctuation">(</span>NON_FIELD_ERRORS<span class="token punctuation">,</span> self<span class="token punctuation">.</span>error_class<span class="token punctuation">(</span>error_class<span class="token operator">=</span><span class="token string">'nonfield'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
在模版语法里是不支持<span class="token punctuation">,</span>form<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>__all__ 这种写法的<span class="token punctuation">,</span>会报错
So<span class="token punctuation">,</span>在Django的模版里<span class="token punctuation">,</span>这样写 form<span class="token punctuation">.</span>non_field_errors<span class="token punctuation">.</span><span class="token number">0</span> 也就是在视图里写的form<span class="token punctuation">.</span>non_field_errors<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> 
<span class="token punctuation">(</span>在模版语法里<span class="token punctuation">,</span>form会找到non_field_errors<span class="token punctuation">,</span>看non_field_errors是否可执行<span class="token punctuation">,</span>若可执行<span class="token punctuation">,</span>它会自动帮你执行!!<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;该模版语法在源码里大致是这么个实现逻辑,以下是伪代码
my_str = &quot;form.non_field_errors.xxx&quot;
data_list = my_str.split(&quot;.&quot;)
obj = data_list[0]
for name in data_list[1:]:
    data = getattr(obj, name, None)  # -- 判断form有没有non_field_errors
    if data:
        if callable(data):  # -- 判断non_field_errors是不是一个可执行的函数
            obj = obj.data()
        else:
            obj = obj.data
    # -- 第一次循环后 obj = form.non_field_errors 然后进入第二次的循环,看form.non_field_errors有没有xxx
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token punctuation">[</span>扩展<span class="token punctuation">]</span>
如果想要让某个错误信息<span class="token punctuation">,</span>展示在特定的字段旁<span class="token punctuation">,</span>就可以使用<span class="token punctuation">:</span> form<span class="token punctuation">.</span>add_error<span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;用户名或密码错误&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django <span class="token keyword">import</span> forms
<span class="token keyword">from</span> django<span class="token punctuation">.</span>core<span class="token punctuation">.</span>validators <span class="token keyword">import</span> RegexValidator

<span class="token keyword">class</span> <span class="token class-name">LoginForm</span><span class="token punctuation">(</span>forms<span class="token punctuation">.</span>Form<span class="token punctuation">)</span><span class="token punctuation">:</span>
    role <span class="token operator">=</span> forms<span class="token punctuation">.</span>ChoiceField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    username <span class="token operator">=</span> forms<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> forms<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>
        label<span class="token operator">=</span><span class="token string">&quot;密码&quot;</span><span class="token punctuation">,</span>
        min_length<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span>
        validators<span class="token operator">=</span><span class="token punctuation">[</span>RegexValidator<span class="token punctuation">(</span><span class="token string">r'^[0-9]+$'</span><span class="token punctuation">,</span> <span class="token string">'密码请输入数字.'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        widget<span class="token operator">=</span>forms<span class="token punctuation">.</span>PasswordInput<span class="token punctuation">(</span>
            attrs<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;class&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;form-control&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;placeholder&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;请输入密码&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            render_value<span class="token operator">=</span><span class="token boolean">True</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        error_messages<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;min_length&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;密码至少是6位!&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;required&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;密码不能为空!&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">clean_username</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># -- 只要能执行到钩子函数这,就证明字段内部自身的校验是通过的,cleaned_data字典里肯定有该字段的信息</span>
        user <span class="token operator">=</span> self<span class="token punctuation">.</span>cleaned_data<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span>  
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">:</span>
            <span class="token keyword">from</span> django<span class="token punctuation">.</span>core<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> ValidationError
            <span class="token keyword">raise</span> ValidationError<span class="token punctuation">(</span><span class="token string">&quot;用户名格式错误&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> user

    <span class="token keyword">def</span> <span class="token function">clean_password</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> md5<span class="token punctuation">(</span>self<span class="token punctuation">.</span>cleaned_data<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">clean</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># -- 很少使用</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        可以在自定义的表单类里定义一个名为clean()方法,再做一个整体的校验!!
        1.有返回值,则将返回值赋值给self.cleaned_data!!
        2.无返回值,返回默认的self.cleaned_data!!
        3.抛出ValidationError异常可以捕获. 
          但要注意,此处是self.add_error(None, e) 把错误e给到None啦!! 而不是,self.add_error(name, e)
        &quot;&quot;&quot;</span>
        <span class="token comment"># -- 特别注意一点,该方法里,小心使用 user = self.cleaned_data['username']</span>
        <span class="token comment">#    看源码自己可以分析出来!!</span>
        <span class="token comment">#    若username在第一步里校验不通过,还是会执行第二步的,但self.cleaned_data可能没有username!!</span>
        <span class="token comment">#    所以我们一般会先 if self.cleaned_data.get('username') 进行判断!</span>
        <span class="token comment"># -- 当然,该方法也不常用.因为按照我们的想法,我们想在所有字段都检验通过了,然后再执行clean方法.</span>
        <span class="token comment">#    但,事实是,无论第一步里的字段校验成功与否都会执行clean方法.</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">_post_clean</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># -- 几乎不用</span>
        <span class="token keyword">pass</span>
      

<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># -- 一般我们会这样做:校验失败,显示错误信息; 校验成功, 取出数据, 连接数据库再进行其它操作!!</span>
    form <span class="token operator">=</span> LoginForm<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> form<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># print(form.errors[&quot;__all__&quot;])  # -- 可以拿到在第二步里抛出的异常</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;login.html&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;form&quot;</span><span class="token punctuation">:</span> form<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><h3 id="源码分析"><a href="#源码分析" class="header-anchor">#</a> 源码分析</h3> <blockquote><p><font color="brown">校验从 <code>form.is_valid()</code> 开始!! </font></p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code>form是LoginForm类的实例化对象
LoginForm类里没有is_valid方法<span class="token punctuation">,</span>去它继承的Form类中找<span class="token punctuation">,</span>Form类中也没有<span class="token punctuation">,</span>最后在Form类继承的BaseForm类中找到!!

form <span class="token operator">=</span> LoginForm<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span>
可以认为BaseForm里的self就是上面一行代码的form!!

<span class="token keyword">class</span> <span class="token class-name">BaseForm</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> files<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>is_bound <span class="token operator">=</span> data <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">or</span> files <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span>
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> MultiValueDict<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> data <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">else</span> data
        self<span class="token punctuation">.</span>files <span class="token operator">=</span> MultiValueDict<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> files <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">else</span> files
        self<span class="token punctuation">.</span>_errors <span class="token operator">=</span> <span class="token boolean">None</span>
    
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">errors</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>_errors <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>full_clean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># -- 验证规则在full_clean方法里!!</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_errors  <span class="token comment"># -- # ★ 看懂了吗?相当于self.errors = self._errors</span>
    
    
    <span class="token keyword">def</span> <span class="token function">is_valid</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># -- 因为在视图函数里执行了form = LoginForm(data=request.POST) 所以 self.is_bound 值为True.</span>
        <span class="token comment">#    再看self.errors, errors是一个被@property修饰的方法</span>
        <span class="token comment">#    此行代码表示当有数据+没有错误,返回True,表明验证通过!!</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>is_bound <span class="token keyword">and</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>errors
      
    
    <span class="token keyword">def</span> <span class="token function">full_clean</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_errors <span class="token operator">=</span> ErrorDict<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># ErrorDict()!!本质就是字典.</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>is_bound<span class="token punctuation">:</span>
            <span class="token keyword">return</span>
        <span class="token comment"># -- self.cleaned_data是校验成功后的字典,它默认是空的!</span>
        self<span class="token punctuation">.</span>cleaned_data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>empty_permitted <span class="token keyword">and</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>has_changed<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span>

        self<span class="token punctuation">.</span>_clean_fields<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># -- 依次对每个字段进行&lt;内部的校验+钩子方法的校验&gt;</span>
        self<span class="token punctuation">.</span>_clean_form<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># -- 可以自定义一个名为clean的钩子函数,实现字段与字段结合的校验!!</span>
        self<span class="token punctuation">.</span>_post_clean<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># -- 也是一个内部的钩子,让你进行校验.</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        self._clean_form()、self._post_clean()都是给我们预留的可校验的地方..
        看源码,前者可以抛出的ValidationError异常并捕获, 后者不能.
        &quot;&quot;&quot;</span>
        
        
    <span class="token keyword">def</span> <span class="token function">_clean_fields</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        role = forms.ChoiceField()
        username = forms.CharField()
        password = forms.CharField()
        &quot;&quot;&quot;</span>
        <span class="token comment"># -- 循环得到的name是字段名 role、username、password</span>
        <span class="token comment">#    循环得到的field是 forms.ChoiceField()、...、...</span>
        <span class="token keyword">for</span> name<span class="token punctuation">,</span> field <span class="token keyword">in</span> self<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> field<span class="token punctuation">.</span>disabled<span class="token punctuation">:</span>
                value <span class="token operator">=</span> self<span class="token punctuation">.</span>get_initial_for_field<span class="token punctuation">(</span>field<span class="token punctuation">,</span> name<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                value <span class="token operator">=</span> field<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>value_from_datadict<span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">,</span> self<span class="token punctuation">.</span>files<span class="token punctuation">,</span> self<span class="token punctuation">.</span>add_prefix<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span> FileField<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    initial <span class="token operator">=</span> self<span class="token punctuation">.</span>get_initial_for_field<span class="token punctuation">(</span>field<span class="token punctuation">,</span> name<span class="token punctuation">)</span>
                    value <span class="token operator">=</span> field<span class="token punctuation">.</span>clean<span class="token punctuation">(</span>value<span class="token punctuation">,</span> initial<span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token comment"># -- 1.每个字段内部的校验 </span>
                    <span class="token comment">#      每个字段中有个clean方法来进行校验,传递的参数value就是用户在表单里填入的数据</span>
                    <span class="token triple-quoted-string string">&quot;&quot;&quot; forms.ChoiceField() 点进ChoiceField查看源码,找到对应的clean方法.
                    def clean(self, value):
                        value = self.to_python(value)  # 其实就是value=vlaue
                        self.validate(value)  # 字段内部具体校验过程,有时间再探究!!
                        self.run_validators(value)
                        return value
                        
                    def to_python(self, value):
                        return value
                    &quot;&quot;&quot;</span>
                    <span class="token comment"># -- 若字段内部校验,不通过,会抛出异常,该次循环此行代码后面的不会执行啦 会被try-except捕获异常</span>
                    <span class="token comment">#    所以self.cleaned_data可能不存在该name值</span>
                    value <span class="token operator">=</span> field<span class="token punctuation">.</span>clean<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
                <span class="token comment"># -- 将校验通过的字段数据放到cleaned_data字典中</span>
                <span class="token comment">#    eg: cleaned_data = {&quot;username&quot;:&quot;dc&quot;,&quot;password&quot;:&quot;admin123!&quot;}</span>
                self<span class="token punctuation">.</span>cleaned_data<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> value
                <span class="token comment"># -- 2.会去我们在视图里自定义的LoginForm表单类里查看 </span>
                <span class="token comment">#      看有没有clean_role、clean_username、clean_password方法!</span>
                <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'clean_%s'</span> <span class="token operator">%</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token comment"># -- 如果有,直接加括号执行!!该方法里,可以调用self.cleaned_data来获取检验通过的键值对!</span>
                    <span class="token comment">#    此处的self是form对象!! form = LoginForm(data=request.POST)</span>
                    value <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'clean_%s'</span> <span class="token operator">%</span> name<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token triple-quoted-string string">&quot;&quot;&quot;
                    若self.clean_password方法执行了,并有返回值,假如return &quot;123&quot;
                    源码里,进行了覆盖操作.举个例子:
                       cleaned_data = {&quot;username&quot;:&quot;dc&quot;,&quot;password&quot;:&quot;admin123!&quot;} -- 每个字段的校验后的结果
                       会变为
                       cleaned_data = {&quot;username&quot;:&quot;123&quot;,&quot;password&quot;:&quot;123&quot;}
                    -- 这样编写钩子函数,(定义了钩子方法,又将之前校验通过的值返回了)跟没写效果一样,相当于没写:
                    def clean_password(self):
                        return self.cleaned_data[&quot;password&quot;]
                    -- 钩子函数的正确打开方式
                    def clean_password(self):
                        password = self.cleaned_data[&quot;password&quot;]
                        # 进行自定义的校验.如果校验通过,返回原来的值.若校验失败,抛出ValidationError类型的异常!!
                        from django.core.exceptions import ValidationError
                        if len(password) &lt; 3:
                            raise ValidationError(&quot;密码格式错误!&quot;)
                        return password
                    &quot;&quot;&quot;</span>
                    self<span class="token punctuation">.</span>cleaned_data<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> value
            <span class="token comment"># --  执行field.clean(value)方法时,检验不通过,会raise ValidationError的异常.在此处会捕获到!!</span>
            <span class="token keyword">except</span> ValidationError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>add_error<span class="token punctuation">(</span>name<span class="token punctuation">,</span> e<span class="token punctuation">)</span>  <span class="token comment"># -- 查看add_error的源码,不难看到,它会将错误放到self.errors里!!</span>

    <span class="token keyword">def</span> <span class="token function">_clean_form</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        可以在自定义的表单类里定义一个名为clean()方法,再做一个整体的校验!!
        1.有返回值,则将返回值赋值给self.cleaned_data!!
        2.返回值为None, 返回默认的self.cleaned_data/啥也没做.
        3.抛出ValidationError异常可以捕获. 
          但要注意,此处是self.add_error(None, e) 把错误e给到None啦!! 而不是,self.add_error(name, e)
          把错误e给到None,这个说法也不准确,点进add_error的源码,里面有这么一行代码:
             def add_error(self, field, error):  # -- 传入的field为None,error是错误信息e
                 # -- 若field为None,取的是全局变量NON_FIELD_ERRORS
                 #    而 NON_FIELD_ERRORS = '__all__'
                 error = {field or NON_FIELD_ERRORS: error.error_list}  
          So,可通过self.error['__all__']拿到_clean_form方法里抛出的错误信息
        &quot;&quot;&quot;</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            cleaned_data <span class="token operator">=</span> self<span class="token punctuation">.</span>clean<span class="token punctuation">(</span><span class="token punctuation">)</span>  
        <span class="token keyword">except</span> ValidationError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>add_error<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> cleaned_data <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>cleaned_data <span class="token operator">=</span> cleaned_data
                
                
    <span class="token keyword">def</span> <span class="token function">clean</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>cleaned_data

      
    <span class="token keyword">def</span> <span class="token function">_post_clean</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        An internal hook for performing additional cleaning after form cleaning
        is complete. Used for model validation in model forms.
        &quot;&quot;&quot;</span>
        <span class="token keyword">pass</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br></div></div><hr> <p><font color="brown">扩展: (有空再探究) </font>
1&gt; self.validate(value) 字段内部具体的校验过程<br>
2&gt; class Form(BaseForm, metaclass=DeclarativeFieldsMetaclass):  Form组件涉及到的元类怎么写的!!</p> <hr> <div class="language-python line-numbers-mode"><pre class="language-python"><code>  <span class="token number">1</span> Field  !!!!公共的字段属性!!!
  <span class="token number">2</span>     required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>               是否允许为空
  <span class="token number">3</span>     widget<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>                 HTML插件
  <span class="token number">4</span>     label<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>                  用于生成Label标签或显示内容
  <span class="token number">5</span>     initial<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>                初始值
  <span class="token number">6</span>     help_text<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span>                帮助信息<span class="token punctuation">(</span>在标签旁边显示<span class="token punctuation">)</span>
  <span class="token number">7</span>     error_messages<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>         错误信息 <span class="token punctuation">{</span><span class="token string">'required'</span><span class="token punctuation">:</span> <span class="token string">'不能为空'</span><span class="token punctuation">,</span> <span class="token string">'invalid'</span><span class="token punctuation">:</span> <span class="token string">'格式错误'</span><span class="token punctuation">}</span>
  <span class="token number">8</span>     validators<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>               自定义验证规则
  <span class="token number">9</span>     localize<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>              是否支持本地化
 <span class="token number">10</span>     disabled<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>              是否可以编辑
 <span class="token number">11</span>     label_suffix<span class="token operator">=</span><span class="token boolean">None</span>            Label内容后缀
 <span class="token number">12</span>  
 <span class="token number">13</span>  
 <span class="token number">14</span> CharField<span class="token punctuation">(</span>Field<span class="token punctuation">)</span>
 <span class="token number">15</span>     max_length<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>             最大长度
 <span class="token number">16</span>     min_length<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>             最小长度
 <span class="token number">17</span>     strip<span class="token operator">=</span><span class="token boolean">True</span>                   是否移除用户输入空白
 <span class="token number">18</span>  
 <span class="token number">19</span> IntegerField<span class="token punctuation">(</span>Field<span class="token punctuation">)</span>sss
 <span class="token number">20</span>     max_value<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>              最大值
 <span class="token number">21</span>     min_value<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>              最小值
 <span class="token number">22</span>  
 <span class="token number">23</span> FloatField<span class="token punctuation">(</span>IntegerField<span class="token punctuation">)</span>
 <span class="token number">24</span>     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token number">25</span>  
 <span class="token number">26</span> DecimalField<span class="token punctuation">(</span>IntegerField<span class="token punctuation">)</span>
 <span class="token number">27</span>     max_value<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>              最大值
 <span class="token number">28</span>     min_value<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>              最小值
 <span class="token number">29</span>     max_digits<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>             总长度
 <span class="token number">30</span>     decimal_places<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>         小数位长度
 <span class="token number">31</span>  
 <span class="token number">32</span> BaseTemporalField<span class="token punctuation">(</span>Field<span class="token punctuation">)</span>
 <span class="token number">33</span>     input_formats<span class="token operator">=</span><span class="token boolean">None</span>          时间格式化   
 <span class="token number">34</span>  
 <span class="token number">35</span> DateField<span class="token punctuation">(</span>BaseTemporalField<span class="token punctuation">)</span>    格式：<span class="token number">2015</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span>
 <span class="token number">36</span> TimeField<span class="token punctuation">(</span>BaseTemporalField<span class="token punctuation">)</span>    格式：<span class="token number">11</span><span class="token punctuation">:</span><span class="token number">12</span>
 <span class="token number">37</span> DateTimeField<span class="token punctuation">(</span>BaseTemporalField<span class="token punctuation">)</span>格式：<span class="token number">2015</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">12</span>
 <span class="token number">38</span>  
 <span class="token number">39</span> DurationField<span class="token punctuation">(</span>Field<span class="token punctuation">)</span>            时间间隔：<span class="token operator">%</span>d <span class="token operator">%</span>H<span class="token punctuation">:</span><span class="token operator">%</span>M<span class="token punctuation">:</span><span class="token operator">%</span>S<span class="token punctuation">.</span><span class="token operator">%</span>f
 <span class="token number">40</span>     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token number">41</span>  
 <span class="token number">42</span> RegexField<span class="token punctuation">(</span>CharField<span class="token punctuation">)</span>
 <span class="token number">43</span>     regex<span class="token punctuation">,</span>                      自定制正则表达式
 <span class="token number">44</span>     max_length<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>            最大长度
 <span class="token number">45</span>     min_length<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>            最小长度
 <span class="token number">46</span>     error_message<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>         忽略，错误信息使用 error_messages<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'invalid'</span><span class="token punctuation">:</span> <span class="token string">'...'</span><span class="token punctuation">}</span>
 <span class="token number">47</span>  
 <span class="token number">48</span> EmailField<span class="token punctuation">(</span>CharField<span class="token punctuation">)</span>      
 <span class="token number">49</span>     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token number">50</span>  
 <span class="token number">51</span> FileField<span class="token punctuation">(</span>Field<span class="token punctuation">)</span>
 <span class="token number">52</span>     allow_empty_file<span class="token operator">=</span><span class="token boolean">False</span>     是否允许空文件
 <span class="token number">53</span>  
 <span class="token number">54</span> ImageField<span class="token punctuation">(</span>FileField<span class="token punctuation">)</span>      
 <span class="token number">55</span>     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token number">56</span>     注：需要PIL模块，pip3 install Pillow
 <span class="token number">57</span>     以上两个字典使用时，需要注意两点：
 <span class="token number">58</span>         <span class="token operator">-</span> form表单中 enctype<span class="token operator">=</span><span class="token string">&quot;multipart/form-data&quot;</span>
 <span class="token number">59</span>         <span class="token operator">-</span> view函数中 obj <span class="token operator">=</span> MyForm<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">,</span> request<span class="token punctuation">.</span>FILES<span class="token punctuation">)</span>
 <span class="token number">60</span>  
 <span class="token number">61</span> URLField<span class="token punctuation">(</span>Field<span class="token punctuation">)</span>
 <span class="token number">62</span>     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token number">63</span>  
 <span class="token number">64</span>  
 <span class="token number">65</span> BooleanField<span class="token punctuation">(</span>Field<span class="token punctuation">)</span>  
 <span class="token number">66</span>     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token number">67</span>  
 <span class="token number">68</span> NullBooleanField<span class="token punctuation">(</span>BooleanField<span class="token punctuation">)</span>
 <span class="token number">69</span>     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token number">70</span>  
 <span class="token number">71</span> ChoiceField<span class="token punctuation">(</span>Field<span class="token punctuation">)</span>  <span class="token comment">#简单的性别选项 适用于不用查询数据库数据</span>
 <span class="token number">72</span>     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token number">73</span>     choices<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                选项，如：choices <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'上海'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'北京'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
 <span class="token number">74</span>     required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>             是否必填
 <span class="token number">75</span>     widget<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>               插件，默认select插件
 <span class="token number">76</span>     label<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>                Label内容
 <span class="token number">77</span>     initial<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>              初始值
 <span class="token number">78</span>     help_text<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span>              帮助提示
 <span class="token number">79</span>  
 <span class="token number">80</span>  
 <span class="token number">81</span> ModelChoiceField<span class="token punctuation">(</span>ChoiceField<span class="token punctuation">)</span>    <span class="token comment">#单项选择</span>
 <span class="token number">82</span>     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                        django<span class="token punctuation">.</span>forms<span class="token punctuation">.</span>models<span class="token punctuation">.</span>ModelChoiceField
 <span class="token number">83</span>     queryset<span class="token punctuation">,</span>                  <span class="token comment"># 查询数据库中的数据</span>
 <span class="token number">84</span>     empty_label<span class="token operator">=</span><span class="token string">&quot;---------&quot;</span><span class="token punctuation">,</span>   <span class="token comment"># 默认空显示内容</span>
 <span class="token number">85</span>     to_field_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>        <span class="token comment"># HTML中value的值对应的字段</span>
 <span class="token number">86</span>     limit_choices_to<span class="token operator">=</span><span class="token boolean">None</span>      <span class="token comment"># ModelForm中对queryset二次筛选</span>
 <span class="token number">87</span>      
 <span class="token number">88</span> ModelMultipleChoiceField<span class="token punctuation">(</span>ModelChoiceField<span class="token punctuation">)</span>  <span class="token comment">#多项选择</span>
 <span class="token number">89</span>     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                        django<span class="token punctuation">.</span>forms<span class="token punctuation">.</span>models<span class="token punctuation">.</span>ModelMultipleChoiceField
 <span class="token number">90</span>  
 <span class="token number">91</span>  
 <span class="token number">92</span>      
 <span class="token number">93</span> TypedChoiceField<span class="token punctuation">(</span>ChoiceField<span class="token punctuation">)</span>
 <span class="token number">94</span>     <span class="token builtin">coerce</span> <span class="token operator">=</span> <span class="token keyword">lambda</span> val<span class="token punctuation">:</span> val   对选中的值进行一次转换
 <span class="token number">95</span>     empty_value<span class="token operator">=</span> <span class="token string">''</span>            空值的默认值
 <span class="token number">96</span>  
 <span class="token number">97</span> MultipleChoiceField<span class="token punctuation">(</span>ChoiceField<span class="token punctuation">)</span>
 <span class="token number">98</span>     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token number">99</span>  
<span class="token number">100</span> TypedMultipleChoiceField<span class="token punctuation">(</span>MultipleChoiceField<span class="token punctuation">)</span>
<span class="token number">101</span>     <span class="token builtin">coerce</span> <span class="token operator">=</span> <span class="token keyword">lambda</span> val<span class="token punctuation">:</span> val   对选中的每一个值进行一次转换
<span class="token number">102</span>     empty_value<span class="token operator">=</span> <span class="token string">''</span>            空值的默认值
<span class="token number">103</span>  
<span class="token number">104</span> ComboField<span class="token punctuation">(</span>Field<span class="token punctuation">)</span>
<span class="token number">105</span>     fields<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                  使用多个验证，如下：即验证最大长度<span class="token number">20</span>，又验证邮箱格式
<span class="token number">106</span>                                fields<span class="token punctuation">.</span>ComboField<span class="token punctuation">(</span>fields<span class="token operator">=</span><span class="token punctuation">[</span>fields<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fields<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token number">107</span>  
<span class="token number">108</span> MultiValueField<span class="token punctuation">(</span>Field<span class="token punctuation">)</span>
<span class="token number">109</span>     PS<span class="token punctuation">:</span> 抽象类，子类中可以实现聚合多个字典去匹配一个值，要配合MultiWidget使用
<span class="token number">110</span>  
<span class="token number">111</span> SplitDateTimeField<span class="token punctuation">(</span>MultiValueField<span class="token punctuation">)</span>
<span class="token number">112</span>     input_date_formats<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>   格式列表：<span class="token punctuation">[</span><span class="token string">'%Y--%m--%d'</span><span class="token punctuation">,</span> <span class="token string">'%m%d/%Y'</span><span class="token punctuation">,</span> <span class="token string">'%m/%d/%y'</span><span class="token punctuation">]</span>
<span class="token number">113</span>     input_time_formats<span class="token operator">=</span><span class="token boolean">None</span>    格式列表：<span class="token punctuation">[</span><span class="token string">'%H:%M:%S'</span><span class="token punctuation">,</span> <span class="token string">'%H:%M:%S.%f'</span><span class="token punctuation">,</span> <span class="token string">'%H:%M'</span><span class="token punctuation">]</span>
<span class="token number">114</span>  
<span class="token number">115</span> FilePathField<span class="token punctuation">(</span>ChoiceField<span class="token punctuation">)</span>     文件选项，目录下文件显示在页面中
<span class="token number">116</span>     path<span class="token punctuation">,</span>                      文件夹路径
<span class="token number">117</span>     <span class="token keyword">match</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>                正则匹配
<span class="token number">118</span>     recursive<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>           递归下面的文件夹
<span class="token number">119</span>     allow_files<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>          允许文件
<span class="token number">120</span>     allow_folders<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>       允许文件夹
<span class="token number">121</span>     required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
<span class="token number">122</span>     widget<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
<span class="token number">123</span>     label<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
<span class="token number">124</span>     initial<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
<span class="token number">125</span>     help_text<span class="token operator">=</span><span class="token string">''</span>
<span class="token number">126</span>  
<span class="token number">127</span> GenericIPAddressField
<span class="token number">128</span>     protocol<span class="token operator">=</span><span class="token string">'both'</span><span class="token punctuation">,</span>           both<span class="token punctuation">,</span>ipv4<span class="token punctuation">,</span>ipv6支持的IP格式
<span class="token number">129</span>     unpack_ipv4<span class="token operator">=</span><span class="token boolean">False</span>          解析ipv4地址，如果是<span class="token punctuation">:</span><span class="token punctuation">:</span>ffff<span class="token punctuation">:</span><span class="token number">192.0</span><span class="token number">.2</span><span class="token number">.1</span>时候，可解析为<span class="token number">192.0</span><span class="token number">.2</span><span class="token number">.1</span>， PS：protocol必须为both才能启用
<span class="token number">130</span>  
<span class="token number">131</span> SlugField<span class="token punctuation">(</span>CharField<span class="token punctuation">)</span>           数字，字母，下划线，减号（连字符）
<span class="token number">132</span>     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token number">133</span>  
<span class="token number">134</span> UUIDField<span class="token punctuation">(</span>CharField<span class="token punctuation">)</span>           uuid类型
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br></div></div></div></div> <!----> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/80fa06/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">表结构</div></a> <a href="/pages/2e039e/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">短信登陆</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/80fa06/" class="prev">表结构</a></span> <span class="next"><a href="/pages/2e039e/">短信登陆</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/8sk2b3/"><div>
            搜索相关
            <!----></div></a> <span class="date">03-22</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/2kn2p2/"><div>
            CURD
            <!----></div></a> <span class="date">03-20</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/1kn1m1/"><div>
            自动生成
            <!----></div></a> <span class="date">03-15</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/OnePieceDC" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://www.cnblogs.com/DC0307/" title="博客园" target="_blank" class="iconfont icon-bokeyuan"></a><a href="https://music.163.com/#/song?id=1854188649" title="听音乐" target="_blank" class="iconfont icon-erji"></a><a href="https://www.jianshu.com/u/5310eb537315" title="简书" target="_blank" class="iconfont icon-jianshu"></a><a href="mailto:1415806497@qq.com" title="QQ" target="_blank" class="iconfont icon-youjian"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2024
    <span>DC | One Piece</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><!----><div id="goTop" class="hide-cat" data-v-8ccb5928></div><div></div><canvas id="vuepress-canvas-cursor"></canvas><div></div><div></div></div></div>
    <script src="/assets/js/app.ac54adc6.js" defer></script><script src="/assets/js/4.7ddc74e3.js" defer></script><script src="/assets/js/1.a0c4ff1b.js" defer></script><script src="/assets/js/3.8b03321d.js" defer></script><script src="/assets/js/85.2f47134e.js" defer></script><script src="/assets/js/104.cae2d944.js" defer></script><script src="/assets/js/184.46eabf07.js" defer></script>
  </body>
</html>
