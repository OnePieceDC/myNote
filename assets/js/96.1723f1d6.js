(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{1194:function(s,t,n){"use strict";n.r(t);var a=n(0),r=Object(a.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"dhcp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dhcp"}},[s._v("#")]),s._v(" DHCP")]),s._v(" "),a("blockquote",[a("p",[s._v("dhcp本质上是一个用于分配IP地址的套接字程序")])]),s._v(" "),a("h3",{attrs:{id:"四要素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四要素"}},[s._v("#")]),s._v(" 四要素")]),s._v(" "),a("p",[s._v("想实现网络通信, 每台主机需具备的 "),a("font",{attrs:{color:"brown"}},[a("strong",[s._v("四要素")])]),a("br"),s._v("\n     ○ 本机的IP地址"),a("br"),s._v("\n     ○ 子网掩码"),a("br"),s._v("\n     ○ 网关的IP地址"),a("br"),s._v("\n     ○ DNS的IP地址 "),a("font",{attrs:{color:"gray"}},[s._v("(不是必须的,不用域名,直接用IP地址就行)")])],1),s._v(" "),a("div",{staticClass:"language-tex line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tex"}},[a("code",[s._v("DNS -- 域名解析,将域名转换成对应的IP地址.. \nDNS的IP可以直接指定,也可以设置将DNS的IP地址设置成网关/路由器的IP地址.若是后者,在浏览器上输入域名后,浏览器会先将这个域名先送到网关,网关会帮忙向DNS服务器发起请求,把域名转成IP地址后再去通信.\n\n敲黑板!!!☆浏览器规定用户输入的网址不敲端口,默认端口号是80 !! IP+端口 -- 联合唯一就行了呗.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"获取方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取方式"}},[s._v("#")]),s._v(" 获取方式")]),s._v(" "),a("p",[s._v("获取四要素的地址,有两种方式:"),a("br"),s._v("\n     1> 手动配置 -- 静态获取 (可能会冲突 在设置前先ping一下,ping通了代表此IP被占用了)"),a("br"),s._v("\n     2> dhcp -- 动态获取   "),a("font",{attrs:{color:"blue"}},[s._v('"获取后不是不变的 是有'),a("strong",[s._v("租约时间")]),s._v('的 过时会重新获取"')])],1),s._v(" "),a("p",[a("img",{attrs:{src:n(474),alt:""}})]),s._v(" "),a("h3",{attrs:{id:"动态获取过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态获取过程"}},[s._v("#")]),s._v(" 动态获取过程")]),s._v(" "),a("p",[s._v("每台主机都会默认安装一个dhcp client软件.每个路由器会默认安装dhcp server软件.")]),s._v(" "),a("p",[s._v("主机一开机,dhcp client软件就会默认启动 (当然,前提是主机有网络能往外通信)")]),s._v(" "),a("p",[a("strong",[s._v("dhcp报头格式")]),s._v(":  "),a("code",[s._v("以太网头\tIP头\tUDP头\tDHCP数据包")]),a("br"),s._v('\n1> 最前面的"以太网标头", 设置发出方(本机)的MAC地址和接收方(DHCP服务端)的MAC地址.'),a("br"),s._v("\n     前者就是本机烧录在网卡上的MAC地址,后者这时不知道,就填入一个广播地址: FF-FF-FF-FF-FF-FF."),a("br"),s._v('\n2> 后面的"IP标头",设置发出方的IP地址和接收方的IP地址. 本机对于这两者都不知道.'),a("br"),s._v("\n     于是,发出方的IP地址就设为0.0.0.0, 接收方的IP地址设为255.255.255.255"),a("br"),s._v('\n3> 最后的"UDP标头",设置发出方的端口和接收方的端口. 这一部分是DHCP协议规定好的,'),a("br"),s._v("\n     发出方是68端口, 接收方是67端口。")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("MAC(本机)")]),s._v(" "),a("th",[s._v("FF-FF-FF-FF-FF-FF")]),s._v(" "),a("th",[s._v("0.0.0.0")]),s._v(" "),a("th",[s._v("255.255.255.255")]),s._v(" "),a("th",[s._v("68")]),s._v(" "),a("th",[s._v("67")]),s._v(" "),a("th",[s._v("DHCP数据包")])])]),s._v(" "),a("tbody")]),s._v(" "),a("div",{staticClass:"language-tex line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tex"}},[a("code",[s._v('这个数据包构造完成后, 就可以发出了.\n\n以太网是广播的形式发送,同一个子网络的每台计算机都收到了这个包.\n因为接收方的MAC地址是FF-FF-FF-FF-FF-FF, 看不出是发给谁的, 所以每台收到这个包的计算机, 还必须分析这个包的IP地址, 才能确定是不是发给自己的. 当看到发出方IP地址是0.0.0.0,接收方IP是255.255.255.255, 于是DHCP服务器知道"这个包是发给我的", 而其他计算机就可以丢弃这个包.\n\n接下来,DHCP服务器读出这个包的数据内容,分配好IP地址,发送回去一个"DHCP响应"数据包.\n这个响应包的结构也是类似的,以太网报头的MAC地址是双方的烧录在网卡上的地址,IP报头的IP地址是DHCP服务器的IP地址(发出方)和255.255.255.255(接收方), UDP标头的端口是67(发出方)和68(接收方),分配给请求端的IP地址和本网络的具体参数则包含在Data部分.\n\n新加入的计算机收到这个响应包,于是就知道了自己的IP地址、子网掩码、网关地址、DNS服务器等等参数.\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("hr"),s._v(" "),a("h2",{attrs:{id:"dns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns"}},[s._v("#")]),s._v(" DNS")]),s._v(" "),a("blockquote",[a("p",[s._v("dns - domain name server 域名解析服务, 负责把域名解析成IP地址"),a("br"),s._v("\n参考文档: "),a("code",[s._v("https://www.cnblogs.com/linhaifeng/articles/5937962.html#_label14")])])]),s._v(" "),a("p",[a("font",{attrs:{color:"gray"}},[s._v("使用的阿里云服务器默认就有一个公网IP地址;申请域名;添加解析记录将域名跟IP地址关联到一起;最后进行备案.")])],1),s._v(" "),a("p",[s._v("全球一共有13台根服务器.13台是同步的. "),a("strong",[s._v("底层是基于UDP协议的")]),s._v(" ,每一次最大512bit,13已经是极限了."),a("br"),s._v("\n13台没有一台在中国,So,国内有大量的缓存DNS服务器.Hhh.")]),s._v(" "),a("p",[a("font",{attrs:{color:"brown"}},[a("strong",[s._v("DNS的解析流程")])])],1),s._v(" "),a("p",[a("img",{attrs:{src:n(475),alt:""}})]),s._v(" "),a("p",[a("font",{attrs:{color:"gray"}},[s._v("Ps: "),a("strong",[s._v("一旦递归服务器拿到解析记录以后, 就会在本地进行缓存")]),s._v(" , 如果下次客户端再请求本地的递归域名服务器相同域名的时候, 就不会再这样一层一层查了, 因为本地服务器里面已经有缓存了(达到了加速的效果)！要知道缓存是有TTL的生命周期的,需要定时更新.")])],1),s._v(" "),a("p",[s._v("DNS除了递归查找,还有迭代查找..略.")]),s._v(" "),a("p",[a("font",{attrs:{color:"brown"}},[a("strong",[s._v("DNS的查找顺序")])])],1),s._v(" "),a("p",[s._v("DNS的解析速度也是网速的一部分,所以为了加速其查询,引入了缓存!")]),s._v(" "),a("p",[s._v("浏览器DNS缓存->本地系统DNS缓存->本地计算机HOSTS文件->ISP DNS缓存->递归or迭代搜索"),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("Ps: 缓存都是内存数据,HOSTS文件是硬盘数据.")])],1),s._v(" "),a("div",{staticClass:"language-tex line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tex"}},[a("code",[s._v("计算机HOSTS文件路径:\nlinux - /etc/hosts\nWindows - C:"),a("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\Windows")]),a("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\System")]),s._v("32"),a("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\drivers")]),a("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\etc")]),s._v("\n\neg: 在文件中添加 1.1.1.1 www.baidu.com\n    那么ping www.baidu.com显示的ip就是1.1.1.1 \n\t\nDNS的查找顺序是合理的,速度对比: 内存>硬盘>网络IO延迟\n\nwindows上查看所有的IP配置信息:   ipconfig -all\n查看windows操作系统DNS的缓存:  ipconfig /displaydns\n清除windows操作系统上的DNS缓存:  ipconfig /flushdns\n清除浏览器的dns缓存,在相应浏览器里输入:\n    谷歌 -- chrome://net-internals/#dns 点击clear host cache \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("hr"),s._v(" "),a("h2",{attrs:{id:"网络拓扑图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络拓扑图"}},[s._v("#")]),s._v(" 网络拓扑图")]),s._v(" "),a("p",[s._v("假设有两间大教室,教室1处于网段172.168.1.0,教室2处于网段192.169.13.0; 教室1中的主机A要访问阿里巴巴的服务器...访问的是阿里巴巴服务器的公网IP,再映射成私有IP.")]),s._v(" "),a("p",[a("img",{attrs:{src:n(476),alt:""}})]),s._v(" "),a("p",[a("font",{attrs:{color:"gray"}},[s._v("Ps1: 两间教室不需要2个路由,共用同一个路由器就行,因为一个路由可以帮忙转发多个网段..(不同的网段存在于一个路由表中)")]),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("Ps2: 注意哦!默认情况下,局域网的主机不会暴露在公网当中..里面的主机只有访问别个的命.想要逆天改命让别个访问它,得有个公网IP..")])],1),s._v(" "),a("hr")])}),[],!1,null,null,null);t.default=r.exports},474:function(s,t,n){s.exports=n.p+"assets/img/4.c8d1b4b6.jpg"},475:function(s,t,n){s.exports=n.p+"assets/img/12.bad3eda2.png"},476:function(s,t,n){s.exports=n.p+"assets/img/23.213b0b0b.png"}}]);