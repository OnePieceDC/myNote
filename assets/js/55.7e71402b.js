(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{1199:function(s,t,n){"use strict";n.r(t);var a=n(0),r=Object(a.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"文件系统介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件系统介绍"}},[s._v("#")]),s._v(" 文件系统介绍")]),s._v(" "),a("blockquote",[a("p",[s._v("文件系统filesystem是操作系统内核中负责组织管理磁盘的程序. 是OS的一部分.")])]),s._v(" "),a("p",[s._v("在起初给vm虚机安装centos操作系统时,我们对硬盘进行了分区  "),a("font",{attrs:{color:"gray"}},[s._v("eg /\t/boot\tswap")]),a("br"),s._v("\n每一个分区/分隔槽都需要文件系统进行管理. 常见的 "),a("strong",[s._v("文件系统")]),s._v(" 有 "),a("strong",[s._v("xfs")]),s._v("、ext4 和 btrfs."),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("可以每个分区都用不同的文件系统,但通常都是一样的.. "),a("strong",[s._v("centos7里用的是xfs")]),s._v("; centos6及以前用的是ext4.")])],1),s._v(" "),a("p",[a("font",{attrs:{color:"brown"}},[a("strong",[s._v("xfs、ext4都支持日志")])])],1),s._v(" "),a("div",{staticClass:"language-tex line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tex"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("了解知识"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v('\n\n吐槽: 听到egon说他以前做过cf,别懵逼了..就是指日志文件系统CLFS!(´▽｀) Please be professional！\n\nxfs、ext4都支持日志,日志用于记录操作.内存往磁盘里写数据的时候,会先将相应的操作记录在日志里.\nQ:如何打造一个极致的CLFS日志文件系统？\n  日志文件系统先记录操作,再完成数据的写入..断电后可根据日志继续未完成的操作..\nA:准备多块盘,做RAID(前文"计算机硬件组成"部分有介绍).用两三块固态做日志,其他盘存数据.\n  CLFS的特点是写数据先往做日志的固态里写,日志里会记录相应的操作,再根据这些操作往其他盘里写真正的数据.\n  正因为日志里有相应的操作记录,所以可通过日志来完成数据的回复.(解决系统崩溃或者掉电数据丢失的问题)\nPs: 提一嘴,做raid将多块磁盘合成一块,对inode的总量没有影响,inode归文件系统管,是一定的.\n\nxfs为啥是现在的主流？\n1> xfs的底层效率比ext4高;\n2> xfs支持大而多的文件!\n3> btrfs(B-tree文件系统)的读写速度是最快的,但它对cpu内存的占用非常大.而且极不稳定.\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[a("img",{attrs:{src:n(480),alt:""}})]),s._v(" "),a("p",[a("font",{attrs:{color:"gray"}},[s._v("Ps: 作为专业人士,提分区的概念比较少,都是说哪哪个文件系统,要知道,"),a("strong",[s._v("每个文件系统一定是关联一个具体的分区.")])])],1),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n文件系统       文件系统       文件系统\n 分区1         分区2          分区3\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /dev/sda")]),s._v("\nbrw-rw---- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root disk "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":54 /dev/sda\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /dev/sda1")]),s._v("\nbrw-rw---- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root disk "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":54 /dev/sda1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /dev/sda2")]),s._v("\nbrw-rw---- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root disk "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":54 /dev/sda2\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" 即disk filesystem之意 查看的是硬盘的文件系统\n注意观察结果,/dev/sda1这一分区是在文件系统这一列下面的"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n    /dev/sda1占在《硬盘的角度》指的是第1个分隔槽.\n    /dev/sda1占在《软件的角度》是一个文件系统.\n挂载点打个比方,硬盘是个水桶,用木板进行了隔断,划分出每个区域都安装了个水龙头用于出水.\n通俗点来讲挂载点就是指每个分区最上层的那个文件夹"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" 就是分区关联的文件夹 eg: / /boot "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" 磁盘容量,以M、G"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("更美观\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" 磁盘inode号使用情况\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-T")]),s._v(" 多加一列 文件系统的类型\n\nps: mount命令可查看挂载的所有文件系统信息"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h -T")]),s._v("\n文件系统                类型      容量  已用  可用 已用% 挂载点\ndevtmpfs                devtmpfs  470M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  470M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev\ntmpfs                   tmpfs     487M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  487M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev/shm\ntmpfs                   tmpfs     487M   15M  472M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("% /run\ntmpfs                   tmpfs     487M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  487M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /sys/fs/cgroup\n/dev/mapper/centos-root xfs        17G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".6G   13G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v("% /\n/dev/sda1               xfs      1014M  212M  803M   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("% /boot\ntmpfs                   tmpfs      98M   40K   98M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run/user/0\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -i -T")]),s._v("\n文件系统                类型       Inode 已用"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("I"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 可用"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("I"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 已用"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("I"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("% 挂载点\ndevtmpfs                devtmpfs  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("120231")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("401")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("119830")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /dev\ntmpfs                   tmpfs     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124455")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124454")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /dev/shm\ntmpfs                   tmpfs     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124455")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("961")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123494")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run\ntmpfs                   tmpfs     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124455")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124439")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /sys/fs/cgroup\n/dev/mapper/centos-root xfs      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8910848")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("139846")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8771002")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("% /\n/dev/sda1               xfs       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("524288")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("347")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("523941")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /boot\ntmpfs                   tmpfs     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124455")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124432")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run/user/0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br")])]),a("hr"),s._v(" "),a("h2",{attrs:{id:"文件系统工作原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件系统工作原理"}},[s._v("#")]),s._v(" 文件系统工作原理")]),s._v(" "),a("blockquote",[a("p",[a("font",{attrs:{color:"brown"}},[s._v("文件 = 文件元数据 + 实际内容")])],1)]),s._v(" "),a("h3",{attrs:{id:"block的分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#block的分类"}},[s._v("#")]),s._v(" block的分类")]),s._v(" "),a("div",{staticClass:"language-tex line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tex"}},[a("code",[s._v('硬盘的最小存取单位 -- 扇区(512kb)\n操作系统的最小存取单位 -- block块(4k)\nPs:操作系统中的文件系统负责将磁盘的多扇区组织成一个个的block块,这样OS就可以一次性读取一个"块"(block);\n   即一次性连续读取多个扇区. "块"的大小,最常见的是4KB,即连续八个sector组成一个block.\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("在文件系统眼里,一个分区就是一堆block块！文件系统将它们进行了分类:"),a("br"),s._v("\n1> "),a("strong",[s._v("superblock")]),s._v(" 超级区块 "),a("font",{attrs:{color:"blue"}},[s._v("一个")]),s._v(": 记录整个档案系统的整体信息,包括inode与block的总量、使用量、剩余量等"),a("br"),s._v("\n                创建文件时,会跟superblock申请inode和data block."),a("br"),s._v("\n2> "),a("strong",[s._v("inode")]),s._v("区块 "),a("font",{attrs:{color:"blue"}},[s._v("多个")]),s._v(": 放置文件的 "),a("em",[s._v("元信息")]),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("元数据 - 权限(rwx)、拥有者、群组、时间参数等. ")]),a("br"),s._v(" "),a("font",{attrs:{color:"green"}},[s._v("包括一个文件被分配的一个inode号以及该文件对应的一个或多个data block块号码; ")]),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("Ps:说在前面,一个文件只能有一个inode号,但多个文件的inode号可以相同 -- 硬链接")]),a("br"),s._v("\n3> "),a("strong",[s._v("data block")]),s._v("区块 "),a("font",{attrs:{color:"blue"}},[s._v("剩下的")]),s._v(" :"),a("br"),s._v("\n        若是文件夹 放置子文件名或者子文件夹名的 "),a("em",[s._v("inode号")]),s._v(";"),a("br"),s._v("\n        若是文件 放置文件的  "),a("em",[s._v("实际内容")]),s._v(" ;"),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("Ps: "),a("strong",[s._v("每个inode 与data block 都有自己的编号")])])],1),s._v(" "),a("p",[a("strong",[s._v("一个文件")]),s._v("("),a("font",{attrs:{color:"gray"}},[a("strong",[s._v("不管是文件还是目录")])]),s._v(")"),a("strong",[s._v("占用一个inode块以及一个或者多个data block块!")]),a("br"),s._v(" "),a("strong",[s._v("注意哦!")]),s._v(" "),a("font",{attrs:{color:"green"}},[a("strong",[s._v("一个文件夹/目录也算是一个文件! 里面存储的是子文件名和子文件夹名的inode编号!")])])],1),s._v(" "),a("p",[s._v("So, 在linux里根本就没有文件夹一说,是为了方便阐述才这样说的,实际上应该叫做 "),a("font",{attrs:{color:"red"}},[a("strong",[s._v("目录文件")])]),s._v("!"),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("这样称呼是因为文件夹里存放的是子文件的inode编号,就像是书的目录一样！")])],1),s._v(" "),a("h3",{attrs:{id:"文件的查找"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件的查找"}},[s._v("#")]),s._v(" 文件的查找")]),s._v(" "),a("p",[a("code",[s._v("cat /etc/passwd")]),s._v(" 的整体过程如下:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -i /")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("78150")]),s._v(" bin   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50331763")]),s._v(" home   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16778318")]),s._v(" mnt       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8877")]),s._v(" run   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16777288")]),s._v(" tmp\n      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" boot        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("81")]),s._v(" lib    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33746122")]),s._v(" opt      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("78154")]),s._v(" sbin  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33732779")]),s._v(" usr\n       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" dev         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v(" lib64         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" proc  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50331764")]),s._v(" srv   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50331713")]),s._v(" var\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16777281")]),s._v(" etc         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),s._v(" media  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33574977")]),s._v(" root         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" sys\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -di /")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" /\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -di /etc/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16777281")]),s._v(" /etc/\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -i /etc/passwd")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17500057")]),s._v(" /etc/passwd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[a("img",{attrs:{src:n(481),alt:""}})]),s._v(" "),a("p",[a("font",{attrs:{color:"gray"}},[s._v("Ps: 这张逻辑图中inode块的block编号是假设的,对整体的推导流程没有影响..")])],1),s._v(" "),a("p",[s._v("step 1> 首先, 系统找到这个文件名对应的inode号码;"),a("br"),s._v("\nstep 2> 其次, 通过inode号码,获取inode信息;"),a("br"),s._v("\nstep 3> 最后, 根据inode信息, 找到文件数据所在的block,读出数据")]),s._v(" "),a("div",{staticClass:"language-tex line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tex"}},[a("code",[s._v("cat /etc/passwd 查找的整体过程  根文件夹/\t; 文件夹/etc ; 文件/etc/passwd\n\n1> OS的文件系统先去问问super block,知道了根目录/的inode编号是64,\n   找到编号为64的inode块,在该元信息里看到其对应的data block编号是555;\n   找到根目录/对应编号为555的data block,里面/etc文件夹对应的inode号是16777281;\n2> 文件系统找到编号为16777281的inode块,查询到其对应的data block编号是666,\n   在编号为666的data block,查询到/etc/passwd文件对应的inode号是17500057;\n3> 文件系统找到编号为17500057的inode块,查询到其对应的data block编号是666、777、888,\n   进而读出数据..\nPs: 查找的过程实际上还要考虑有无权限哦(´▽｀)!!\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("不管是xfs还是ext,底层的原理都是这样的,只不过,xfs在此之上做了一些优化提高了读写效率.."),a("br"),s._v("\nxfs、ext文件系统都被称作 "),a("font",{attrs:{color:"red"}},[a("strong",[s._v("索引式文件系统")])]),s._v("(indexed allocation)！")],1),s._v(" "),a("h3",{attrs:{id:"文件的删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件的删除"}},[s._v("#")]),s._v(" 文件的删除")]),s._v(" "),a("p",[a("font",{attrs:{color:"gray"}},[a("strong",[s._v("Q:")]),s._v(" 若需要删除 /etc/passwd 文件,删除过程是怎样的呢？")]),a("br"),s._v(" "),a("strong",[s._v("A:")]),s._v(" 实际上没有删除这一说, "),a("font",{attrs:{color:"red"}},[a("strong",[s._v("硬盘的所有操作都是覆盖!")])]),a("br"),s._v('\n     "删除"此文件,会导致该文件对应的inode号17500057,以及对应的data block块777 888 999在superblock里都标记为free自由空闲状态;表明当有其他数据文件往硬盘中写的时候,free状态的inode号和data block块可以分别存其他文件的元数据和内容.'),a("br"),s._v("\n     也就是说,删除一个文件时,文件的元数据和内容都还在硬盘里！"),a("br"),s._v("\n     还会将目录文件/etc的data block里面, /etc/passwd文件与对应的inode号17500057的绑定关系清理掉!"),a("br"),s._v("\n     So,回复数据的原理,就是将未删除之前的绑定关系进行恢复."),a("br"),s._v("\n     数据回复一定能回复回来吗？不一定! 因为被标记为free的块被分配走了就没办法啦.数据被覆盖了."),a("br"),s._v("\n     所以数据回复时会问,删除有多久啦,在此之间有没有做其他操作..")],1),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"文件系统扩展"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件系统扩展"}},[s._v("#")]),s._v(" 文件系统扩展")]),s._v(" "),a("h3",{attrs:{id:"inode信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#inode信息"}},[s._v("#")]),s._v(" inode信息")]),s._v(" "),a("blockquote",[a("p",[s._v("文件的 "),a("strong",[s._v("inode")]),s._v(" 中文译名为 "),a("strong",[s._v('"索引节点"')]),s._v(" , 是UNIX 操作系统中的一种数据结构, 其本质是结构体.")])]),s._v(" "),a("p",[a("font",{attrs:{color:"blue"}},[a("strong",[s._v("[stat命令]")])])],1),s._v(" "),a("p",[s._v("可以用 "),a("code",[s._v("stat")]),s._v(" 命令, 查看某个文件的inode信息!")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# stat /etc/")]),s._v("\n  文件："),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/"')]),s._v("\n  大小：8192      \t块：24         IO 块：4096   目录\n设备：fd00h/64768d\tInode：16777281    硬链接：144\n权限："),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0755/drwxr-xr-x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  Uid："),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/    root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   Gid："),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/    root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n最近访问：2022-07-18 09:44:50.868295267 +0800\n最近更改：2022-07-15 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":22:00.039036820 +0800\n最近改动：2022-07-15 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":22:00.039036820 +0800\n创建时间：-\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# stat /etc/passwd")]),s._v("\n  文件："),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/passwd"')]),s._v("\n  大小：2351      \t块：8          IO 块：4096   普通文件\n设备：fd00h/64768d\tInode：17500057    硬链接：1\n权限："),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0644/-rw-r--r--"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  Uid："),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/    root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   Gid："),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/    root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n最近访问：2022-07-18 07:33:46.014207025 +0800\n最近更改：2022-07-15 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":14:51.948530819 +0800\n最近改动：2022-07-15 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":14:51.955530994 +0800\n创建时间：-\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[s._v("从根本上讲,inode中存放的是除了文件的名字以及文件真实内容之外所有有关文件的信息/元数据(metadata)!")]),s._v(" "),a("div",{staticClass:"language-tex line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tex"}},[a("code",[s._v("● inode 编号\n● 用来识别文件类型,以及用于stat C函数的模式信息\n● 链接数,即有多少文件名指向这个inode\n● 属主的ID(UID)\n● 属主的组ID(GID)\n● 文件的字节数\n● 文件所使用的磁盘块的实际数目\n● 文件的时间戳,共有三个:\n  ctime指inode上一次变动的时间;\n  mtime指文件内容上一次变动的时间;\n  atime指文件上一次打开的时间。\n● 指向数据块的指针 \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[a("font",{attrs:{color:"red"}},[s._v("敲黑板!")]),s._v(" "),a("strong",[s._v("Linux系统内部不使用文件名, 而是用inode号码来识别文件.")]),s._v(" 每个inode都有一个号码."),a("br"),s._v("\n对于系统来说,文件名只是inode号码便于识别的别称或者绰号.")],1),s._v(" "),a("p",[a("font",{attrs:{color:"blue"}},[a("strong",[s._v("[三种时间]")])])],1),s._v(" "),a("p",[a("strong",[s._v("详解,atime、mtime、ctime的区别！")])]),s._v(" "),a("div",{staticClass:"language-tex line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tex"}},[a("code",[s._v("1> atime(access time):"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("访问文件内容"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("的时间.\n      对文件进行一次读操作,它的访问时间就会改变.\n      eg: cat、more等操作,但是像之前的stat还有ls命令对atime是不会有影响的.\n      因为stat、ls访问的是文件的元数据,没有访问文件的内容！！\n2> mtime(modify time):"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("修改文件内容"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("的时间.\n      文件的内容被最后一次修改的时间,我们经常用的ls -l命令显示出来的文件时间就是这个时间.\n      当用vim对文件进行编辑之后保存,它的mtime就会相应的改变;\n      eg: echo aa >> a.sh 或vim a.txt 修改内容\n3> ctime(change time):"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("修改文件"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("的时间.\n      通俗点,文件但凡有一点改动,不管是元数据还是内容的改动都会导致ctime的改变.\n      eg: 当使用chmod、chown等改变文件属性的操作是会改变文件的ctime的. chmod +x a.txt\n\t\t\t\n○ 使用cat命令查看文件后,文件atime会变更\n○ 使用vim命令打开文件只要在扩展模式下w后,文件atime、mtime、ctime都会变更.\n  若vim打开后随便咋编辑咋查看只要没有w保存,都只是在对内存里的数据进行操作,没有写入硬盘.\n  即只要在扩展模式下q或q!,只会变更atime.\n  \n【冷知识】\n也许你会惊奇的发现第一次后再连续几次cat/vim前后的atime都没有变化,这是因为linux自带的优化机制导致的:\n  cache 缓存 (读) -- 硬盘中的数据在内存中缓存;\n  buffer 缓冲区 (写) -- 攒一波再往硬盘中写.\n  PS:在前文的计算机硬件组成中有阐述.\n\n提一嘴:sync命令会将buffer缓冲区的数据强制往硬盘中写.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("p",[a("font",{attrs:{color:"blue"}},[a("strong",[s._v("[inode大小]")])])],1),s._v(" "),a("p",[s._v("注意哦! inode也会消耗硬盘空间的.")]),s._v(" "),a("p",[a("img",{attrs:{src:n(482),alt:""}})]),s._v(" "),a("p",[a("font",{attrs:{color:"blue"}},[a("strong",[s._v("[目录项]")])])],1),s._v(" "),a("p",[s._v("Linux系统中, 目录(directory)也是一种文件. 打开目录,实际上就是打开目录文件.")]),s._v(" "),a("p",[s._v("目录文件的结构非常简单, 就是一系列目录项(dirent)的列表."),a("br"),s._v("\n每个目录项由两部分组成: 所包含文件的文件名以及该文件名对应的inode号码!")]),s._v(" "),a("h3",{attrs:{id:"fat文件系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fat文件系统"}},[s._v("#")]),s._v(" FAT文件系统")]),s._v(" "),a("blockquote",[a("p",[s._v("U盘使用的文件/档案系统一般为FAT格式.")])]),s._v(" "),a("p",[s._v("它具有以下的特点:"),a("br"),s._v("\n1> FAT没有区分superblock、inode、data block, 就是一堆简单的block!但依旧会对block进行编号."),a("br"),s._v("\n     是没有xfs、ext那样的索引的, 一个block块里存放一堆(名字对应的下一跳的数字)的组合."),a("br"),s._v("\n2> 正因为FAT没有inode的存在, 所以FAT没有办法将这个档案的所有block在一开始就读取出来."),a("br"),s._v("\n     每个block号码都记录在前一个block当中.只能一跳一跳的查找.太慢太笨拙了 TnT.")]),s._v(" "),a("p",[a("img",{attrs:{src:n(483),alt:""}})]),s._v(" "),a("div",{staticClass:"language-tex line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tex"}},[a("code",[s._v("假设档案的资料依序写入 1->7->4->15 这四个block号码中.\n提一嘴,为啥会这样写入呢？同一时间往硬盘的写操作很多导致的.是按照顺序穿插着来的.\n\n这个档案系统没有办法一口气就知道四个block的号码,它得一个一个的将block读出后,才会知道下一个block在何处!\n如果同一个档案资料写入的block分散的太过厉害跨度太大时,\n则我们的磁盘读取头将无法在磁盘转一圈就读到所有的资料.因此磁盘就会多转好几圈才能完整的读取到这个档案的内容!\n\n【磁盘碎片整理】\n正因为档案写入的block太过于离散了,导致文件的读取效率很差,所以需要定期进行碎片整理！\n说白了,就是将文件存的相应的紧凑一点.block块连续一点.\n\nQ: 那么像xfs、ext文件系统需要进行磁盘整理吗？\nA: 它们是索引文件系统,通常是不需要的.\n   但是如果档案系统使用太久,常常删除/编辑/新增档案话,是可能会造成档案资料太过于离散的问题\n   此时就需要进行重整一下！\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[a("font",{attrs:{color:"gray"}},[s._v("Ps: windows常见的文件系统 FAT、NTFS、VFAT、MSDOS... ")])],1),s._v(" "),a("h3",{attrs:{id:"磁盘满的两种情况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#磁盘满的两种情况"}},[s._v("#")]),s._v(" 磁盘满的两种情况")]),s._v(" "),a("blockquote",[a("p",[s._v("常识: 只要权限够, 磁盘上有空间一定可以创建文件.  "),a("strong",[s._v("这个是错的!!  (X)")])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("▲ 文件系统/分区的inode号\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -i -T")]),s._v("\n文件系统                类型       Inode 已用"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("I"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 可用"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("I"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 已用"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("I"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("% 挂载点\ndevtmpfs                devtmpfs  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("120231")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("401")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("119830")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /dev\ntmpfs                   tmpfs     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124455")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124454")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /dev/shm\ntmpfs                   tmpfs     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124455")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("961")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123494")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run\ntmpfs                   tmpfs     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124455")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124439")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /sys/fs/cgroup\n/dev/mapper/centos-root xfs      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8910848")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("139846")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8771002")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("% /\n/dev/sda1               xfs       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("524288")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("347")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("523941")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /boot\ntmpfs                   tmpfs     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124455")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124432")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run/user/0\n\n▲ 文件系统/分区的磁盘容量\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h -T")]),s._v("\n文件系统                类型      容量  已用  可用 已用% 挂载点\ndevtmpfs                devtmpfs  470M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  470M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev\ntmpfs                   tmpfs     487M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  487M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev/shm\ntmpfs                   tmpfs     487M   15M  472M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("% /run\ntmpfs                   tmpfs     487M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  487M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /sys/fs/cgroup\n/dev/mapper/centos-root xfs        17G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".6G   13G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v("% /\n/dev/sda1               xfs      1014M  212M  803M   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("% /boot\ntmpfs                   tmpfs      98M   40K   98M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run/user/0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[a("strong",[s._v("情况一")]),s._v(": 磁盘上还有空间,但磁盘上大量的小文件导致inode号没了."),a("br"),s._v(" "),a("code",[s._v("i=30000;while true;do touch /boot/$i.txt;echo $i.txt;((i++));done")]),a("br"),s._v("\n     当/boot 分区的inode使用完,再创建文件会失败,会提示设备上没有空间.")]),s._v(" "),a("p",[s._v("     黑科技,运行上方的测试后,打开另一个终端,实时监测/boot分区inode号使用情况:"),a("br"),s._v(" "),a("code",[s._v("while true;do df -i;sleep 0.5;clear;done")]),s._v(" 达到视觉上刷新的效果,实则不是刷新."),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("Ps: 若不sleep0.5秒, cpu的消耗会很大很大, 得让它休息0.5秒,不然会烧脑 Hhhh.")])],1),s._v(" "),a("p",[a("strong",[s._v("情况二")]),s._v(": inode号还有很多,但某个文件很大,磁盘的容量被占满了."),a("br"),s._v(" "),a("code",[s._v("dd if=/dev/zero of=/boot/test.txt bs=300M count=1")]),a("br"),s._v(" "),a("code",[s._v("dd if=/dev/zero of=/abc.txt bs=10M count=1")]),a("br"),s._v(" "),a("code",[s._v("cp abc.txt /boot/")]),s._v(" 失败,会提示设备上没有空间!")]),s._v(" "),a("p",[a("strong",[s._v("[解决方案]")]),a("br"),s._v("\n1> 大量的小文件问题:可能会使inode耗尽, 使得文件文法创建(磁盘利用率低)"),a("br"),s._v("\n     So,对于小文件比较多的场景,可将inode和data block划分小一点;"),a("br"),s._v("\n     若innode已经不够用了,可将小文件备份到其他分区..."),a("br"),s._v("\n2> 大文件问题: 一个文件占用多个data block,使得文件读写速率慢.可将data block划分大点.使用xfs文件系统."),a("br"),s._v("\n     若容量已经不够用了. 思路一,将大文件打包备份走;思路二,使用软硬链接!!!")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"软硬链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#软硬链接"}},[s._v("#")]),s._v(" 软硬链接")]),s._v(" "),a("h3",{attrs:{id:"硬链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#硬链接"}},[s._v("#")]),s._v(" 硬链接")]),s._v(" "),a("blockquote",[a("p",[s._v("硬链接(Hard Link)相当于给一个文件起了一个 "),a("strong",[s._v("别名")]),s._v(" , 不同的文件名可以操作同一份数据.")]),s._v(" "),a("p",[a("strong",[s._v("ln [原文件] [目标文件]")])])]),s._v(" "),a("p",[s._v("1> "),a("strong",[s._v("对硬链接的源文件或目标文件内容进行修改,会影响到所有文件名")]),s._v(";"),a("br"),s._v("\n2> 硬链接文件与源文件具有相同inode,但文件名不同:"),a("br"),s._v("\n     即"),a("strong",[s._v("一个文件只能有一个inode号,但多个文件的inode号可以相同")]),a("br"),s._v("\n3> 删除硬链接或者原文件之一,不影响另一个文件名的访问, 除非所有的都删除掉."),a("br"),s._v("\n     So,硬连接 "),a("strong",[s._v("允许一个文件拥有多个有效路径名,这样用户就可以建立硬链接到重要文件,以防止“误删”.")]),a("br"),s._v("\n4> "),a("strong",[s._v("删除所有硬链接, 数据会在被磁盘检查或者新数据写入的时候删除回收.")]),a("br"),s._v("\n5> 通过rm –f 删除硬链接"),a("br"),s._v("\n6> "),a("font",{attrs:{color:"brown"}},[a("strong",[s._v("目录不可创建硬链接, 并且硬链接无法跨区")])])],1),s._v(" "),a("p",[a("img",{attrs:{src:n(484),alt:""}})]),s._v(" "),a("p",[a("font",{attrs:{color:"blue"}},[s._v("Ps: 硬链接有点像python里函数传递中针对可变类型的引用传递...")])],1),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\na.txt的inode号是35589975,'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("ll a.txt"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("可得知它有1个硬链接.\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -i a.txt ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35589975")]),s._v(" a.txt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll a.txt ")]),s._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":44 a.txt\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n用'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("命令为a.txt创建一个硬链接,这样的话,a.txt与b.txt inode号、硬链接数、文件内容都一样！\n即一个inode号关联了两个文件名,代表同一份数据！ \n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln a.txt b.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -i b.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35589975")]),s._v(" b.txt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll a.txt")]),s._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":44 a.txt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll b.txt")]),s._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":44 b.txt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat b.txt ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n对硬链接文件或原文件内容进行修改,会影响到所有文件名\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo 666 >> a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("666")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat b.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("666")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n删除原文件a.txt, 硬链接文件b.txt还能继续使用\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm -rf a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll b.txt")]),s._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":51 b.txt    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意,硬链接数变为了1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n目录不可创建硬链接\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir ./aaa")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln ./aaa ./bbb")]),s._v("\nln: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./aaa"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 不允许将硬链接指向目录\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br")])]),a("h3",{attrs:{id:"软链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#软链接"}},[s._v("#")]),s._v(" 软链接")]),s._v(" "),a("blockquote",[a("p",[s._v("软链接(Symbolic Link)文件2相当于是文件1的一个 "),a("strong",[s._v("快捷方式")]),s._v(" ."),a("br"),s._v('\n文件2指向文件1的路径,而不是文件1的inode号码,文件1的inode"硬链接数"不会因此发生变化.')]),s._v(" "),a("p",[a("strong",[s._v("ln –s [原文件] [目标文件]")])])]),s._v(" "),a("p",[s._v("1> "),a("strong",[s._v("对软链接的源文件或目标文件内容进行修改, 会影响到所有文件名")]),s._v(";"),a("br"),s._v("\n2> "),a("strong",[s._v("软链接文件与源文件具有不同的inode号")]),a("br"),s._v("\n3> "),a("strong",[s._v("删除软连接文件的源文件, 软链接文件将无法使用, 应该也一起删除掉,以便回收")]),s._v("\n4> rm –f 删除软链接"),a("br"),s._v("\n5> "),a("font",{attrs:{color:"brown"}},[a("strong",[s._v("可以对目录创建软链接, 并且软链接可以跨分区")])])],1),s._v(" "),a("p",[a("img",{attrs:{src:n(485),alt:""}})]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n使用命令'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("为c.txt文件创建一个软链接d.txt. \n相当于创建了一个快捷方式. 文件d.txt的存在依赖于c.txt\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat c.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -s c.txt d.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -i c.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34107380")]),s._v(" c.txt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -i d.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35311703")]),s._v(" d.txt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll c.txt")]),s._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":22 c.txt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll d.txt")]),s._v("\nlrwxrwxrwx "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":22 d.txt -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" c.txt\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo 666 >> c.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat c.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("666")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat d.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("666")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n原文件c.txt删掉了,其软链接d.txt就不能用啦\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm -rf c.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat d.txt")]),s._v("\ncat: d.txt: 没有那个文件或目录\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n可以对目录创建软链接\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir ./aaa")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo 111 > ./aaa/1.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -s ./aaa ./bbb")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":07 aaa\nlrwxrwxrwx "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":07 bbb -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ./aaa\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat ./aaa/1.txt ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat ./bbb/1.txt ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除软链接/快捷方式bbb目录对aaa目录没有影响")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm -rf ./bbb")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls aaa")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".txt\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除软链接/快捷方式bbb下的1.txt文件对aaa目录有影响!!!!!!!!!!!!!!!!!!!!!!!")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":13 aaa\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -s ./aaa ./bbb")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm -rf ./bbb/1.txt ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll aaa")]),s._v("\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br")])]),a("h3",{attrs:{id:"q-a"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#q-a"}},[s._v("#")]),s._v(" Q/A")]),s._v(" "),a("p",[a("strong",[s._v("Q1:")]),s._v(" 为啥硬链接不能跨分区,软链接可以？为啥目录文件不能创建硬链接,可以创建软链接?"),a("br"),s._v(" "),a("strong",[s._v("A1:")]),s._v(" "),a("font",{attrs:{color:"brown"}},[s._v("换句话来说,硬链接的创建具有局限性: 同一分区 + 普通文件 ")]),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("Ps: linux判断某个路径绑定的分区是从右往左找的,直到该目录绑定了分区. ")]),a("br"),s._v(" "),a("code",[s._v("/etc/sysconfig/network-scripts/ifcfg-ens33")]),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("直到找到关联分区的根/文件夹..")])],1),s._v(" "),a("p",[s._v("硬链接的本质是大家指向同一个inode号,关联同一份数据;所以硬链接仅限于在同一个分区里分配.."),a("br"),s._v("\n很容易想到分区1的10号inode与分区2的10号inode指向的data block可不是一样的.."),a("br"),s._v("\n而对目录文件创建硬链接意味着对该目录文件的子文件和子目录文件都用创建硬链接,开销很大.."),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("查阅资料,允许目录的硬链接可能会打破文件系统目录的有向无环图结构, 可能创建目录循环, 这可能会导致fsck以及其他一些遍历文件树的软件出错... TnT 可以说人话嘛？听求不懂... 不深究了")])],1),s._v(" "),a("p",[s._v("而软链接支持跨分区,是因为软链接的本质是指向源文件,不指向inode号..."),a("br"),s._v("\n源文件与目标文件/软链接文件的inode号不同")]),s._v(" "),a("p",[a("strong",[s._v("Q2:")]),s._v(" 配置文件修改完后,一定要重启对应的软件才能生效,为什么?"),a("br"),s._v(" "),a("strong",[s._v("A2:")]),s._v(" 软件启动起来后,需要读取配置文件的信息,以指定的方式去运行."),a("br"),s._v("\n     读文件,不是通过文件名读取的,需要通过inode号读取.."),a("br"),s._v(" "),a("em",[s._v("vim一改动配置文件,inode号就变了..")]),s._v("  而正在运行的软件读取的是更改之前的内容..读不到更改的内容."),a("br"),s._v("\n     So,需要重新启动软件,找到那个新的inode号,读取修改后的数据."),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v(' Ps: 有些软件不用重启, 称为"平滑重启". 也就是这个软件整体没有重启,但有一部分是重启重新读取文件了的..')])],1),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n可以发现,vim修改配置文件后,test.conf的inode号会变'),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n为什么？vim的原理导致的,具体过程如下:\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("1")]),s._v(">")]),s._v("文件内容一次性读入内存,一边修改会一边将改动写入硬盘上创建的临时文件.test.conf.swp文件里面去\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v("改动完后,:w,文件系统会删除硬盘中的test.conf源文件"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" .test.conf.swp文件通过cp操作改名为源文件的名字\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("3")]),s._v(">")]),s._v(":q后,临时文件.test.conf.swp删除"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim test.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat test.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -i test.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34532550")]),s._v(" test.conf\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim test.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat test.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("456")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim test.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -i test.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35311703")]),s._v(" test.conf\n\n【验证vim原理的操作过程】\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n可以发现test.conf文件前后的inode号是改变了的.\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -i 1.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34107380")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".txt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -i test.conf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35311703")]),s._v(" test.conf\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm -rf test.conf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cp 1.txt test.conf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -i test.conf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34532550")]),s._v(" test.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br")])]),a("p",[a("strong",[s._v("Q3:")]),s._v(" 总结下软硬链接的异同."),a("br"),s._v(" "),a("strong",[s._v("A3:")]),s._v("  相同点 - 修改一个文件的内容,其它链接文件都跟着改."),a("br"),s._v("\n        不同点 -"),a("br"),s._v("\n             1> 硬链接多个文件inode号一样,软链接的多个文件inode号不一样;"),a("br"),s._v("\n             2> 删除源文件, 硬链接任然可用,但软链接失效"),a("br"),s._v("\n             3> 硬链接只能对普通文件做,而且不能跨分区."),a("br"),s._v("\n             软链接可以对普通文件和目录文件做,而且可以跨分区.")]),s._v(" "),a("h3",{attrs:{id:"软链接解决磁盘满"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#软链接解决磁盘满"}},[s._v("#")]),s._v(" 软链接解决磁盘满")]),s._v(" "),a("blockquote",[a("p",[s._v("简单理解, 硬盘分区的挂载点就是软链接..")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df /dev/sda1")]),s._v("\n文件系统         1K-块   已用   可用      已用%   挂载点\n/dev/sda1      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1038336")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("216864")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("821472")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("%    /boot\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("假设/boot文件夹满了(准确点说,是"),a("code",[s._v("/boot")]),s._v("挂载点对应的文件系统/分区"),a("code",[s._v("sda1")]),s._v(" 的硬盘空间满了).."),a("br"),s._v("\n也就是说,创建新文件 /boot/data/a.txt 从右往左找, 该路径应该存放于sda1分区里.."),a("br"),s._v("\n但是sda1分区满了.. 创建文件失败!")]),s._v(" "),a("p",[s._v("于是乎, 我们买一块硬盘,分区做好文件系统, 即新建一个分区 "),a("code",[s._v("sdb1")]),s._v(", 其挂载点为 "),a("code",[s._v("/boot/data")]),a("br"),s._v("\n这样的话, /boot/data/a.txt 此路径下的a.txt文件就会存放与 sdb1分区里.."),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("/dev/sda1 -----------  /boot ")]),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("/dev/sdb1 ----------- /boot/data")])],1),s._v(" "),a("p",[a("font",{attrs:{color:"brown"}},[s._v("文件路径一定要注意辨别在哪个分区!！")])],1),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("在vm虚机上可以设置新增硬盘"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("重启生效.\n计算机上是支持热插拔的,计算机开机状态,插入硬盘也能识别"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("类似于我通过USB接口插入了一块移动硬盘,能识别成功"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n可以发现有sda sdb两块硬盘\n○ sda1 sda2 是sda这块硬盘做的两个分区\n○ sdb不分区的话,可以整体算一个分区,但需要对其做文件系统,并对其添加挂载\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /dev/sda  # 连续Tab键提示")]),s._v("\nsda   sda1  sda2  sdb\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## centos7里推荐用xfs")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkfs.xfs /dev/sdb")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount /dev/sdb /boot/data")]),s._v("\n\n\n◆ 文件路径一定要区分分区"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\nsdb硬盘的挂载点为/boot/data文件目录\n往此路径/boot/data/a.txt的a.txt文件里写入内容\n通过umount命令取消挂载\n再cat查看,会发现a.txt的内容消失\nwhy？挂载取消后,此路径会去/boot挂载点对应的sba1分区中找数据.而不是sdb硬盘分区中找.\n而恰好sba1分区的此路径下有a.txt文件,但此文件的文件大小为0.\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "Hhhhh" > /boot/data/a.txt')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /boot/data/a.txt")]),s._v("\nHhhhh\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# umount /boot/data 也是一样的效果")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# umount /dev/sdb")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /boot/data/a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /boot/data/a.txt")]),s._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":30 /boot/data/a.txt\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "123456" > /boot/data/a.txt')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /boot/data/a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount /dev/sdb /boot/data")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /boot/data/a.txt")]),s._v("\nHhhhh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])]),a("hr")])}),[],!1,null,null,null);t.default=r.exports},480:function(s,t,n){s.exports=n.p+"assets/img/7.83a342bb.jpeg"},481:function(s,t,n){s.exports=n.p+"assets/img/12.fb016648.png"},482:function(s,t,n){s.exports=n.p+"assets/img/2.2671dd39.jpeg"},483:function(s,t,n){s.exports=n.p+"assets/img/FAT.a2f15867.png"},484:function(s,t,n){s.exports=n.p+"assets/img/13.b8511898.jpg"},485:function(s,t,n){s.exports=n.p+"assets/img/15.087c012f.jpg"}}]);