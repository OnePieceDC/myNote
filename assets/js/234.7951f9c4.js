(window.webpackJsonp=window.webpackJsonp||[]).push([[234],{1203:function(s,t,a){"use strict";a.r(t);var n=a(0),r=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"acl引入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#acl引入"}},[s._v("#")]),s._v(" ACL引入")]),s._v(" "),a("blockquote",[a("p",[s._v("UGO中的O即其他人, 涵盖了非常大的范围, 我们使用 "),a("code",[s._v("setfacl")]),s._v(" 可以将用户对文件的权限进行进一步细化!")])]),s._v(" "),a("p",[a("strong",[s._v("数据准备")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## -- 在/opt目录下创建文件a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo 111 > a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod o=- a.txt")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## -- 不管是哪个用户,在操作a.txt文件之前,需要保证沿途目录/与/opt的其他人有x执行权限")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -d /")]),s._v("\ndr-xr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("244")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":50 /\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -d /opt")]),s._v("\ndrwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":48 /opt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll a.txt ")]),s._v("\n-rw-r----- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":48 a.txt\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## -- 查看未设置ACL时文件的权限状态")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# getfacl a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# file: a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# owner: root")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# group: root")]),s._v("\nuser::rw-\ngroup::r--\nother::---\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# useradd egon01")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# useradd egon02")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# groupadd IT")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("p",[a("strong",[s._v("实验目的:")]),a("br"),s._v("\n让用户egon01对a.txt文件只有读权限; egon02对a.txt文件只有写权限; IT组对a.txt文件只有读权限.")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# setfacl -m u:egon01:r a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# setfacl -m u:egon02:w a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# setfacl -m g:IT:r /opt/a.txt ")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n文件一旦设置了acl权限后, ls查看文件的信息会出现一个 加号'),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll a.txt")]),s._v("\n-rw-rw----+ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 01:35 a.txt\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n查看文件ACL状态,与未设置ACL时相比:\n  '),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("1")]),s._v(">")]),s._v(" 多了对用户egon01和egon02以及IT组对a.txt权限的设置\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v(" 仔细观察信息中出现了mask关键字,具体说明如下:\n        mask代表文件的最高权限"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("除了owner和other都要受其影响"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n        本质原理是将权限与mask值进行按位与运算\n        通俗点,mask像是一个筛子.文件属主和其他人之外的所有权限都需要被它筛一遍"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n        若mask是rw,则代表该筛子只放行r和w权限"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n        举个栗子:\n            lili权限\tr--\n            mask权限\trw-\n            lili最终权限\tr--\nPs:我们一般不更改mask值.\n   只要赋予mask最大权限"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("也就是rwx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(",则给用户或群组设定的ACL权限本身就是有效的"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("怎么筛都能通过.\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# getfacl a.txt ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# file: a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# owner: root")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# group: root")]),s._v("\nuser::rw-\nuser:egon01:r--\nuser:egon02:-w-\ngroup::r--\ngroup:IT:r--\nmask::rw-\nother::---\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## -- 进行验证")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# su - egon01 -c "cat /opt/a.txt" ')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# su - egon01 -c "echo 222 >> /opt/a.txt" ')]),s._v("\n-bash: /opt/a.txt: 权限不够\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# su - egon02 -c "echo 222 >> /opt/a.txt" ')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# su - egon02 -c "cat /opt/a.txt" ')]),s._v("\ncat: /opt/a.txt: 权限不够\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("222")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br")])]),a("hr"),s._v(" "),a("h2",{attrs:{id:"acl查改删继承"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#acl查改删继承"}},[s._v("#")]),s._v(" ACL查改删继承")]),s._v(" "),a("p",[s._v("查看文件的权限     "),a("code",[s._v("getacl a.txt")])]),s._v(" "),a("p",[s._v("修改文件u属主的权限     "),a("code",[s._v("setfacl -m u::权限 a.txt")]),a("br"),s._v("\n修改文件g属组的权限     "),a("code",[s._v("setfacl -m g::权限 a.txt")]),a("br"),s._v("\n修改文件o其他人的权限     "),a("code",[s._v("setfacl -m o::权限 a.txt")]),a("br"),s._v(" "),a("strong",[s._v("修改文件具体某一个 "),a("em",[s._v("用户")]),s._v(" 的权限")]),s._v(" "),a("code",[s._v("setfacl -m u:用户名:权限 a.txt")]),a("br"),s._v(" "),a("strong",[s._v("修改文件具体某一个 "),a("em",[s._v("组")]),s._v(" 的权限")]),s._v(" "),a("code",[s._v("setfacl -m g:组名:权限 a.txt")]),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("组必须事先存在 ")])],1),s._v(" "),a("p",[s._v("删除文件具体某一个用户的权限      "),a("code",[s._v("setfacl -x u:用户名 a.txt")]),a("br"),s._v("\n删除文件具体某一个组的权限      "),a("code",[s._v("setfacl -x g:组名 a.txt")]),a("br"),s._v("\n删除文件所有ACL权限      "),a("code",[s._v("setfacl -b a.txt")]),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("文件权限的+号也就消失啦")])],1),s._v(" "),a("p",[s._v("更改文件mask的值      "),a("code",[s._v("setfacl -m m:权限 a.txt")]),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("一般不会更改mask权限的值 ")])],1),s._v(" "),a("p",[s._v("让具体某一个用户对该目录以及往后在该目录下 "),a("strong",[s._v("新建")]),s._v(" 的文件和目录都拥有相同的权限"),a("br"),s._v(" "),a("code",[s._v("setfacl -m d:u:用户名:权限 /opt/test")]),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[a("strong",[s._v("注意:")]),s._v(" 若继承的权限设置为rwx,该目录下新建文件默认的mask值可能会对文件最终生效的权限产生影响..")])],1),s._v(" "),a("p",[a("font",{attrs:{color:"gray"}},[a("strong",[s._v("对目录ACL权限的设置同理..")])])],1),s._v(" "),a("p",[a("font",{attrs:{color:"red"}},[a("strong",[s._v("使用ACL后,修改权限就不要再用chmod啦!!以免产生不必要的麻烦..")])])],1),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# getfacl a.txt ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# file: a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# owner: root")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# group: root")]),s._v("\nuser::rw-\nuser:egon01:r--\nuser:egon02:-w-\ngroup::r--\ngroup:IT:r--\nmask::rw-\nother::---\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n改变属组权限的正确做法: '),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("setfacl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" g::- a.txt"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod g=- /opt/a.txt ")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n使用ACL后,再使用chmod修改权限生成的新的mask值,会将权限筛选一遍,达不到我们想要的效果'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n可以看到,mask::--- \tuser:egon01:r--  r过不了.\t所以用户egon01生效的权限是---\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# getfacl a.txt ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# file: a.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# owner: root")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# group: root")]),s._v("\nuser::rw-\nuser:egon01:r--\t    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#effective:---")]),s._v("\nuser:egon02:-w-\t    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#effective:---")]),s._v("\ngroup::r--          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#effective:---")]),s._v("\ngroup:IT:r--        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#effective:---")]),s._v("\nmask::---\nother::---\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br")])]),a("p",[a("font",{attrs:{color:"blue"}},[a("strong",[s._v("当前用户如果检索不到对应的acl权限或者检索到后发现权限为空,都会对应到other权限上..")])]),a("br"),s._v(" "),a("font",{attrs:{color:"gray"}},[s._v("也就是说,当前用户属于文件权限other其他人那一栏,当前用户对此文件生效的acl权限是高于other权限的..")])],1),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("setfacl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" b.txt  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以先清理掉所有的acl权限,保证实验环境干净")]),s._v("\n\n● 应用场景一: 其他人对文件没有任何权限,然后单独设置其他人里的egon01对文件有r权限、egon02对文件有w权限\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\negon01对b.txt的权限为r--'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" egon02对b.txt的权限为-w-\n剩余的其他人中,例如egon03对b.txt的权限为---\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n      setfacl '),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" o::- b.txt\n      setfacl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" u:egon01:r b.txt\n      setfacl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" u:egon02:w b.txt\n\n\n● 应用场景二: 其他人对文件有rw权限,然后单独设置其他人里的egon01对文件有r权限、egon02对文件有w权限\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\negon01对b.txt的权限为r--'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" egon02对b.txt的权限为-w-\n剩余的其他人中,例如egon03对b.txt的权限为rw-\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n      setfacl '),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" o::rw b.txt\n      setfacl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" u:egon01:r b.txt\n      setfacl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" u:egon02:w b.txt\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("hr"),s._v(" "),a("h2",{attrs:{id:"文件的a、i、a特殊属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件的a、i、a特殊属性"}},[s._v("#")]),s._v(" 文件的a、i、A特殊属性")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\nlsattr 查看文件的特殊属性\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# touch /opt/{1..3}.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /opt/")]),s._v("\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 06:19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".txt\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 06:19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".txt\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 06:19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".txt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lsattr /opt/")]),s._v("\n---------------- /opt/1.txt\n---------------- /opt/2.txt\n---------------- /opt/3.txt\n\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\nchattr 设置文件的特殊属性\n  +a  让某个文件只能往里面追加数据,但不能删除,适用于各种日志文件.\n  +i\t禁止任何修改,有些病毒程序会对文件加上该权限'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("防止系统中某个关键文件被修改 TnT\n  +A\t不能更改文件访问时间\n\t\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" 删除属性\n\nPs: 这些文件属性设置对root管理员也生效,但root可以更改这些特殊属性啊"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chattr +a /opt/1.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chattr +i /opt/2.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chattr +A /opt/3.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lsattr /opt/")]),s._v("\n-----a---------- /opt/1.txt\n----i----------- /opt/2.txt\n-------A-------- /opt/3.txt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /opt/")]),s._v("\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 06:19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".txt\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 06:19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".txt\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 06:19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".txt\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("hr")])}),[],!1,null,null,null);t.default=r.exports}}]);