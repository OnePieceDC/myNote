(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1049:function(t,s,a){t.exports=a.p+"assets/img/image-20240202205959320.f213dcf1.png"},1050:function(t,s,a){t.exports=a.p+"assets/img/image-20240202220508252.2676d8b1.png"},1051:function(t,s,a){t.exports=a.p+"assets/img/29.2921e367.gif"},1052:function(t,s,a){t.exports=a.p+"assets/img/image-20240204134714398.693ef5bf.png"},1053:function(t,s,a){t.exports=a.p+"assets/img/30.b52b442e.gif"},1054:function(t,s,a){t.exports=a.p+"assets/img/image-20240204142150897.d9d7779b.png"},1055:function(t,s,a){t.exports=a.p+"assets/img/image-20240204170043564.24980467.png"},1056:function(t,s,a){t.exports=a.p+"assets/img/image-20240205085232854.e26060ec.png"},1057:function(t,s,a){t.exports=a.p+"assets/img/31.c5ce81b3.gif"},1058:function(t,s,a){t.exports=a.p+"assets/img/image-20240205142232827.70a9428b.png"},1059:function(t,s,a){t.exports=a.p+"assets/img/image-20240205183054918.bdb8b2b8.png"},1060:function(t,s,a){t.exports=a.p+"assets/img/image-20240205182857620.53f322e6.png"},1334:function(t,s,a){"use strict";a.r(s);var n=a(0),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"发布运单-页面"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#发布运单-页面"}},[t._v("#")]),t._v(" 发布运单-页面")]),t._v(" "),n("blockquote",[n("p",[t._v("相较之前的页面,需要掌握的新的知识是element-plus里的 抽屉, 用于实现历史地址!!")])]),t._v(" "),n("h3",{attrs:{id:"大致布局"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#大致布局"}},[t._v("#")]),t._v(" 大致布局")]),t._v(" "),n("blockquote",[n("p",[t._v("代码都写过了,此处关键在于分析页面的布局.")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1049),alt:"image-20240202205959320"}})]),t._v(" "),n("p",[n("strong",[t._v("Ps:")]),t._v(" 货物类型处的下拉框内容,本应该在进入发布运单页面时onMounted里向后端发送请求获得,这里简化了,直接在前端写死了,Hhhh.")]),t._v(" "),n("p",[t._v("快捷日期的选择,关键代码如下: "),n("font",{attrs:{color:"gray"}},[t._v("(钱包功能那的日期是日期段,运单这里是某个日期)")])],1),t._v(" "),n("div",{staticClass:"language-vue line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vue"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("el-form")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("label-width")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("80px"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token special-attr"}},[n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),n("span",{pre:!0,attrs:{class:"token value css language-css"}},[n("span",{pre:!0,attrs:{class:"token property"}},[t._v("max-width")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 500px"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("el-form-item")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("label")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("发货时间"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":error")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("state.formError.from_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("el-date-picker")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-model")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("state.form.from_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("placeholder")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("计划发货时间"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":disabled-date")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("disabledDate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":shortcuts")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("shortcuts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("format")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("YYYY-MM-DD"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value-format")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("YYYY-MM-DD"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token special-attr"}},[n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),n("span",{pre:!0,attrs:{class:"token value css language-css"}},[n("span",{pre:!0,attrs:{class:"token property"}},[t._v("width")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 100%")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("el-form")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("setup")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" shortcuts "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("text")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'今天'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("value")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("text")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'明天'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("value")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTime")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTime")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3600")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" date\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("form")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("from_date")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("formError")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("from_date")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// 这样设置后,今日以前的日期都选不了!! （当然,没有该需求的话,可以不设置:disabled-date="disabledDate"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("disabledDate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("time")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTime")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" Date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br"),n("span",{staticClass:"line-number"},[t._v("40")]),n("br"),n("span",{staticClass:"line-number"},[t._v("41")]),n("br"),n("span",{staticClass:"line-number"},[t._v("42")]),n("br"),n("span",{staticClass:"line-number"},[t._v("43")]),n("br"),n("span",{staticClass:"line-number"},[t._v("44")]),n("br")])]),n("h3",{attrs:{id:"抽屉展示"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#抽屉展示"}},[t._v("#")]),t._v(" 抽屉展示")]),t._v(" "),n("blockquote",[n("p",[t._v("点击地址库, 出现抽屉, 用于展示历史地址.")])]),t._v(" "),n("p",[t._v("抽屉区域,默认隐藏; 点击地址库,展示抽屉!!")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1050),alt:"image-20240202220508252"}})]),t._v(" "),n("hr"),t._v(" "),n("h2",{attrs:{id:"抽屉数据加载"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#抽屉数据加载"}},[t._v("#")]),t._v(" 抽屉数据加载")]),t._v(" "),n("blockquote",[n("p",[t._v("点击地址库按钮,会出现抽屉,里面是应是地址列表!"),n("br"),t._v("\n即弹出抽屉时, 会向后端发送请求获取当前登陆用户的地址库!!")])]),t._v(" "),n("p",[n("strong",[t._v("先来看看效果!")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1051),alt:"29"}})]),t._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[t._v("准备工作"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("后端有关地址库的模型迁移生成数据表后"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("为了方便测试"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("我们手动在数据表中添加了几行数据!!\n\n你可以发现"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("我点击了“地址库”按钮后"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("发送了一个请求"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("当我关闭抽屉"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("再次点击“地址库”"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("抽屉中也会有数据"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("不会再次发送请求啦!\n你不经要问"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("why?\n因为地址库中的数据"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("不会经常更新"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("就没必要点一次“地址库”按钮就从后端获取一次"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n即取一次有了"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("后需的点击该按钮对应的方法中就不会再发送请求啦!\n在前端代码中的体现在于showAddressTable方法中的"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("!注"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("addressLoaded一开始我们设置的值为false"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br")])]),n("p",[n("strong",[t._v("关键代码如下:")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1052),alt:"image-20240204134714398"}})]),t._v(" "),n("p",[n("strong",[t._v("PS:")]),t._v(" 针对该功能,为了优化用户体验,我们还会在数据表中加一个代表使用频率的字段,返回给前端时根据该字段来进行排序. 暂略.")]),t._v(" "),n("hr"),t._v(" "),n("h2",{attrs:{id:"选择实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#选择实现"}},[t._v("#")]),t._v(" 选择实现")]),t._v(" "),n("blockquote",[n("p",[t._v("当我们选中某个地址库中的一行数据, 会自动在表单对应的位置赋值上数据!!")])]),t._v(" "),n("p",[n("strong",[t._v("先来看看效果!!")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1053),alt:"30"}})]),t._v(" "),n("p",[t._v('为了区分选中后,是给发货地址、还是收获地址自动赋值, 我们需要给点击事件showAddressTable添加参数"from"、"to" !!'),n("br"),t._v(" "),n("strong",[t._v("关键代码如下:")]),t._v(" "),n("font",{attrs:{color:"gray"}},[t._v("(只需要写点前端代码就可以实现啦!!)")])],1),t._v(" "),n("p",[n("img",{attrs:{src:a(1054),alt:"image-20240204142150897"}})]),t._v(" "),n("hr"),t._v(" "),n("h2",{attrs:{id:"后端视图扩展-res"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#后端视图扩展-res"}},[t._v("#")]),t._v(" 后端视图扩展 res")]),t._v(" "),n("blockquote",[n("p",[t._v("钩子有返回值就直接返回返回值给前端!!")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1055),alt:"image-20240204170043564"}})]),t._v(" "),n("hr"),t._v(" "),n("h2",{attrs:{id:"运单发布"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#运单发布"}},[t._v("#")]),t._v(" 运单发布")]),t._v(" "),n("blockquote",[n("p",[t._v("ψ(｀∇´)ψ")])]),t._v(" "),n("h3",{attrs:{id:"数据表的设计"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据表的设计"}},[t._v("#")]),t._v(" 数据表的设计")]),t._v(" "),n("blockquote",[n("p",[t._v("为了完成该需求, 新增了4张表.")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1056),alt:"image-20240205085232854"}})]),t._v(" "),n("p",[t._v("看上面这张截图,针对截图中新增的这四张表, 结合业务场景作一点说明:")]),t._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Order运单表"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" status运单状态"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n  已发布"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("后台管理人员审核通过后变为待接单"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("等待司机接单"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("司机接单后变为待提货\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("提货后变为运输中"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("运输到目的地后变为待结算"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("给了司机钱后"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("变为已结算"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" 另外"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("发布后可取消"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("哪怕司机已接单"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("也可协商下取消"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n  只不过"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("在这里为了方便测试"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("其默认值为"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("即待接单"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("默认发布后后台管理人员已经审核通过了"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" goods_type货物类型"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 理论上前端应发送一个请求来获取它"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("但我犯懒了"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("在前端直接写死了"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("就是为了少发一个请求来获取货物类型Hhhh\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" title货物名称\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" cost货物价值"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("即一车货值多少钱\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" oid订单号"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  这里准确点来说"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("是运单号!!跟交易记录里的充值、提现时"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("我们自己生成的订单号是两码事哦!!\n  当然运单发布成功后"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("也会产生一条交易记录"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("其类型是“下单”"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("So"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("还得改一下交易记录表的ORM模型"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("哈哈哈\n  tran_type_choices "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"下单"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"提现"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"充值"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"取消"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  tran_type "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" models"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SmallIntegerField"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("verbose_name"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"转账类型"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" choices"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tran_type_choices"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  order_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" models"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CharField"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("verbose_name"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"运单号"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" max_length"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" null"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" blank"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" db_index"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" weight货物重量"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("运单发布时需要预估货物重量 \n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" settle_weight货物结算重量"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("司机装货后会称重"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("是准确的"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("所以在发布运单时该值可以为空\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" unit_price运单单价\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 发货地址相关字段 from_addr  from_name  from_mobile  from_date\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 收获地址相关字段 to_addr  to_name  to_mobile  to_date\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" ctime创建时间"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("会自动生成\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" company供应商"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("需指明哪个供应商提供的\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" driver接单司机"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("哪个司机接单的 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("一开始是空的"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("接单后才会关联上!"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Driver司机表"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n参考着供应商表来实现 与供应商表相比"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("就多了个字段plate_number\n注意"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("我们简化了一下"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("每个司机只绑定了一个车牌"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("事实上可绑定多辆车"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("绑定过程需要认证"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("上传行驶证之类的!\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("DriverAuth司机认证表"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n和供应商认证表一样"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("还有个供应商认证表"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("两者倒差不差\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OrderRecord订单运输记录表"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n还要考虑一些变化"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("比如司机接了单"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("临时有事去不了了等"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("所以会加上一个订单的运输记录表! \n比如A司机在什么时候接单了"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("A司机又在什么时候取消订单了"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("B司机又在什么时候接单了"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("具体的事情都会写在remark描述里"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" order哪个订单\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" ctime时间\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" remark描述\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br")])]),n("h3",{attrs:{id:"createmodelmixin"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#createmodelmixin"}},[t._v("#")]),t._v(" CreateModelMixin")]),t._v(" "),n("blockquote",[n("p",[t._v("运单发布, 就是CURD中的增, 但会在此的基础上根据业务需求加上一些逻辑!!")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1057),alt:"31"}})]),t._v(" "),n("p",[t._v("先在交易记录表中修改和新增点东西."),n("br"),t._v("\n运单发布后会添加一条下单记录,在下单记录的表格里可看到运单号,点击运单号可查看运单详情信息; 当然发布的运单也可以取消!")]),t._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[t._v("tran_type_choices "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"下单"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"提现"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"充值"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"取消"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntran_type "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" models"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SmallIntegerField"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("verbose_name"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"交易类型"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" choices"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tran_type_choices"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\norder_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" models"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CharField"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("verbose_name"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"运单号"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" max_length"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" null"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" blank"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" db_index"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("p",[n("strong",[t._v("关键代码如下:")]),t._v(" (请结合着 运单发布-数据表的设计 这一小节进行分析)")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1058),alt:"image-20240205142232827"}})]),t._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[t._v("你观察视图函数"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("在新增逻辑的基础上根据业务需求加上一些逻辑!!\n需要注意的是"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("在生成一条运单数据时"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("使用地址表中的"),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),t._v("是不合适的!!\n你试想"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("后续一旦地址库中的地址发送变动"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("那么与其关联的运单就会同步进行变动"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n比如原本是成都到重庆"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("改成了成都到北京"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("距离变长了"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("佣金没变"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("该种情况是不允许出现的"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("\n\n注意同类型的比较!!\nunit_price"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("weight 单价"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("重量 与 当前登陆的供应商自己的可用余额balance 进行比较"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n这三个字段都是DecimalField类型的数据!!注"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("前端传递过来的对应字段值是字符串"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("但提交过来后"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("其值在内部会转化成ORM表中字段的类型!!\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("\n\n在save时"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ORM表中的绝大部分都用"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("零星几个不用"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("编写代码时用exclude!!\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("\n\n?突然犯病卡壳了"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("driver在ORM表中"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("是可为空的"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("So"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("运单发布是新增"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("这里不写driver字段也没事!!\n紧接着"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("我想了一些问题 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("这些都是老生常谈的问题了"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("无语子"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("说了很多遍了\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 如果我写了"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("用APIFOX模拟前端发送请求"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("该请求携带的json数据中"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("包含了driver字段"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("会怎么样?\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" driver字段是外键字段"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("回想下ORM语句"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("可以是driver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("也可以是driver_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("又是怎么一个场景?\n我进行了一系列的实践"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("比如\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" driver是外键"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("不为空\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" exclude "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"company"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"oid"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 前端传了driver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("后端会自动检验外键字段在关联表中是否存在\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" driver_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" serializers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IntegerField"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  exclude "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"company"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"driver"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"oid"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" \n    前端传了driver_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 若关联表中不存在该值"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("在save时会报错FOREIGN KEY constraint failed\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" ◇ driver是外键"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("可为空\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" exclude "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"company"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"driver"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"oid"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  ◇ 前端传driver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("传driver_id 都不起任何作用"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("当没传\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" exclude "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"company"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"oid"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  前端传了driver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("后端会自动检验外键字段在关联表中是否存在\n还有其他的搭配方案"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("话说回来"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("这些实践看似很复杂"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("实则记住下面这个逻辑就行"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 要清楚的意识到前端传递的json"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("就是为序列化器类服务的"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("哪些要哪些不要"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("一切还得序列化器说的算Hhh\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 拿捏序列化器类中所有字段对象"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("进行分类 可验证的字段对象"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("可写、可序列化的字段对象"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("可读\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 可验证的字段对象 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 进行验证 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 验证通过validated_data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 进行save存储"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("save时候还可额外传递一些数据\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br")])]),n("hr"),t._v(" "),n("h2",{attrs:{id:"运单管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#运单管理"}},[t._v("#")]),t._v(" 运单管理")]),t._v(" "),n("blockquote",[n("p",[t._v('运单管理页面, 很多功能的具体实现都跟"我的钱包"那的"交易记录"是类似的, 所以在这里我们将会省略具体的步骤!!')])]),t._v(" "),n("p",[n("strong",[t._v("页面长这样哦!!")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1059),alt:"image-20240205183054918"}})]),t._v(" "),n("p",[n("strong",[t._v("来品一品新知识,哈哈哈")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1060),alt:"image-20240205182857620"}})]),t._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[t._v("可以发现"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("页面可以分为几个区域 面板标题、按钮组"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("运单状态相关"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("、搜索条件、功能区、表格"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("分页\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 按钮组和搜索条件功能的实现"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("参考"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"我的钱包"')]),t._v("里"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"交易记录"')]),t._v("的搜索\n   若运单运单状态以下拉框的形式放在表单里"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("一切都一样啦"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("此处是放到按钮组里的"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("问题不大!!依旧是url参数的形式传递过去"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 表格和分页和前面的差不多"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("多的新知识是 在表格里加了个多选"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 选中后触发的方法可以拿到选中的那些行!!\n   "),n("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@selection")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("change"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"handleSelectionChange"')]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("el"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("table"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("column "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"selection"')]),t._v(" width"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"55"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 功能区有个下拉菜单"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("这是个新知识!点击某个选项"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("同样会触发某个方法"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("拿到特定的值\n   你可以进行"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("判断"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("当是某个值的时候执行某个操作"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 在这个业务场景中"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("获取列表数据和新增数据"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("序列化器类应该这么设计\n   "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" oid我们将其设置为了只读"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("而不是放到exclude列表中"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n     是因为只读"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("获取时返回"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("提交的时候不用"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n     代入业务场景"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("‘\n        oid发布运单时候"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("前端不用传"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("也不用返回它"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("就放到exclude中了"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("只是说sava新增时要自己生成一个传进去\n        oid展示列表时候"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("需要在表格中展示它\n   "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" DecimalField类型的字段"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("coerce_to_string值设置为"),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("是让序列化返回时以浮点型返回"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("而不是字符串类型\n     你看下源码"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("还可以全局设置哦!!\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OrderModelSerializer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serializers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ModelSerializer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# oid = serializers.CharField(read_only=True)")]),t._v("\n    status_text "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" serializers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CharField"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("source"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'get_status_display'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Meta")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        model "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" models"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Order\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# fields = "__all__"')]),t._v("\n        exclude "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"company"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"driver"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        extra_kwargs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unit_price"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"coerce_to_string"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"weight"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"coerce_to_string"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"oid"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"read_only"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 关于按钮组里的内容"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("标准的流程应该是在页面在onMounted中发个请求获取"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("只不过有时候偷懒"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("就在前端写死了哈哈哈"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br")])]),n("hr"),t._v(" "),n("h2",{attrs:{id:"电子签"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#电子签"}},[t._v("#")]),t._v(" 电子签")]),t._v(" "),n("blockquote",[n("p",[t._v("额,用到了再说吧,了解了下,不是很明白..Hhh 略.")])]),t._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[t._v("▲ 在线签合同 途径\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 腾讯电子签\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 企业用户\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 个人用户"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("仅支持小程序\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 君子签\n  \n▲ 在线签合同 方式\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 人工 \n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 注册企业账号"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("创建合同模板"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("发起合同"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("签署\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 程序\n    腾讯给提供了两种环境"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("正式环境、沙箱环境\n    以供应链系统为例"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("平台需作为中间方与供应商签署合同、也需与司机签署合同\n    So"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("平台需要自动实现一些功能\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 自动生成PDF格式合同"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 只有合同部分信息"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("不包含签署信息"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 自动上传给腾讯电子签\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 自定义签署位置\n       "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 坐标来找位置\n       "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 关键字找位置（推荐）\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 触发签合同\n       "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 自动签署"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("公章上传平台 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" 开通自动签章的服务"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("企业静默签"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n       "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 手动签署"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("小程序扫码\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 对方签完了怎么通知我们? 电子签平台通知"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("网址"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br")])]),n("hr")])}),[],!1,null,null,null);s.default=r.exports}}]);